function P_(i,t){for(var r=0;r<t.length;r++){const u=t[r];if(typeof u!="string"&&!Array.isArray(u)){for(const o in u)if(o!=="default"&&!(o in i)){const c=Object.getOwnPropertyDescriptor(u,o);c&&Object.defineProperty(i,o,c.get?c:{enumerable:!0,get:()=>u[o]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))u(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&u(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function u(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();function Kh(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function uR(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var t=i.default;if(typeof t=="function"){var r=function u(){return this instanceof u?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(i).forEach(function(u){var o=Object.getOwnPropertyDescriptor(i,u);Object.defineProperty(r,u,o.get?o:{enumerable:!0,get:function(){return i[u]}})}),r}var fp={exports:{}},Ys={},vp={exports:{}},we={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jg;function __(){if(jg)return we;jg=1;var i=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),a=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),v=Symbol.iterator;function g(O){return O===null||typeof O!="object"?null:(O=v&&O[v]||O["@@iterator"],typeof O=="function"?O:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,C={};function R(O,L,ce){this.props=O,this.context=L,this.refs=C,this.updater=ce||m}R.prototype.isReactComponent={},R.prototype.setState=function(O,L){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,L,"setState")},R.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function _(){}_.prototype=R.prototype;function E(O,L,ce){this.props=O,this.context=L,this.refs=C,this.updater=ce||m}var T=E.prototype=new _;T.constructor=E,w(T,R.prototype),T.isPureReactComponent=!0;var D=Array.isArray,N=Object.prototype.hasOwnProperty,H={current:null},ie={key:!0,ref:!0,__self:!0,__source:!0};function Y(O,L,ce){var fe,Se={},me=null,ke=null;if(L!=null)for(fe in L.ref!==void 0&&(ke=L.ref),L.key!==void 0&&(me=""+L.key),L)N.call(L,fe)&&!ie.hasOwnProperty(fe)&&(Se[fe]=L[fe]);var _e=arguments.length-2;if(_e===1)Se.children=ce;else if(1<_e){for(var Oe=Array(_e),dt=0;dt<_e;dt++)Oe[dt]=arguments[dt+2];Se.children=Oe}if(O&&O.defaultProps)for(fe in _e=O.defaultProps,_e)Se[fe]===void 0&&(Se[fe]=_e[fe]);return{$$typeof:i,type:O,key:me,ref:ke,props:Se,_owner:H.current}}function Ie(O,L){return{$$typeof:i,type:O.type,key:L,ref:O.ref,props:O.props,_owner:O._owner}}function De(O){return typeof O=="object"&&O!==null&&O.$$typeof===i}function Xe(O){var L={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ce){return L[ce]})}var Be=/\/+/g;function Ee(O,L){return typeof O=="object"&&O!==null&&O.key!=null?Xe(""+O.key):L.toString(36)}function pe(O,L,ce,fe,Se){var me=typeof O;(me==="undefined"||me==="boolean")&&(O=null);var ke=!1;if(O===null)ke=!0;else switch(me){case"string":case"number":ke=!0;break;case"object":switch(O.$$typeof){case i:case t:ke=!0}}if(ke)return ke=O,Se=Se(ke),O=fe===""?"."+Ee(ke,0):fe,D(Se)?(ce="",O!=null&&(ce=O.replace(Be,"$&/")+"/"),pe(Se,L,ce,"",function(dt){return dt})):Se!=null&&(De(Se)&&(Se=Ie(Se,ce+(!Se.key||ke&&ke.key===Se.key?"":(""+Se.key).replace(Be,"$&/")+"/")+O)),L.push(Se)),1;if(ke=0,fe=fe===""?".":fe+":",D(O))for(var _e=0;_e<O.length;_e++){me=O[_e];var Oe=fe+Ee(me,_e);ke+=pe(me,L,ce,Oe,Se)}else if(Oe=g(O),typeof Oe=="function")for(O=Oe.call(O),_e=0;!(me=O.next()).done;)me=me.value,Oe=fe+Ee(me,_e++),ke+=pe(me,L,ce,Oe,Se);else if(me==="object")throw L=String(O),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return ke}function Ce(O,L,ce){if(O==null)return O;var fe=[],Se=0;return pe(O,fe,"","",function(me){return L.call(ce,me,Se++)}),fe}function ae(O){if(O._status===-1){var L=O._result;L=L(),L.then(function(ce){(O._status===0||O._status===-1)&&(O._status=1,O._result=ce)},function(ce){(O._status===0||O._status===-1)&&(O._status=2,O._result=ce)}),O._status===-1&&(O._status=0,O._result=L)}if(O._status===1)return O._result.default;throw O._result}var se={current:null},$={transition:null},ee={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:$,ReactCurrentOwner:H};function V(){throw Error("act(...) is not supported in production builds of React.")}return we.Children={map:Ce,forEach:function(O,L,ce){Ce(O,function(){L.apply(this,arguments)},ce)},count:function(O){var L=0;return Ce(O,function(){L++}),L},toArray:function(O){return Ce(O,function(L){return L})||[]},only:function(O){if(!De(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},we.Component=R,we.Fragment=r,we.Profiler=o,we.PureComponent=E,we.StrictMode=u,we.Suspense=l,we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,we.act=V,we.cloneElement=function(O,L,ce){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var fe=w({},O.props),Se=O.key,me=O.ref,ke=O._owner;if(L!=null){if(L.ref!==void 0&&(me=L.ref,ke=H.current),L.key!==void 0&&(Se=""+L.key),O.type&&O.type.defaultProps)var _e=O.type.defaultProps;for(Oe in L)N.call(L,Oe)&&!ie.hasOwnProperty(Oe)&&(fe[Oe]=L[Oe]===void 0&&_e!==void 0?_e[Oe]:L[Oe])}var Oe=arguments.length-2;if(Oe===1)fe.children=ce;else if(1<Oe){_e=Array(Oe);for(var dt=0;dt<Oe;dt++)_e[dt]=arguments[dt+2];fe.children=_e}return{$$typeof:i,type:O.type,key:Se,ref:me,props:fe,_owner:ke}},we.createContext=function(O){return O={$$typeof:a,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:c,_context:O},O.Consumer=O},we.createElement=Y,we.createFactory=function(O){var L=Y.bind(null,O);return L.type=O,L},we.createRef=function(){return{current:null}},we.forwardRef=function(O){return{$$typeof:s,render:O}},we.isValidElement=De,we.lazy=function(O){return{$$typeof:h,_payload:{_status:-1,_result:O},_init:ae}},we.memo=function(O,L){return{$$typeof:p,type:O,compare:L===void 0?null:L}},we.startTransition=function(O){var L=$.transition;$.transition={};try{O()}finally{$.transition=L}},we.unstable_act=V,we.useCallback=function(O,L){return se.current.useCallback(O,L)},we.useContext=function(O){return se.current.useContext(O)},we.useDebugValue=function(){},we.useDeferredValue=function(O){return se.current.useDeferredValue(O)},we.useEffect=function(O,L){return se.current.useEffect(O,L)},we.useId=function(){return se.current.useId()},we.useImperativeHandle=function(O,L,ce){return se.current.useImperativeHandle(O,L,ce)},we.useInsertionEffect=function(O,L){return se.current.useInsertionEffect(O,L)},we.useLayoutEffect=function(O,L){return se.current.useLayoutEffect(O,L)},we.useMemo=function(O,L){return se.current.useMemo(O,L)},we.useReducer=function(O,L,ce){return se.current.useReducer(O,L,ce)},we.useRef=function(O){return se.current.useRef(O)},we.useState=function(O){return se.current.useState(O)},we.useSyncExternalStore=function(O,L,ce){return se.current.useSyncExternalStore(O,L,ce)},we.useTransition=function(){return se.current.useTransition()},we.version="18.3.1",we}var Ng;function Jh(){return Ng||(Ng=1,vp.exports=__()),vp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg;function E_(){if(zg)return Ys;zg=1;var i=Jh(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(s,l,p){var h,v={},g=null,m=null;p!==void 0&&(g=""+p),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(m=l.ref);for(h in l)u.call(l,h)&&!c.hasOwnProperty(h)&&(v[h]=l[h]);if(s&&s.defaultProps)for(h in l=s.defaultProps,l)v[h]===void 0&&(v[h]=l[h]);return{$$typeof:t,type:s,key:g,ref:m,props:v,_owner:o.current}}return Ys.Fragment=r,Ys.jsx=a,Ys.jsxs=a,Ys}var Lg;function T_(){return Lg||(Lg=1,fp.exports=E_()),fp.exports}var A=T_(),Q=Jh(),wl={},gp={exports:{}},Mt={},mp={exports:{}},yp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qg;function I_(){return qg||(qg=1,function(i){function t($,ee){var V=$.length;$.push(ee);e:for(;0<V;){var O=V-1>>>1,L=$[O];if(0<o(L,ee))$[O]=ee,$[V]=L,V=O;else break e}}function r($){return $.length===0?null:$[0]}function u($){if($.length===0)return null;var ee=$[0],V=$.pop();if(V!==ee){$[0]=V;e:for(var O=0,L=$.length,ce=L>>>1;O<ce;){var fe=2*(O+1)-1,Se=$[fe],me=fe+1,ke=$[me];if(0>o(Se,V))me<L&&0>o(ke,Se)?($[O]=ke,$[me]=V,O=me):($[O]=Se,$[fe]=V,O=fe);else if(me<L&&0>o(ke,V))$[O]=ke,$[me]=V,O=me;else break e}}return ee}function o($,ee){var V=$.sortIndex-ee.sortIndex;return V!==0?V:$.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;i.unstable_now=function(){return c.now()}}else{var a=Date,s=a.now();i.unstable_now=function(){return a.now()-s}}var l=[],p=[],h=1,v=null,g=3,m=!1,w=!1,C=!1,R=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T($){for(var ee=r(p);ee!==null;){if(ee.callback===null)u(p);else if(ee.startTime<=$)u(p),ee.sortIndex=ee.expirationTime,t(l,ee);else break;ee=r(p)}}function D($){if(C=!1,T($),!w)if(r(l)!==null)w=!0,ae(N);else{var ee=r(p);ee!==null&&se(D,ee.startTime-$)}}function N($,ee){w=!1,C&&(C=!1,_(Y),Y=-1),m=!0;var V=g;try{for(T(ee),v=r(l);v!==null&&(!(v.expirationTime>ee)||$&&!Xe());){var O=v.callback;if(typeof O=="function"){v.callback=null,g=v.priorityLevel;var L=O(v.expirationTime<=ee);ee=i.unstable_now(),typeof L=="function"?v.callback=L:v===r(l)&&u(l),T(ee)}else u(l);v=r(l)}if(v!==null)var ce=!0;else{var fe=r(p);fe!==null&&se(D,fe.startTime-ee),ce=!1}return ce}finally{v=null,g=V,m=!1}}var H=!1,ie=null,Y=-1,Ie=5,De=-1;function Xe(){return!(i.unstable_now()-De<Ie)}function Be(){if(ie!==null){var $=i.unstable_now();De=$;var ee=!0;try{ee=ie(!0,$)}finally{ee?Ee():(H=!1,ie=null)}}else H=!1}var Ee;if(typeof E=="function")Ee=function(){E(Be)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Ce=pe.port2;pe.port1.onmessage=Be,Ee=function(){Ce.postMessage(null)}}else Ee=function(){R(Be,0)};function ae($){ie=$,H||(H=!0,Ee())}function se($,ee){Y=R(function(){$(i.unstable_now())},ee)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function($){$.callback=null},i.unstable_continueExecution=function(){w||m||(w=!0,ae(N))},i.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ie=0<$?Math.floor(1e3/$):5},i.unstable_getCurrentPriorityLevel=function(){return g},i.unstable_getFirstCallbackNode=function(){return r(l)},i.unstable_next=function($){switch(g){case 1:case 2:case 3:var ee=3;break;default:ee=g}var V=g;g=ee;try{return $()}finally{g=V}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function($,ee){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var V=g;g=$;try{return ee()}finally{g=V}},i.unstable_scheduleCallback=function($,ee,V){var O=i.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?O+V:O):V=O,$){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=V+L,$={id:h++,callback:ee,priorityLevel:$,startTime:V,expirationTime:L,sortIndex:-1},V>O?($.sortIndex=V,t(p,$),r(l)===null&&$===r(p)&&(C?(_(Y),Y=-1):C=!0,se(D,V-O))):($.sortIndex=L,t(l,$),w||m||(w=!0,ae(N))),$},i.unstable_shouldYield=Xe,i.unstable_wrapCallback=function($){var ee=g;return function(){var V=g;g=ee;try{return $.apply(this,arguments)}finally{g=V}}}}(yp)),yp}var Bg;function A_(){return Bg||(Bg=1,mp.exports=I_()),mp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg;function b_(){if(Fg)return Mt;Fg=1;var i=Jh(),t=A_();function r(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,d=1;d<arguments.length;d++)n+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,o={};function c(e,n){a(e,n),a(e+"Capture",n)}function a(e,n){for(o[e]=n,e=0;e<n.length;e++)u.add(n[e])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},v={};function g(e){return l.call(v,e)?!0:l.call(h,e)?!1:p.test(e)?v[e]=!0:(h[e]=!0,!1)}function m(e,n,d,f){if(d!==null&&d.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return f?!1:d!==null?!d.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function w(e,n,d,f){if(n===null||typeof n>"u"||m(e,n,d,f))return!0;if(f)return!1;if(d!==null)switch(d.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function C(e,n,d,f,y,S,P){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=e,this.type=n,this.sanitizeURL=S,this.removeEmptyString=P}var R={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){R[e]=new C(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];R[n]=new C(n,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){R[e]=new C(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){R[e]=new C(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){R[e]=new C(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){R[e]=new C(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){R[e]=new C(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){R[e]=new C(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){R[e]=new C(e,5,!1,e.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function E(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(_,E);R[n]=new C(n,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(_,E);R[n]=new C(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(_,E);R[n]=new C(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){R[e]=new C(e,1,!1,e.toLowerCase(),null,!1,!1)}),R.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){R[e]=new C(e,1,!1,e.toLowerCase(),null,!0,!0)});function T(e,n,d,f){var y=R.hasOwnProperty(n)?R[n]:null;(y!==null?y.type!==0:f||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(w(n,d,y,f)&&(d=null),f||y===null?g(n)&&(d===null?e.removeAttribute(n):e.setAttribute(n,""+d)):y.mustUseProperty?e[y.propertyName]=d===null?y.type===3?!1:"":d:(n=y.attributeName,f=y.attributeNamespace,d===null?e.removeAttribute(n):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,f?e.setAttributeNS(f,n,d):e.setAttribute(n,d))))}var D=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),H=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),Ie=Symbol.for("react.profiler"),De=Symbol.for("react.provider"),Xe=Symbol.for("react.context"),Be=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),ae=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),$=Symbol.iterator;function ee(e){return e===null||typeof e!="object"?null:(e=$&&e[$]||e["@@iterator"],typeof e=="function"?e:null)}var V=Object.assign,O;function L(e){if(O===void 0)try{throw Error()}catch(d){var n=d.stack.trim().match(/\n( *(at )?)/);O=n&&n[1]||""}return`
`+O+e}var ce=!1;function fe(e,n){if(!e||ce)return"";ce=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(j){var f=j}Reflect.construct(e,[],n)}else{try{n.call()}catch(j){f=j}e.call(n.prototype)}else{try{throw Error()}catch(j){f=j}e()}}catch(j){if(j&&f&&typeof j.stack=="string"){for(var y=j.stack.split(`
`),S=f.stack.split(`
`),P=y.length-1,I=S.length-1;1<=P&&0<=I&&y[P]!==S[I];)I--;for(;1<=P&&0<=I;P--,I--)if(y[P]!==S[I]){if(P!==1||I!==1)do if(P--,I--,0>I||y[P]!==S[I]){var b=`
`+y[P].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=P&&0<=I);break}}}finally{ce=!1,Error.prepareStackTrace=d}return(e=e?e.displayName||e.name:"")?L(e):""}function Se(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=fe(e.type,!1),e;case 11:return e=fe(e.type.render,!1),e;case 1:return e=fe(e.type,!0),e;default:return""}}function me(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ie:return"Fragment";case H:return"Portal";case Ie:return"Profiler";case Y:return"StrictMode";case Ee:return"Suspense";case pe:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Xe:return(e.displayName||"Context")+".Consumer";case De:return(e._context.displayName||"Context")+".Provider";case Be:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ce:return n=e.displayName||null,n!==null?n:me(e.type)||"Memo";case ae:n=e._payload,e=e._init;try{return me(e(n))}catch{}}return null}function ke(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(n);case 8:return n===Y?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function _e(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Oe(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function dt(e){var n=Oe(e)?"checked":"value",d=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),f=""+e[n];if(!e.hasOwnProperty(n)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,S=d.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return y.call(this)},set:function(P){f=""+P,S.call(this,P)}}),Object.defineProperty(e,n,{enumerable:d.enumerable}),{getValue:function(){return f},setValue:function(P){f=""+P},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Ar(e){e._valueTracker||(e._valueTracker=dt(e))}function Ii(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var d=n.getValue(),f="";return e&&(f=Oe(e)?e.checked?"true":"false":e.value),e=f,e!==d?(n.setValue(e),!0):!1}function gr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Gr(e,n){var d=n.checked;return V({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??e._wrapperState.initialChecked})}function Ai(e,n){var d=n.defaultValue==null?"":n.defaultValue,f=n.checked!=null?n.checked:n.defaultChecked;d=_e(n.value!=null?n.value:d),e._wrapperState={initialChecked:f,initialValue:d,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Zt(e,n){n=n.checked,n!=null&&T(e,"checked",n,!1)}function _t(e,n){Zt(e,n);var d=_e(n.value),f=n.type;if(d!=null)f==="number"?(d===0&&e.value===""||e.value!=d)&&(e.value=""+d):e.value!==""+d&&(e.value=""+d);else if(f==="submit"||f==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Qr(e,n.type,d):n.hasOwnProperty("defaultValue")&&Qr(e,n.type,_e(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function bi(e,n,d){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var f=n.type;if(!(f!=="submit"&&f!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,d||n===e.value||(e.value=n),e.defaultValue=n}d=e.name,d!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,d!==""&&(e.name=d)}function Qr(e,n,d){(n!=="number"||gr(e.ownerDocument)!==e)&&(d==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+d&&(e.defaultValue=""+d))}var br=Array.isArray;function Vt(e,n,d,f){if(e=e.options,n){n={};for(var y=0;y<d.length;y++)n["$"+d[y]]=!0;for(d=0;d<e.length;d++)y=n.hasOwnProperty("$"+e[d].value),e[d].selected!==y&&(e[d].selected=y),y&&f&&(e[d].defaultSelected=!0)}else{for(d=""+_e(d),n=null,y=0;y<e.length;y++){if(e[y].value===d){e[y].selected=!0,f&&(e[y].defaultSelected=!0);return}n!==null||e[y].disabled||(n=e[y])}n!==null&&(n.selected=!0)}}function Yr(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return V({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function On(e,n){var d=n.value;if(d==null){if(d=n.children,n=n.defaultValue,d!=null){if(n!=null)throw Error(r(92));if(br(d)){if(1<d.length)throw Error(r(93));d=d[0]}n=d}n==null&&(n=""),d=n}e._wrapperState={initialValue:_e(d)}}function ki(e,n){var d=_e(n.value),f=_e(n.defaultValue);d!=null&&(d=""+d,d!==e.value&&(e.value=d),n.defaultValue==null&&e.defaultValue!==d&&(e.defaultValue=d)),f!=null&&(e.defaultValue=""+f)}function Dt(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Mn(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kr(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Mn(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var er,Or=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,d,f,y){MSApp.execUnsafeLocalFunction(function(){return e(n,d,f,y)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(er=er||document.createElement("div"),er.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=er.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Mr(e,n){if(n){var d=e.firstChild;if(d&&d===e.lastChild&&d.nodeType===3){d.nodeValue=n;return}}e.textContent=n}var jt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nt=["Webkit","ms","Moz","O"];Object.keys(jt).forEach(function(e){nt.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),jt[n]=jt[e]})});function xn(e,n,d){return n==null||typeof n=="boolean"||n===""?"":d||typeof n!="number"||n===0||jt.hasOwnProperty(e)&&jt[e]?(""+n).trim():n+"px"}function Xr(e,n){e=e.style;for(var d in n)if(n.hasOwnProperty(d)){var f=d.indexOf("--")===0,y=xn(d,n[d],f);d==="float"&&(d="cssFloat"),f?e.setProperty(d,y):e[d]=y}}var ms=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zr(e,n){if(n){if(ms[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function en(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tn=null;function mr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xr=null,tr=null,rr=null;function Dn(e){if(e=Ns(e)){if(typeof xr!="function")throw Error(r(280));var n=e.stateNode;n&&(n=Nu(n),xr(e.stateNode,e.type,n))}}function Dr(e){tr?rr?rr.push(e):rr=[e]:tr=e}function Oi(){if(tr){var e=tr,n=rr;if(rr=tr=null,Dn(e),n)for(e=0;e<n.length;e++)Dn(n[e])}}function Mi(e,n){return e(n)}function z(){}var G=!1;function K(e,n,d){if(G)return e(n,d);G=!0;try{return Mi(e,n,d)}finally{G=!1,(tr!==null||rr!==null)&&(z(),Oi())}}function J(e,n){var d=e.stateNode;if(d===null)return null;var f=Nu(d);if(f===null)return null;d=f[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(e=e.type,f=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!f;break e;default:e=!1}if(e)return null;if(d&&typeof d!="function")throw Error(r(231,n,typeof d));return d}var ve=!1;if(s)try{var xe={};Object.defineProperty(xe,"passive",{get:function(){ve=!0}}),window.addEventListener("test",xe,xe),window.removeEventListener("test",xe,xe)}catch{ve=!1}function yr(e,n,d,f,y,S,P,I,b){var j=Array.prototype.slice.call(arguments,3);try{n.apply(d,j)}catch(B){this.onError(B)}}var Nt=!1,Et=null,zt=!1,nr=null,it={onError:function(e){Nt=!0,Et=e}};function Ke(e,n,d,f,y,S,P,I,b){Nt=!1,Et=null,yr.apply(it,arguments)}function Ue(e,n,d,f,y,S,P,I,b){if(Ke.apply(this,arguments),Nt){if(Nt){var j=Et;Nt=!1,Et=null}else throw Error(r(198));zt||(zt=!0,nr=j)}}function pt(e){var n=e,d=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(d=n.return),e=n.return;while(e)}return n.tag===3?d:null}function Ze(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function jn(e){if(pt(e)!==e)throw Error(r(188))}function $e(e){var n=e.alternate;if(!n){if(n=pt(e),n===null)throw Error(r(188));return n!==e?null:e}for(var d=e,f=n;;){var y=d.return;if(y===null)break;var S=y.alternate;if(S===null){if(f=y.return,f!==null){d=f;continue}break}if(y.child===S.child){for(S=y.child;S;){if(S===d)return jn(y),e;if(S===f)return jn(y),n;S=S.sibling}throw Error(r(188))}if(d.return!==f.return)d=y,f=S;else{for(var P=!1,I=y.child;I;){if(I===d){P=!0,d=y,f=S;break}if(I===f){P=!0,f=y,d=S;break}I=I.sibling}if(!P){for(I=S.child;I;){if(I===d){P=!0,d=S,f=y;break}if(I===f){P=!0,f=S,d=y;break}I=I.sibling}if(!P)throw Error(r(189))}}if(d.alternate!==f)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?e:n}function jr(e){return e=$e(e),e!==null?Tt(e):null}function Tt(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Tt(e);if(n!==null)return n;e=e.sibling}return null}var Nn=t.unstable_scheduleCallback,uf=t.unstable_cancelCallback,DP=t.unstable_shouldYield,jP=t.unstable_requestPaint,Ge=t.unstable_now,NP=t.unstable_getCurrentPriorityLevel,Dl=t.unstable_ImmediatePriority,lf=t.unstable_UserBlockingPriority,gu=t.unstable_NormalPriority,zP=t.unstable_LowPriority,df=t.unstable_IdlePriority,mu=null,Sr=null;function LP(e){if(Sr&&typeof Sr.onCommitFiberRoot=="function")try{Sr.onCommitFiberRoot(mu,e,void 0,(e.current.flags&128)===128)}catch{}}var ir=Math.clz32?Math.clz32:FP,qP=Math.log,BP=Math.LN2;function FP(e){return e>>>=0,e===0?32:31-(qP(e)/BP|0)|0}var yu=64,Su=4194304;function ys(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cu(e,n){var d=e.pendingLanes;if(d===0)return 0;var f=0,y=e.suspendedLanes,S=e.pingedLanes,P=d&268435455;if(P!==0){var I=P&~y;I!==0?f=ys(I):(S&=P,S!==0&&(f=ys(S)))}else P=d&~y,P!==0?f=ys(P):S!==0&&(f=ys(S));if(f===0)return 0;if(n!==0&&n!==f&&(n&y)===0&&(y=f&-f,S=n&-n,y>=S||y===16&&(S&4194240)!==0))return n;if((f&4)!==0&&(f|=d&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=f;0<n;)d=31-ir(n),y=1<<d,f|=e[d],n&=~y;return f}function UP(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $P(e,n){for(var d=e.suspendedLanes,f=e.pingedLanes,y=e.expirationTimes,S=e.pendingLanes;0<S;){var P=31-ir(S),I=1<<P,b=y[P];b===-1?((I&d)===0||(I&f)!==0)&&(y[P]=UP(I,n)):b<=n&&(e.expiredLanes|=I),S&=~I}}function jl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function pf(){var e=yu;return yu<<=1,(yu&4194240)===0&&(yu=64),e}function Nl(e){for(var n=[],d=0;31>d;d++)n.push(e);return n}function Ss(e,n,d){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-ir(n),e[n]=d}function WP(e,n){var d=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var f=e.eventTimes;for(e=e.expirationTimes;0<d;){var y=31-ir(d),S=1<<y;n[y]=0,f[y]=-1,e[y]=-1,d&=~S}}function zl(e,n){var d=e.entangledLanes|=n;for(e=e.entanglements;d;){var f=31-ir(d),y=1<<f;y&n|e[f]&n&&(e[f]|=n),d&=~y}}var Me=0;function hf(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var ff,Ll,vf,gf,mf,ql=!1,wu=[],rn=null,nn=null,sn=null,Cs=new Map,ws=new Map,on=[],HP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yf(e,n){switch(e){case"focusin":case"focusout":rn=null;break;case"dragenter":case"dragleave":nn=null;break;case"mouseover":case"mouseout":sn=null;break;case"pointerover":case"pointerout":Cs.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ws.delete(n.pointerId)}}function Rs(e,n,d,f,y,S){return e===null||e.nativeEvent!==S?(e={blockedOn:n,domEventName:d,eventSystemFlags:f,nativeEvent:S,targetContainers:[y]},n!==null&&(n=Ns(n),n!==null&&Ll(n)),e):(e.eventSystemFlags|=f,n=e.targetContainers,y!==null&&n.indexOf(y)===-1&&n.push(y),e)}function VP(e,n,d,f,y){switch(n){case"focusin":return rn=Rs(rn,e,n,d,f,y),!0;case"dragenter":return nn=Rs(nn,e,n,d,f,y),!0;case"mouseover":return sn=Rs(sn,e,n,d,f,y),!0;case"pointerover":var S=y.pointerId;return Cs.set(S,Rs(Cs.get(S)||null,e,n,d,f,y)),!0;case"gotpointercapture":return S=y.pointerId,ws.set(S,Rs(ws.get(S)||null,e,n,d,f,y)),!0}return!1}function Sf(e){var n=zn(e.target);if(n!==null){var d=pt(n);if(d!==null){if(n=d.tag,n===13){if(n=Ze(d),n!==null){e.blockedOn=n,mf(e.priority,function(){vf(d)});return}}else if(n===3&&d.stateNode.current.memoizedState.isDehydrated){e.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ru(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var d=Fl(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(d===null){d=e.nativeEvent;var f=new d.constructor(d.type,d);tn=f,d.target.dispatchEvent(f),tn=null}else return n=Ns(d),n!==null&&Ll(n),e.blockedOn=d,!1;n.shift()}return!0}function Cf(e,n,d){Ru(e)&&d.delete(n)}function KP(){ql=!1,rn!==null&&Ru(rn)&&(rn=null),nn!==null&&Ru(nn)&&(nn=null),sn!==null&&Ru(sn)&&(sn=null),Cs.forEach(Cf),ws.forEach(Cf)}function Ps(e,n){e.blockedOn===n&&(e.blockedOn=null,ql||(ql=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,KP)))}function _s(e){function n(y){return Ps(y,e)}if(0<wu.length){Ps(wu[0],e);for(var d=1;d<wu.length;d++){var f=wu[d];f.blockedOn===e&&(f.blockedOn=null)}}for(rn!==null&&Ps(rn,e),nn!==null&&Ps(nn,e),sn!==null&&Ps(sn,e),Cs.forEach(n),ws.forEach(n),d=0;d<on.length;d++)f=on[d],f.blockedOn===e&&(f.blockedOn=null);for(;0<on.length&&(d=on[0],d.blockedOn===null);)Sf(d),d.blockedOn===null&&on.shift()}var xi=D.ReactCurrentBatchConfig,Pu=!0;function JP(e,n,d,f){var y=Me,S=xi.transition;xi.transition=null;try{Me=1,Bl(e,n,d,f)}finally{Me=y,xi.transition=S}}function GP(e,n,d,f){var y=Me,S=xi.transition;xi.transition=null;try{Me=4,Bl(e,n,d,f)}finally{Me=y,xi.transition=S}}function Bl(e,n,d,f){if(Pu){var y=Fl(e,n,d,f);if(y===null)id(e,n,f,_u,d),yf(e,f);else if(VP(y,e,n,d,f))f.stopPropagation();else if(yf(e,f),n&4&&-1<HP.indexOf(e)){for(;y!==null;){var S=Ns(y);if(S!==null&&ff(S),S=Fl(e,n,d,f),S===null&&id(e,n,f,_u,d),S===y)break;y=S}y!==null&&f.stopPropagation()}else id(e,n,f,null,d)}}var _u=null;function Fl(e,n,d,f){if(_u=null,e=mr(f),e=zn(e),e!==null)if(n=pt(e),n===null)e=null;else if(d=n.tag,d===13){if(e=Ze(n),e!==null)return e;e=null}else if(d===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return _u=e,null}function wf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NP()){case Dl:return 1;case lf:return 4;case gu:case zP:return 16;case df:return 536870912;default:return 16}default:return 16}}var an=null,Ul=null,Eu=null;function Rf(){if(Eu)return Eu;var e,n=Ul,d=n.length,f,y="value"in an?an.value:an.textContent,S=y.length;for(e=0;e<d&&n[e]===y[e];e++);var P=d-e;for(f=1;f<=P&&n[d-f]===y[S-f];f++);return Eu=y.slice(e,1<f?1-f:void 0)}function Tu(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Iu(){return!0}function Pf(){return!1}function Lt(e){function n(d,f,y,S,P){this._reactName=d,this._targetInst=y,this.type=f,this.nativeEvent=S,this.target=P,this.currentTarget=null;for(var I in e)e.hasOwnProperty(I)&&(d=e[I],this[I]=d?d(S):S[I]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Iu:Pf,this.isPropagationStopped=Pf,this}return V(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Iu)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Iu)},persist:function(){},isPersistent:Iu}),n}var Di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$l=Lt(Di),Es=V({},Di,{view:0,detail:0}),QP=Lt(Es),Wl,Hl,Ts,Au=V({},Es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ts&&(Ts&&e.type==="mousemove"?(Wl=e.screenX-Ts.screenX,Hl=e.screenY-Ts.screenY):Hl=Wl=0,Ts=e),Wl)},movementY:function(e){return"movementY"in e?e.movementY:Hl}}),_f=Lt(Au),YP=V({},Au,{dataTransfer:0}),XP=Lt(YP),ZP=V({},Es,{relatedTarget:0}),Vl=Lt(ZP),e0=V({},Di,{animationName:0,elapsedTime:0,pseudoElement:0}),t0=Lt(e0),r0=V({},Di,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),n0=Lt(r0),i0=V({},Di,{data:0}),Ef=Lt(i0),s0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=a0[e])?!!n[e]:!1}function Kl(){return c0}var u0=V({},Es,{key:function(e){if(e.key){var n=s0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Tu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?o0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kl,charCode:function(e){return e.type==="keypress"?Tu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),l0=Lt(u0),d0=V({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tf=Lt(d0),p0=V({},Es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kl}),h0=Lt(p0),f0=V({},Di,{propertyName:0,elapsedTime:0,pseudoElement:0}),v0=Lt(f0),g0=V({},Au,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),m0=Lt(g0),y0=[9,13,27,32],Jl=s&&"CompositionEvent"in window,Is=null;s&&"documentMode"in document&&(Is=document.documentMode);var S0=s&&"TextEvent"in window&&!Is,If=s&&(!Jl||Is&&8<Is&&11>=Is),Af=" ",bf=!1;function kf(e,n){switch(e){case"keyup":return y0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Of(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ji=!1;function C0(e,n){switch(e){case"compositionend":return Of(n);case"keypress":return n.which!==32?null:(bf=!0,Af);case"textInput":return e=n.data,e===Af&&bf?null:e;default:return null}}function w0(e,n){if(ji)return e==="compositionend"||!Jl&&kf(e,n)?(e=Rf(),Eu=Ul=an=null,ji=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return If&&n.locale!=="ko"?null:n.data;default:return null}}var R0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mf(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!R0[e.type]:n==="textarea"}function xf(e,n,d,f){Dr(f),n=xu(n,"onChange"),0<n.length&&(d=new $l("onChange","change",null,d,f),e.push({event:d,listeners:n}))}var As=null,bs=null;function P0(e){Yf(e,0)}function bu(e){var n=Bi(e);if(Ii(n))return e}function _0(e,n){if(e==="change")return n}var Df=!1;if(s){var Gl;if(s){var Ql="oninput"in document;if(!Ql){var jf=document.createElement("div");jf.setAttribute("oninput","return;"),Ql=typeof jf.oninput=="function"}Gl=Ql}else Gl=!1;Df=Gl&&(!document.documentMode||9<document.documentMode)}function Nf(){As&&(As.detachEvent("onpropertychange",zf),bs=As=null)}function zf(e){if(e.propertyName==="value"&&bu(bs)){var n=[];xf(n,bs,e,mr(e)),K(P0,n)}}function E0(e,n,d){e==="focusin"?(Nf(),As=n,bs=d,As.attachEvent("onpropertychange",zf)):e==="focusout"&&Nf()}function T0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bu(bs)}function I0(e,n){if(e==="click")return bu(n)}function A0(e,n){if(e==="input"||e==="change")return bu(n)}function b0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var sr=typeof Object.is=="function"?Object.is:b0;function ks(e,n){if(sr(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var d=Object.keys(e),f=Object.keys(n);if(d.length!==f.length)return!1;for(f=0;f<d.length;f++){var y=d[f];if(!l.call(n,y)||!sr(e[y],n[y]))return!1}return!0}function Lf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qf(e,n){var d=Lf(e);e=0;for(var f;d;){if(d.nodeType===3){if(f=e+d.textContent.length,e<=n&&f>=n)return{node:d,offset:n-e};e=f}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Lf(d)}}function Bf(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Bf(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Ff(){for(var e=window,n=gr();n instanceof e.HTMLIFrameElement;){try{var d=typeof n.contentWindow.location.href=="string"}catch{d=!1}if(d)e=n.contentWindow;else break;n=gr(e.document)}return n}function Yl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function k0(e){var n=Ff(),d=e.focusedElem,f=e.selectionRange;if(n!==d&&d&&d.ownerDocument&&Bf(d.ownerDocument.documentElement,d)){if(f!==null&&Yl(d)){if(n=f.start,e=f.end,e===void 0&&(e=n),"selectionStart"in d)d.selectionStart=n,d.selectionEnd=Math.min(e,d.value.length);else if(e=(n=d.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var y=d.textContent.length,S=Math.min(f.start,y);f=f.end===void 0?S:Math.min(f.end,y),!e.extend&&S>f&&(y=f,f=S,S=y),y=qf(d,S);var P=qf(d,f);y&&P&&(e.rangeCount!==1||e.anchorNode!==y.node||e.anchorOffset!==y.offset||e.focusNode!==P.node||e.focusOffset!==P.offset)&&(n=n.createRange(),n.setStart(y.node,y.offset),e.removeAllRanges(),S>f?(e.addRange(n),e.extend(P.node,P.offset)):(n.setEnd(P.node,P.offset),e.addRange(n)))}}for(n=[],e=d;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<n.length;d++)e=n[d],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var O0=s&&"documentMode"in document&&11>=document.documentMode,Ni=null,Xl=null,Os=null,Zl=!1;function Uf(e,n,d){var f=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Zl||Ni==null||Ni!==gr(f)||(f=Ni,"selectionStart"in f&&Yl(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Os&&ks(Os,f)||(Os=f,f=xu(Xl,"onSelect"),0<f.length&&(n=new $l("onSelect","select",null,n,d),e.push({event:n,listeners:f}),n.target=Ni)))}function ku(e,n){var d={};return d[e.toLowerCase()]=n.toLowerCase(),d["Webkit"+e]="webkit"+n,d["Moz"+e]="moz"+n,d}var zi={animationend:ku("Animation","AnimationEnd"),animationiteration:ku("Animation","AnimationIteration"),animationstart:ku("Animation","AnimationStart"),transitionend:ku("Transition","TransitionEnd")},ed={},$f={};s&&($f=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function Ou(e){if(ed[e])return ed[e];if(!zi[e])return e;var n=zi[e],d;for(d in n)if(n.hasOwnProperty(d)&&d in $f)return ed[e]=n[d];return e}var Wf=Ou("animationend"),Hf=Ou("animationiteration"),Vf=Ou("animationstart"),Kf=Ou("transitionend"),Jf=new Map,Gf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cn(e,n){Jf.set(e,n),c(n,[e])}for(var td=0;td<Gf.length;td++){var rd=Gf[td],M0=rd.toLowerCase(),x0=rd[0].toUpperCase()+rd.slice(1);cn(M0,"on"+x0)}cn(Wf,"onAnimationEnd"),cn(Hf,"onAnimationIteration"),cn(Vf,"onAnimationStart"),cn("dblclick","onDoubleClick"),cn("focusin","onFocus"),cn("focusout","onBlur"),cn(Kf,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ms));function Qf(e,n,d){var f=e.type||"unknown-event";e.currentTarget=d,Ue(f,n,void 0,e),e.currentTarget=null}function Yf(e,n){n=(n&4)!==0;for(var d=0;d<e.length;d++){var f=e[d],y=f.event;f=f.listeners;e:{var S=void 0;if(n)for(var P=f.length-1;0<=P;P--){var I=f[P],b=I.instance,j=I.currentTarget;if(I=I.listener,b!==S&&y.isPropagationStopped())break e;Qf(y,I,j),S=b}else for(P=0;P<f.length;P++){if(I=f[P],b=I.instance,j=I.currentTarget,I=I.listener,b!==S&&y.isPropagationStopped())break e;Qf(y,I,j),S=b}}}if(zt)throw e=nr,zt=!1,nr=null,e}function ze(e,n){var d=n[ld];d===void 0&&(d=n[ld]=new Set);var f=e+"__bubble";d.has(f)||(Xf(n,e,2,!1),d.add(f))}function nd(e,n,d){var f=0;n&&(f|=4),Xf(d,e,f,n)}var Mu="_reactListening"+Math.random().toString(36).slice(2);function xs(e){if(!e[Mu]){e[Mu]=!0,u.forEach(function(d){d!=="selectionchange"&&(D0.has(d)||nd(d,!1,e),nd(d,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Mu]||(n[Mu]=!0,nd("selectionchange",!1,n))}}function Xf(e,n,d,f){switch(wf(n)){case 1:var y=JP;break;case 4:y=GP;break;default:y=Bl}d=y.bind(null,n,d,e),y=void 0,!ve||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(y=!0),f?y!==void 0?e.addEventListener(n,d,{capture:!0,passive:y}):e.addEventListener(n,d,!0):y!==void 0?e.addEventListener(n,d,{passive:y}):e.addEventListener(n,d,!1)}function id(e,n,d,f,y){var S=f;if((n&1)===0&&(n&2)===0&&f!==null)e:for(;;){if(f===null)return;var P=f.tag;if(P===3||P===4){var I=f.stateNode.containerInfo;if(I===y||I.nodeType===8&&I.parentNode===y)break;if(P===4)for(P=f.return;P!==null;){var b=P.tag;if((b===3||b===4)&&(b=P.stateNode.containerInfo,b===y||b.nodeType===8&&b.parentNode===y))return;P=P.return}for(;I!==null;){if(P=zn(I),P===null)return;if(b=P.tag,b===5||b===6){f=S=P;continue e}I=I.parentNode}}f=f.return}K(function(){var j=S,B=mr(d),F=[];e:{var q=Jf.get(e);if(q!==void 0){var X=$l,re=e;switch(e){case"keypress":if(Tu(d)===0)break e;case"keydown":case"keyup":X=l0;break;case"focusin":re="focus",X=Vl;break;case"focusout":re="blur",X=Vl;break;case"beforeblur":case"afterblur":X=Vl;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=_f;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=XP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=h0;break;case Wf:case Hf:case Vf:X=t0;break;case Kf:X=v0;break;case"scroll":X=QP;break;case"wheel":X=m0;break;case"copy":case"cut":case"paste":X=n0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Tf}var ne=(n&4)!==0,Qe=!ne&&e==="scroll",M=ne?q!==null?q+"Capture":null:q;ne=[];for(var k=j,x;k!==null;){x=k;var W=x.stateNode;if(x.tag===5&&W!==null&&(x=W,M!==null&&(W=J(k,M),W!=null&&ne.push(Ds(k,W,x)))),Qe)break;k=k.return}0<ne.length&&(q=new X(q,re,null,d,B),F.push({event:q,listeners:ne}))}}if((n&7)===0){e:{if(q=e==="mouseover"||e==="pointerover",X=e==="mouseout"||e==="pointerout",q&&d!==tn&&(re=d.relatedTarget||d.fromElement)&&(zn(re)||re[Nr]))break e;if((X||q)&&(q=B.window===B?B:(q=B.ownerDocument)?q.defaultView||q.parentWindow:window,X?(re=d.relatedTarget||d.toElement,X=j,re=re?zn(re):null,re!==null&&(Qe=pt(re),re!==Qe||re.tag!==5&&re.tag!==6)&&(re=null)):(X=null,re=j),X!==re)){if(ne=_f,W="onMouseLeave",M="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(ne=Tf,W="onPointerLeave",M="onPointerEnter",k="pointer"),Qe=X==null?q:Bi(X),x=re==null?q:Bi(re),q=new ne(W,k+"leave",X,d,B),q.target=Qe,q.relatedTarget=x,W=null,zn(B)===j&&(ne=new ne(M,k+"enter",re,d,B),ne.target=x,ne.relatedTarget=Qe,W=ne),Qe=W,X&&re)t:{for(ne=X,M=re,k=0,x=ne;x;x=Li(x))k++;for(x=0,W=M;W;W=Li(W))x++;for(;0<k-x;)ne=Li(ne),k--;for(;0<x-k;)M=Li(M),x--;for(;k--;){if(ne===M||M!==null&&ne===M.alternate)break t;ne=Li(ne),M=Li(M)}ne=null}else ne=null;X!==null&&Zf(F,q,X,ne,!1),re!==null&&Qe!==null&&Zf(F,Qe,re,ne,!0)}}e:{if(q=j?Bi(j):window,X=q.nodeName&&q.nodeName.toLowerCase(),X==="select"||X==="input"&&q.type==="file")var oe=_0;else if(Mf(q))if(Df)oe=A0;else{oe=T0;var ue=E0}else(X=q.nodeName)&&X.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(oe=I0);if(oe&&(oe=oe(e,j))){xf(F,oe,d,B);break e}ue&&ue(e,q,j),e==="focusout"&&(ue=q._wrapperState)&&ue.controlled&&q.type==="number"&&Qr(q,"number",q.value)}switch(ue=j?Bi(j):window,e){case"focusin":(Mf(ue)||ue.contentEditable==="true")&&(Ni=ue,Xl=j,Os=null);break;case"focusout":Os=Xl=Ni=null;break;case"mousedown":Zl=!0;break;case"contextmenu":case"mouseup":case"dragend":Zl=!1,Uf(F,d,B);break;case"selectionchange":if(O0)break;case"keydown":case"keyup":Uf(F,d,B)}var le;if(Jl)e:{switch(e){case"compositionstart":var he="onCompositionStart";break e;case"compositionend":he="onCompositionEnd";break e;case"compositionupdate":he="onCompositionUpdate";break e}he=void 0}else ji?kf(e,d)&&(he="onCompositionEnd"):e==="keydown"&&d.keyCode===229&&(he="onCompositionStart");he&&(If&&d.locale!=="ko"&&(ji||he!=="onCompositionStart"?he==="onCompositionEnd"&&ji&&(le=Rf()):(an=B,Ul="value"in an?an.value:an.textContent,ji=!0)),ue=xu(j,he),0<ue.length&&(he=new Ef(he,e,null,d,B),F.push({event:he,listeners:ue}),le?he.data=le:(le=Of(d),le!==null&&(he.data=le)))),(le=S0?C0(e,d):w0(e,d))&&(j=xu(j,"onBeforeInput"),0<j.length&&(B=new Ef("onBeforeInput","beforeinput",null,d,B),F.push({event:B,listeners:j}),B.data=le))}Yf(F,n)})}function Ds(e,n,d){return{instance:e,listener:n,currentTarget:d}}function xu(e,n){for(var d=n+"Capture",f=[];e!==null;){var y=e,S=y.stateNode;y.tag===5&&S!==null&&(y=S,S=J(e,d),S!=null&&f.unshift(Ds(e,S,y)),S=J(e,n),S!=null&&f.push(Ds(e,S,y))),e=e.return}return f}function Li(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Zf(e,n,d,f,y){for(var S=n._reactName,P=[];d!==null&&d!==f;){var I=d,b=I.alternate,j=I.stateNode;if(b!==null&&b===f)break;I.tag===5&&j!==null&&(I=j,y?(b=J(d,S),b!=null&&P.unshift(Ds(d,b,I))):y||(b=J(d,S),b!=null&&P.push(Ds(d,b,I)))),d=d.return}P.length!==0&&e.push({event:n,listeners:P})}var j0=/\r\n?/g,N0=/\u0000|\uFFFD/g;function ev(e){return(typeof e=="string"?e:""+e).replace(j0,`
`).replace(N0,"")}function Du(e,n,d){if(n=ev(n),ev(e)!==n&&d)throw Error(r(425))}function ju(){}var sd=null,od=null;function ad(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var cd=typeof setTimeout=="function"?setTimeout:void 0,z0=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,L0=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(e){return tv.resolve(null).then(e).catch(q0)}:cd;function q0(e){setTimeout(function(){throw e})}function ud(e,n){var d=n,f=0;do{var y=d.nextSibling;if(e.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(f===0){e.removeChild(y),_s(n);return}f--}else d!=="$"&&d!=="$?"&&d!=="$!"||f++;d=y}while(d);_s(n)}function un(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function rv(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var d=e.data;if(d==="$"||d==="$!"||d==="$?"){if(n===0)return e;n--}else d==="/$"&&n++}e=e.previousSibling}return null}var qi=Math.random().toString(36).slice(2),Cr="__reactFiber$"+qi,js="__reactProps$"+qi,Nr="__reactContainer$"+qi,ld="__reactEvents$"+qi,B0="__reactListeners$"+qi,F0="__reactHandles$"+qi;function zn(e){var n=e[Cr];if(n)return n;for(var d=e.parentNode;d;){if(n=d[Nr]||d[Cr]){if(d=n.alternate,n.child!==null||d!==null&&d.child!==null)for(e=rv(e);e!==null;){if(d=e[Cr])return d;e=rv(e)}return n}e=d,d=e.parentNode}return null}function Ns(e){return e=e[Cr]||e[Nr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Nu(e){return e[js]||null}var dd=[],Fi=-1;function ln(e){return{current:e}}function Le(e){0>Fi||(e.current=dd[Fi],dd[Fi]=null,Fi--)}function je(e,n){Fi++,dd[Fi]=e.current,e.current=n}var dn={},gt=ln(dn),It=ln(!1),Ln=dn;function Ui(e,n){var d=e.type.contextTypes;if(!d)return dn;var f=e.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===n)return f.__reactInternalMemoizedMaskedChildContext;var y={},S;for(S in d)y[S]=n[S];return f&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=y),y}function At(e){return e=e.childContextTypes,e!=null}function zu(){Le(It),Le(gt)}function nv(e,n,d){if(gt.current!==dn)throw Error(r(168));je(gt,n),je(It,d)}function iv(e,n,d){var f=e.stateNode;if(n=n.childContextTypes,typeof f.getChildContext!="function")return d;f=f.getChildContext();for(var y in f)if(!(y in n))throw Error(r(108,ke(e)||"Unknown",y));return V({},d,f)}function Lu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||dn,Ln=gt.current,je(gt,e),je(It,It.current),!0}function sv(e,n,d){var f=e.stateNode;if(!f)throw Error(r(169));d?(e=iv(e,n,Ln),f.__reactInternalMemoizedMergedChildContext=e,Le(It),Le(gt),je(gt,e)):Le(It),je(It,d)}var zr=null,qu=!1,pd=!1;function ov(e){zr===null?zr=[e]:zr.push(e)}function U0(e){qu=!0,ov(e)}function pn(){if(!pd&&zr!==null){pd=!0;var e=0,n=Me;try{var d=zr;for(Me=1;e<d.length;e++){var f=d[e];do f=f(!0);while(f!==null)}zr=null,qu=!1}catch(y){throw zr!==null&&(zr=zr.slice(e+1)),Nn(Dl,pn),y}finally{Me=n,pd=!1}}return null}var $i=[],Wi=0,Bu=null,Fu=0,Kt=[],Jt=0,qn=null,Lr=1,qr="";function Bn(e,n){$i[Wi++]=Fu,$i[Wi++]=Bu,Bu=e,Fu=n}function av(e,n,d){Kt[Jt++]=Lr,Kt[Jt++]=qr,Kt[Jt++]=qn,qn=e;var f=Lr;e=qr;var y=32-ir(f)-1;f&=~(1<<y),d+=1;var S=32-ir(n)+y;if(30<S){var P=y-y%5;S=(f&(1<<P)-1).toString(32),f>>=P,y-=P,Lr=1<<32-ir(n)+y|d<<y|f,qr=S+e}else Lr=1<<S|d<<y|f,qr=e}function hd(e){e.return!==null&&(Bn(e,1),av(e,1,0))}function fd(e){for(;e===Bu;)Bu=$i[--Wi],$i[Wi]=null,Fu=$i[--Wi],$i[Wi]=null;for(;e===qn;)qn=Kt[--Jt],Kt[Jt]=null,qr=Kt[--Jt],Kt[Jt]=null,Lr=Kt[--Jt],Kt[Jt]=null}var qt=null,Bt=null,Fe=!1,or=null;function cv(e,n){var d=Xt(5,null,null,0);d.elementType="DELETED",d.stateNode=n,d.return=e,n=e.deletions,n===null?(e.deletions=[d],e.flags|=16):n.push(d)}function uv(e,n){switch(e.tag){case 5:var d=e.type;return n=n.nodeType!==1||d.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,qt=e,Bt=un(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,qt=e,Bt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(d=qn!==null?{id:Lr,overflow:qr}:null,e.memoizedState={dehydrated:n,treeContext:d,retryLane:1073741824},d=Xt(18,null,null,0),d.stateNode=n,d.return=e,e.child=d,qt=e,Bt=null,!0):!1;default:return!1}}function vd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gd(e){if(Fe){var n=Bt;if(n){var d=n;if(!uv(e,n)){if(vd(e))throw Error(r(418));n=un(d.nextSibling);var f=qt;n&&uv(e,n)?cv(f,d):(e.flags=e.flags&-4097|2,Fe=!1,qt=e)}}else{if(vd(e))throw Error(r(418));e.flags=e.flags&-4097|2,Fe=!1,qt=e}}}function lv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qt=e}function Uu(e){if(e!==qt)return!1;if(!Fe)return lv(e),Fe=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!ad(e.type,e.memoizedProps)),n&&(n=Bt)){if(vd(e))throw dv(),Error(r(418));for(;n;)cv(e,n),n=un(n.nextSibling)}if(lv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var d=e.data;if(d==="/$"){if(n===0){Bt=un(e.nextSibling);break e}n--}else d!=="$"&&d!=="$!"&&d!=="$?"||n++}e=e.nextSibling}Bt=null}}else Bt=qt?un(e.stateNode.nextSibling):null;return!0}function dv(){for(var e=Bt;e;)e=un(e.nextSibling)}function Hi(){Bt=qt=null,Fe=!1}function md(e){or===null?or=[e]:or.push(e)}var $0=D.ReactCurrentBatchConfig;function zs(e,n,d){if(e=d.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(r(309));var f=d.stateNode}if(!f)throw Error(r(147,e));var y=f,S=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===S?n.ref:(n=function(P){var I=y.refs;P===null?delete I[S]:I[S]=P},n._stringRef=S,n)}if(typeof e!="string")throw Error(r(284));if(!d._owner)throw Error(r(290,e))}return e}function $u(e,n){throw e=Object.prototype.toString.call(n),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function pv(e){var n=e._init;return n(e._payload)}function hv(e){function n(M,k){if(e){var x=M.deletions;x===null?(M.deletions=[k],M.flags|=16):x.push(k)}}function d(M,k){if(!e)return null;for(;k!==null;)n(M,k),k=k.sibling;return null}function f(M,k){for(M=new Map;k!==null;)k.key!==null?M.set(k.key,k):M.set(k.index,k),k=k.sibling;return M}function y(M,k){return M=Cn(M,k),M.index=0,M.sibling=null,M}function S(M,k,x){return M.index=x,e?(x=M.alternate,x!==null?(x=x.index,x<k?(M.flags|=2,k):x):(M.flags|=2,k)):(M.flags|=1048576,k)}function P(M){return e&&M.alternate===null&&(M.flags|=2),M}function I(M,k,x,W){return k===null||k.tag!==6?(k=cp(x,M.mode,W),k.return=M,k):(k=y(k,x),k.return=M,k)}function b(M,k,x,W){var oe=x.type;return oe===ie?B(M,k,x.props.children,W,x.key):k!==null&&(k.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===ae&&pv(oe)===k.type)?(W=y(k,x.props),W.ref=zs(M,k,x),W.return=M,W):(W=hl(x.type,x.key,x.props,null,M.mode,W),W.ref=zs(M,k,x),W.return=M,W)}function j(M,k,x,W){return k===null||k.tag!==4||k.stateNode.containerInfo!==x.containerInfo||k.stateNode.implementation!==x.implementation?(k=up(x,M.mode,W),k.return=M,k):(k=y(k,x.children||[]),k.return=M,k)}function B(M,k,x,W,oe){return k===null||k.tag!==7?(k=Jn(x,M.mode,W,oe),k.return=M,k):(k=y(k,x),k.return=M,k)}function F(M,k,x){if(typeof k=="string"&&k!==""||typeof k=="number")return k=cp(""+k,M.mode,x),k.return=M,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case N:return x=hl(k.type,k.key,k.props,null,M.mode,x),x.ref=zs(M,null,k),x.return=M,x;case H:return k=up(k,M.mode,x),k.return=M,k;case ae:var W=k._init;return F(M,W(k._payload),x)}if(br(k)||ee(k))return k=Jn(k,M.mode,x,null),k.return=M,k;$u(M,k)}return null}function q(M,k,x,W){var oe=k!==null?k.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return oe!==null?null:I(M,k,""+x,W);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case N:return x.key===oe?b(M,k,x,W):null;case H:return x.key===oe?j(M,k,x,W):null;case ae:return oe=x._init,q(M,k,oe(x._payload),W)}if(br(x)||ee(x))return oe!==null?null:B(M,k,x,W,null);$u(M,x)}return null}function X(M,k,x,W,oe){if(typeof W=="string"&&W!==""||typeof W=="number")return M=M.get(x)||null,I(k,M,""+W,oe);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case N:return M=M.get(W.key===null?x:W.key)||null,b(k,M,W,oe);case H:return M=M.get(W.key===null?x:W.key)||null,j(k,M,W,oe);case ae:var ue=W._init;return X(M,k,x,ue(W._payload),oe)}if(br(W)||ee(W))return M=M.get(x)||null,B(k,M,W,oe,null);$u(k,W)}return null}function re(M,k,x,W){for(var oe=null,ue=null,le=k,he=k=0,at=null;le!==null&&he<x.length;he++){le.index>he?(at=le,le=null):at=le.sibling;var Ae=q(M,le,x[he],W);if(Ae===null){le===null&&(le=at);break}e&&le&&Ae.alternate===null&&n(M,le),k=S(Ae,k,he),ue===null?oe=Ae:ue.sibling=Ae,ue=Ae,le=at}if(he===x.length)return d(M,le),Fe&&Bn(M,he),oe;if(le===null){for(;he<x.length;he++)le=F(M,x[he],W),le!==null&&(k=S(le,k,he),ue===null?oe=le:ue.sibling=le,ue=le);return Fe&&Bn(M,he),oe}for(le=f(M,le);he<x.length;he++)at=X(le,M,he,x[he],W),at!==null&&(e&&at.alternate!==null&&le.delete(at.key===null?he:at.key),k=S(at,k,he),ue===null?oe=at:ue.sibling=at,ue=at);return e&&le.forEach(function(wn){return n(M,wn)}),Fe&&Bn(M,he),oe}function ne(M,k,x,W){var oe=ee(x);if(typeof oe!="function")throw Error(r(150));if(x=oe.call(x),x==null)throw Error(r(151));for(var ue=oe=null,le=k,he=k=0,at=null,Ae=x.next();le!==null&&!Ae.done;he++,Ae=x.next()){le.index>he?(at=le,le=null):at=le.sibling;var wn=q(M,le,Ae.value,W);if(wn===null){le===null&&(le=at);break}e&&le&&wn.alternate===null&&n(M,le),k=S(wn,k,he),ue===null?oe=wn:ue.sibling=wn,ue=wn,le=at}if(Ae.done)return d(M,le),Fe&&Bn(M,he),oe;if(le===null){for(;!Ae.done;he++,Ae=x.next())Ae=F(M,Ae.value,W),Ae!==null&&(k=S(Ae,k,he),ue===null?oe=Ae:ue.sibling=Ae,ue=Ae);return Fe&&Bn(M,he),oe}for(le=f(M,le);!Ae.done;he++,Ae=x.next())Ae=X(le,M,he,Ae.value,W),Ae!==null&&(e&&Ae.alternate!==null&&le.delete(Ae.key===null?he:Ae.key),k=S(Ae,k,he),ue===null?oe=Ae:ue.sibling=Ae,ue=Ae);return e&&le.forEach(function(R_){return n(M,R_)}),Fe&&Bn(M,he),oe}function Qe(M,k,x,W){if(typeof x=="object"&&x!==null&&x.type===ie&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case N:e:{for(var oe=x.key,ue=k;ue!==null;){if(ue.key===oe){if(oe=x.type,oe===ie){if(ue.tag===7){d(M,ue.sibling),k=y(ue,x.props.children),k.return=M,M=k;break e}}else if(ue.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===ae&&pv(oe)===ue.type){d(M,ue.sibling),k=y(ue,x.props),k.ref=zs(M,ue,x),k.return=M,M=k;break e}d(M,ue);break}else n(M,ue);ue=ue.sibling}x.type===ie?(k=Jn(x.props.children,M.mode,W,x.key),k.return=M,M=k):(W=hl(x.type,x.key,x.props,null,M.mode,W),W.ref=zs(M,k,x),W.return=M,M=W)}return P(M);case H:e:{for(ue=x.key;k!==null;){if(k.key===ue)if(k.tag===4&&k.stateNode.containerInfo===x.containerInfo&&k.stateNode.implementation===x.implementation){d(M,k.sibling),k=y(k,x.children||[]),k.return=M,M=k;break e}else{d(M,k);break}else n(M,k);k=k.sibling}k=up(x,M.mode,W),k.return=M,M=k}return P(M);case ae:return ue=x._init,Qe(M,k,ue(x._payload),W)}if(br(x))return re(M,k,x,W);if(ee(x))return ne(M,k,x,W);$u(M,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,k!==null&&k.tag===6?(d(M,k.sibling),k=y(k,x),k.return=M,M=k):(d(M,k),k=cp(x,M.mode,W),k.return=M,M=k),P(M)):d(M,k)}return Qe}var Vi=hv(!0),fv=hv(!1),Wu=ln(null),Hu=null,Ki=null,yd=null;function Sd(){yd=Ki=Hu=null}function Cd(e){var n=Wu.current;Le(Wu),e._currentValue=n}function wd(e,n,d){for(;e!==null;){var f=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,f!==null&&(f.childLanes|=n)):f!==null&&(f.childLanes&n)!==n&&(f.childLanes|=n),e===d)break;e=e.return}}function Ji(e,n){Hu=e,yd=Ki=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&n)!==0&&(bt=!0),e.firstContext=null)}function Gt(e){var n=e._currentValue;if(yd!==e)if(e={context:e,memoizedValue:n,next:null},Ki===null){if(Hu===null)throw Error(r(308));Ki=e,Hu.dependencies={lanes:0,firstContext:e}}else Ki=Ki.next=e;return n}var Fn=null;function Rd(e){Fn===null?Fn=[e]:Fn.push(e)}function vv(e,n,d,f){var y=n.interleaved;return y===null?(d.next=d,Rd(n)):(d.next=y.next,y.next=d),n.interleaved=d,Br(e,f)}function Br(e,n){e.lanes|=n;var d=e.alternate;for(d!==null&&(d.lanes|=n),d=e,e=e.return;e!==null;)e.childLanes|=n,d=e.alternate,d!==null&&(d.childLanes|=n),d=e,e=e.return;return d.tag===3?d.stateNode:null}var hn=!1;function Pd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gv(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fr(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function fn(e,n,d){var f=e.updateQueue;if(f===null)return null;if(f=f.shared,(Te&2)!==0){var y=f.pending;return y===null?n.next=n:(n.next=y.next,y.next=n),f.pending=n,Br(e,d)}return y=f.interleaved,y===null?(n.next=n,Rd(f)):(n.next=y.next,y.next=n),f.interleaved=n,Br(e,d)}function Vu(e,n,d){if(n=n.updateQueue,n!==null&&(n=n.shared,(d&4194240)!==0)){var f=n.lanes;f&=e.pendingLanes,d|=f,n.lanes=d,zl(e,d)}}function mv(e,n){var d=e.updateQueue,f=e.alternate;if(f!==null&&(f=f.updateQueue,d===f)){var y=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var P={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};S===null?y=S=P:S=S.next=P,d=d.next}while(d!==null);S===null?y=S=n:S=S.next=n}else y=S=n;d={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:S,shared:f.shared,effects:f.effects},e.updateQueue=d;return}e=d.lastBaseUpdate,e===null?d.firstBaseUpdate=n:e.next=n,d.lastBaseUpdate=n}function Ku(e,n,d,f){var y=e.updateQueue;hn=!1;var S=y.firstBaseUpdate,P=y.lastBaseUpdate,I=y.shared.pending;if(I!==null){y.shared.pending=null;var b=I,j=b.next;b.next=null,P===null?S=j:P.next=j,P=b;var B=e.alternate;B!==null&&(B=B.updateQueue,I=B.lastBaseUpdate,I!==P&&(I===null?B.firstBaseUpdate=j:I.next=j,B.lastBaseUpdate=b))}if(S!==null){var F=y.baseState;P=0,B=j=b=null,I=S;do{var q=I.lane,X=I.eventTime;if((f&q)===q){B!==null&&(B=B.next={eventTime:X,lane:0,tag:I.tag,payload:I.payload,callback:I.callback,next:null});e:{var re=e,ne=I;switch(q=n,X=d,ne.tag){case 1:if(re=ne.payload,typeof re=="function"){F=re.call(X,F,q);break e}F=re;break e;case 3:re.flags=re.flags&-65537|128;case 0:if(re=ne.payload,q=typeof re=="function"?re.call(X,F,q):re,q==null)break e;F=V({},F,q);break e;case 2:hn=!0}}I.callback!==null&&I.lane!==0&&(e.flags|=64,q=y.effects,q===null?y.effects=[I]:q.push(I))}else X={eventTime:X,lane:q,tag:I.tag,payload:I.payload,callback:I.callback,next:null},B===null?(j=B=X,b=F):B=B.next=X,P|=q;if(I=I.next,I===null){if(I=y.shared.pending,I===null)break;q=I,I=q.next,q.next=null,y.lastBaseUpdate=q,y.shared.pending=null}}while(!0);if(B===null&&(b=F),y.baseState=b,y.firstBaseUpdate=j,y.lastBaseUpdate=B,n=y.shared.interleaved,n!==null){y=n;do P|=y.lane,y=y.next;while(y!==n)}else S===null&&(y.shared.lanes=0);Wn|=P,e.lanes=P,e.memoizedState=F}}function yv(e,n,d){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var f=e[n],y=f.callback;if(y!==null){if(f.callback=null,f=d,typeof y!="function")throw Error(r(191,y));y.call(f)}}}var Ls={},wr=ln(Ls),qs=ln(Ls),Bs=ln(Ls);function Un(e){if(e===Ls)throw Error(r(174));return e}function _d(e,n){switch(je(Bs,n),je(qs,e),je(wr,Ls),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:kr(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=kr(n,e)}Le(wr),je(wr,n)}function Gi(){Le(wr),Le(qs),Le(Bs)}function Sv(e){Un(Bs.current);var n=Un(wr.current),d=kr(n,e.type);n!==d&&(je(qs,e),je(wr,d))}function Ed(e){qs.current===e&&(Le(wr),Le(qs))}var We=ln(0);function Ju(e){for(var n=e;n!==null;){if(n.tag===13){var d=n.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Td=[];function Id(){for(var e=0;e<Td.length;e++)Td[e]._workInProgressVersionPrimary=null;Td.length=0}var Gu=D.ReactCurrentDispatcher,Ad=D.ReactCurrentBatchConfig,$n=0,He=null,tt=null,st=null,Qu=!1,Fs=!1,Us=0,W0=0;function mt(){throw Error(r(321))}function bd(e,n){if(n===null)return!1;for(var d=0;d<n.length&&d<e.length;d++)if(!sr(e[d],n[d]))return!1;return!0}function kd(e,n,d,f,y,S){if($n=S,He=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Gu.current=e===null||e.memoizedState===null?J0:G0,e=d(f,y),Fs){S=0;do{if(Fs=!1,Us=0,25<=S)throw Error(r(301));S+=1,st=tt=null,n.updateQueue=null,Gu.current=Q0,e=d(f,y)}while(Fs)}if(Gu.current=Zu,n=tt!==null&&tt.next!==null,$n=0,st=tt=He=null,Qu=!1,n)throw Error(r(300));return e}function Od(){var e=Us!==0;return Us=0,e}function Rr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?He.memoizedState=st=e:st=st.next=e,st}function Qt(){if(tt===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=tt.next;var n=st===null?He.memoizedState:st.next;if(n!==null)st=n,tt=e;else{if(e===null)throw Error(r(310));tt=e,e={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},st===null?He.memoizedState=st=e:st=st.next=e}return st}function $s(e,n){return typeof n=="function"?n(e):n}function Md(e){var n=Qt(),d=n.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=e;var f=tt,y=f.baseQueue,S=d.pending;if(S!==null){if(y!==null){var P=y.next;y.next=S.next,S.next=P}f.baseQueue=y=S,d.pending=null}if(y!==null){S=y.next,f=f.baseState;var I=P=null,b=null,j=S;do{var B=j.lane;if(($n&B)===B)b!==null&&(b=b.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),f=j.hasEagerState?j.eagerState:e(f,j.action);else{var F={lane:B,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};b===null?(I=b=F,P=f):b=b.next=F,He.lanes|=B,Wn|=B}j=j.next}while(j!==null&&j!==S);b===null?P=f:b.next=I,sr(f,n.memoizedState)||(bt=!0),n.memoizedState=f,n.baseState=P,n.baseQueue=b,d.lastRenderedState=f}if(e=d.interleaved,e!==null){y=e;do S=y.lane,He.lanes|=S,Wn|=S,y=y.next;while(y!==e)}else y===null&&(d.lanes=0);return[n.memoizedState,d.dispatch]}function xd(e){var n=Qt(),d=n.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=e;var f=d.dispatch,y=d.pending,S=n.memoizedState;if(y!==null){d.pending=null;var P=y=y.next;do S=e(S,P.action),P=P.next;while(P!==y);sr(S,n.memoizedState)||(bt=!0),n.memoizedState=S,n.baseQueue===null&&(n.baseState=S),d.lastRenderedState=S}return[S,f]}function Cv(){}function wv(e,n){var d=He,f=Qt(),y=n(),S=!sr(f.memoizedState,y);if(S&&(f.memoizedState=y,bt=!0),f=f.queue,Dd(_v.bind(null,d,f,e),[e]),f.getSnapshot!==n||S||st!==null&&st.memoizedState.tag&1){if(d.flags|=2048,Ws(9,Pv.bind(null,d,f,y,n),void 0,null),ot===null)throw Error(r(349));($n&30)!==0||Rv(d,n,y)}return y}function Rv(e,n,d){e.flags|=16384,e={getSnapshot:n,value:d},n=He.updateQueue,n===null?(n={lastEffect:null,stores:null},He.updateQueue=n,n.stores=[e]):(d=n.stores,d===null?n.stores=[e]:d.push(e))}function Pv(e,n,d,f){n.value=d,n.getSnapshot=f,Ev(n)&&Tv(e)}function _v(e,n,d){return d(function(){Ev(n)&&Tv(e)})}function Ev(e){var n=e.getSnapshot;e=e.value;try{var d=n();return!sr(e,d)}catch{return!0}}function Tv(e){var n=Br(e,1);n!==null&&lr(n,e,1,-1)}function Iv(e){var n=Rr();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:e},n.queue=e,e=e.dispatch=K0.bind(null,He,e),[n.memoizedState,e]}function Ws(e,n,d,f){return e={tag:e,create:n,destroy:d,deps:f,next:null},n=He.updateQueue,n===null?(n={lastEffect:null,stores:null},He.updateQueue=n,n.lastEffect=e.next=e):(d=n.lastEffect,d===null?n.lastEffect=e.next=e:(f=d.next,d.next=e,e.next=f,n.lastEffect=e)),e}function Av(){return Qt().memoizedState}function Yu(e,n,d,f){var y=Rr();He.flags|=e,y.memoizedState=Ws(1|n,d,void 0,f===void 0?null:f)}function Xu(e,n,d,f){var y=Qt();f=f===void 0?null:f;var S=void 0;if(tt!==null){var P=tt.memoizedState;if(S=P.destroy,f!==null&&bd(f,P.deps)){y.memoizedState=Ws(n,d,S,f);return}}He.flags|=e,y.memoizedState=Ws(1|n,d,S,f)}function bv(e,n){return Yu(8390656,8,e,n)}function Dd(e,n){return Xu(2048,8,e,n)}function kv(e,n){return Xu(4,2,e,n)}function Ov(e,n){return Xu(4,4,e,n)}function Mv(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function xv(e,n,d){return d=d!=null?d.concat([e]):null,Xu(4,4,Mv.bind(null,n,e),d)}function jd(){}function Dv(e,n){var d=Qt();n=n===void 0?null:n;var f=d.memoizedState;return f!==null&&n!==null&&bd(n,f[1])?f[0]:(d.memoizedState=[e,n],e)}function jv(e,n){var d=Qt();n=n===void 0?null:n;var f=d.memoizedState;return f!==null&&n!==null&&bd(n,f[1])?f[0]:(e=e(),d.memoizedState=[e,n],e)}function Nv(e,n,d){return($n&21)===0?(e.baseState&&(e.baseState=!1,bt=!0),e.memoizedState=d):(sr(d,n)||(d=pf(),He.lanes|=d,Wn|=d,e.baseState=!0),n)}function H0(e,n){var d=Me;Me=d!==0&&4>d?d:4,e(!0);var f=Ad.transition;Ad.transition={};try{e(!1),n()}finally{Me=d,Ad.transition=f}}function zv(){return Qt().memoizedState}function V0(e,n,d){var f=yn(e);if(d={lane:f,action:d,hasEagerState:!1,eagerState:null,next:null},Lv(e))qv(n,d);else if(d=vv(e,n,d,f),d!==null){var y=wt();lr(d,e,f,y),Bv(d,n,f)}}function K0(e,n,d){var f=yn(e),y={lane:f,action:d,hasEagerState:!1,eagerState:null,next:null};if(Lv(e))qv(n,y);else{var S=e.alternate;if(e.lanes===0&&(S===null||S.lanes===0)&&(S=n.lastRenderedReducer,S!==null))try{var P=n.lastRenderedState,I=S(P,d);if(y.hasEagerState=!0,y.eagerState=I,sr(I,P)){var b=n.interleaved;b===null?(y.next=y,Rd(n)):(y.next=b.next,b.next=y),n.interleaved=y;return}}catch{}finally{}d=vv(e,n,y,f),d!==null&&(y=wt(),lr(d,e,f,y),Bv(d,n,f))}}function Lv(e){var n=e.alternate;return e===He||n!==null&&n===He}function qv(e,n){Fs=Qu=!0;var d=e.pending;d===null?n.next=n:(n.next=d.next,d.next=n),e.pending=n}function Bv(e,n,d){if((d&4194240)!==0){var f=n.lanes;f&=e.pendingLanes,d|=f,n.lanes=d,zl(e,d)}}var Zu={readContext:Gt,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},J0={readContext:Gt,useCallback:function(e,n){return Rr().memoizedState=[e,n===void 0?null:n],e},useContext:Gt,useEffect:bv,useImperativeHandle:function(e,n,d){return d=d!=null?d.concat([e]):null,Yu(4194308,4,Mv.bind(null,n,e),d)},useLayoutEffect:function(e,n){return Yu(4194308,4,e,n)},useInsertionEffect:function(e,n){return Yu(4,2,e,n)},useMemo:function(e,n){var d=Rr();return n=n===void 0?null:n,e=e(),d.memoizedState=[e,n],e},useReducer:function(e,n,d){var f=Rr();return n=d!==void 0?d(n):n,f.memoizedState=f.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},f.queue=e,e=e.dispatch=V0.bind(null,He,e),[f.memoizedState,e]},useRef:function(e){var n=Rr();return e={current:e},n.memoizedState=e},useState:Iv,useDebugValue:jd,useDeferredValue:function(e){return Rr().memoizedState=e},useTransition:function(){var e=Iv(!1),n=e[0];return e=H0.bind(null,e[1]),Rr().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,d){var f=He,y=Rr();if(Fe){if(d===void 0)throw Error(r(407));d=d()}else{if(d=n(),ot===null)throw Error(r(349));($n&30)!==0||Rv(f,n,d)}y.memoizedState=d;var S={value:d,getSnapshot:n};return y.queue=S,bv(_v.bind(null,f,S,e),[e]),f.flags|=2048,Ws(9,Pv.bind(null,f,S,d,n),void 0,null),d},useId:function(){var e=Rr(),n=ot.identifierPrefix;if(Fe){var d=qr,f=Lr;d=(f&~(1<<32-ir(f)-1)).toString(32)+d,n=":"+n+"R"+d,d=Us++,0<d&&(n+="H"+d.toString(32)),n+=":"}else d=W0++,n=":"+n+"r"+d.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},G0={readContext:Gt,useCallback:Dv,useContext:Gt,useEffect:Dd,useImperativeHandle:xv,useInsertionEffect:kv,useLayoutEffect:Ov,useMemo:jv,useReducer:Md,useRef:Av,useState:function(){return Md($s)},useDebugValue:jd,useDeferredValue:function(e){var n=Qt();return Nv(n,tt.memoizedState,e)},useTransition:function(){var e=Md($s)[0],n=Qt().memoizedState;return[e,n]},useMutableSource:Cv,useSyncExternalStore:wv,useId:zv,unstable_isNewReconciler:!1},Q0={readContext:Gt,useCallback:Dv,useContext:Gt,useEffect:Dd,useImperativeHandle:xv,useInsertionEffect:kv,useLayoutEffect:Ov,useMemo:jv,useReducer:xd,useRef:Av,useState:function(){return xd($s)},useDebugValue:jd,useDeferredValue:function(e){var n=Qt();return tt===null?n.memoizedState=e:Nv(n,tt.memoizedState,e)},useTransition:function(){var e=xd($s)[0],n=Qt().memoizedState;return[e,n]},useMutableSource:Cv,useSyncExternalStore:wv,useId:zv,unstable_isNewReconciler:!1};function ar(e,n){if(e&&e.defaultProps){n=V({},n),e=e.defaultProps;for(var d in e)n[d]===void 0&&(n[d]=e[d]);return n}return n}function Nd(e,n,d,f){n=e.memoizedState,d=d(f,n),d=d==null?n:V({},n,d),e.memoizedState=d,e.lanes===0&&(e.updateQueue.baseState=d)}var el={isMounted:function(e){return(e=e._reactInternals)?pt(e)===e:!1},enqueueSetState:function(e,n,d){e=e._reactInternals;var f=wt(),y=yn(e),S=Fr(f,y);S.payload=n,d!=null&&(S.callback=d),n=fn(e,S,y),n!==null&&(lr(n,e,y,f),Vu(n,e,y))},enqueueReplaceState:function(e,n,d){e=e._reactInternals;var f=wt(),y=yn(e),S=Fr(f,y);S.tag=1,S.payload=n,d!=null&&(S.callback=d),n=fn(e,S,y),n!==null&&(lr(n,e,y,f),Vu(n,e,y))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var d=wt(),f=yn(e),y=Fr(d,f);y.tag=2,n!=null&&(y.callback=n),n=fn(e,y,f),n!==null&&(lr(n,e,f,d),Vu(n,e,f))}};function Fv(e,n,d,f,y,S,P){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(f,S,P):n.prototype&&n.prototype.isPureReactComponent?!ks(d,f)||!ks(y,S):!0}function Uv(e,n,d){var f=!1,y=dn,S=n.contextType;return typeof S=="object"&&S!==null?S=Gt(S):(y=At(n)?Ln:gt.current,f=n.contextTypes,S=(f=f!=null)?Ui(e,y):dn),n=new n(d,S),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=el,e.stateNode=n,n._reactInternals=e,f&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=y,e.__reactInternalMemoizedMaskedChildContext=S),n}function $v(e,n,d,f){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(d,f),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(d,f),n.state!==e&&el.enqueueReplaceState(n,n.state,null)}function zd(e,n,d,f){var y=e.stateNode;y.props=d,y.state=e.memoizedState,y.refs={},Pd(e);var S=n.contextType;typeof S=="object"&&S!==null?y.context=Gt(S):(S=At(n)?Ln:gt.current,y.context=Ui(e,S)),y.state=e.memoizedState,S=n.getDerivedStateFromProps,typeof S=="function"&&(Nd(e,n,S,d),y.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(n=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),n!==y.state&&el.enqueueReplaceState(y,y.state,null),Ku(e,d,y,f),y.state=e.memoizedState),typeof y.componentDidMount=="function"&&(e.flags|=4194308)}function Qi(e,n){try{var d="",f=n;do d+=Se(f),f=f.return;while(f);var y=d}catch(S){y=`
Error generating stack: `+S.message+`
`+S.stack}return{value:e,source:n,stack:y,digest:null}}function Ld(e,n,d){return{value:e,source:null,stack:d??null,digest:n??null}}function qd(e,n){try{console.error(n.value)}catch(d){setTimeout(function(){throw d})}}var Y0=typeof WeakMap=="function"?WeakMap:Map;function Wv(e,n,d){d=Fr(-1,d),d.tag=3,d.payload={element:null};var f=n.value;return d.callback=function(){al||(al=!0,ep=f),qd(e,n)},d}function Hv(e,n,d){d=Fr(-1,d),d.tag=3;var f=e.type.getDerivedStateFromError;if(typeof f=="function"){var y=n.value;d.payload=function(){return f(y)},d.callback=function(){qd(e,n)}}var S=e.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(d.callback=function(){qd(e,n),typeof f!="function"&&(gn===null?gn=new Set([this]):gn.add(this));var P=n.stack;this.componentDidCatch(n.value,{componentStack:P!==null?P:""})}),d}function Vv(e,n,d){var f=e.pingCache;if(f===null){f=e.pingCache=new Y0;var y=new Set;f.set(n,y)}else y=f.get(n),y===void 0&&(y=new Set,f.set(n,y));y.has(d)||(y.add(d),e=d_.bind(null,e,n,d),n.then(e,e))}function Kv(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Jv(e,n,d,f,y){return(e.mode&1)===0?(e===n?e.flags|=65536:(e.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(n=Fr(-1,1),n.tag=2,fn(d,n,1))),d.lanes|=1),e):(e.flags|=65536,e.lanes=y,e)}var X0=D.ReactCurrentOwner,bt=!1;function Ct(e,n,d,f){n.child=e===null?fv(n,null,d,f):Vi(n,e.child,d,f)}function Gv(e,n,d,f,y){d=d.render;var S=n.ref;return Ji(n,y),f=kd(e,n,d,f,S,y),d=Od(),e!==null&&!bt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~y,Ur(e,n,y)):(Fe&&d&&hd(n),n.flags|=1,Ct(e,n,f,y),n.child)}function Qv(e,n,d,f,y){if(e===null){var S=d.type;return typeof S=="function"&&!ap(S)&&S.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(n.tag=15,n.type=S,Yv(e,n,S,f,y)):(e=hl(d.type,null,f,n,n.mode,y),e.ref=n.ref,e.return=n,n.child=e)}if(S=e.child,(e.lanes&y)===0){var P=S.memoizedProps;if(d=d.compare,d=d!==null?d:ks,d(P,f)&&e.ref===n.ref)return Ur(e,n,y)}return n.flags|=1,e=Cn(S,f),e.ref=n.ref,e.return=n,n.child=e}function Yv(e,n,d,f,y){if(e!==null){var S=e.memoizedProps;if(ks(S,f)&&e.ref===n.ref)if(bt=!1,n.pendingProps=f=S,(e.lanes&y)!==0)(e.flags&131072)!==0&&(bt=!0);else return n.lanes=e.lanes,Ur(e,n,y)}return Bd(e,n,d,f,y)}function Xv(e,n,d){var f=n.pendingProps,y=f.children,S=e!==null?e.memoizedState:null;if(f.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(Xi,Ft),Ft|=d;else{if((d&1073741824)===0)return e=S!==null?S.baseLanes|d:d,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,je(Xi,Ft),Ft|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=S!==null?S.baseLanes:d,je(Xi,Ft),Ft|=f}else S!==null?(f=S.baseLanes|d,n.memoizedState=null):f=d,je(Xi,Ft),Ft|=f;return Ct(e,n,y,d),n.child}function Zv(e,n){var d=n.ref;(e===null&&d!==null||e!==null&&e.ref!==d)&&(n.flags|=512,n.flags|=2097152)}function Bd(e,n,d,f,y){var S=At(d)?Ln:gt.current;return S=Ui(n,S),Ji(n,y),d=kd(e,n,d,f,S,y),f=Od(),e!==null&&!bt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~y,Ur(e,n,y)):(Fe&&f&&hd(n),n.flags|=1,Ct(e,n,d,y),n.child)}function eg(e,n,d,f,y){if(At(d)){var S=!0;Lu(n)}else S=!1;if(Ji(n,y),n.stateNode===null)rl(e,n),Uv(n,d,f),zd(n,d,f,y),f=!0;else if(e===null){var P=n.stateNode,I=n.memoizedProps;P.props=I;var b=P.context,j=d.contextType;typeof j=="object"&&j!==null?j=Gt(j):(j=At(d)?Ln:gt.current,j=Ui(n,j));var B=d.getDerivedStateFromProps,F=typeof B=="function"||typeof P.getSnapshotBeforeUpdate=="function";F||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(I!==f||b!==j)&&$v(n,P,f,j),hn=!1;var q=n.memoizedState;P.state=q,Ku(n,f,P,y),b=n.memoizedState,I!==f||q!==b||It.current||hn?(typeof B=="function"&&(Nd(n,d,B,f),b=n.memoizedState),(I=hn||Fv(n,d,I,f,q,b,j))?(F||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(n.flags|=4194308)):(typeof P.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=f,n.memoizedState=b),P.props=f,P.state=b,P.context=j,f=I):(typeof P.componentDidMount=="function"&&(n.flags|=4194308),f=!1)}else{P=n.stateNode,gv(e,n),I=n.memoizedProps,j=n.type===n.elementType?I:ar(n.type,I),P.props=j,F=n.pendingProps,q=P.context,b=d.contextType,typeof b=="object"&&b!==null?b=Gt(b):(b=At(d)?Ln:gt.current,b=Ui(n,b));var X=d.getDerivedStateFromProps;(B=typeof X=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(I!==F||q!==b)&&$v(n,P,f,b),hn=!1,q=n.memoizedState,P.state=q,Ku(n,f,P,y);var re=n.memoizedState;I!==F||q!==re||It.current||hn?(typeof X=="function"&&(Nd(n,d,X,f),re=n.memoizedState),(j=hn||Fv(n,d,j,f,q,re,b)||!1)?(B||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(f,re,b),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(f,re,b)),typeof P.componentDidUpdate=="function"&&(n.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof P.componentDidUpdate!="function"||I===e.memoizedProps&&q===e.memoizedState||(n.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||I===e.memoizedProps&&q===e.memoizedState||(n.flags|=1024),n.memoizedProps=f,n.memoizedState=re),P.props=f,P.state=re,P.context=b,f=j):(typeof P.componentDidUpdate!="function"||I===e.memoizedProps&&q===e.memoizedState||(n.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||I===e.memoizedProps&&q===e.memoizedState||(n.flags|=1024),f=!1)}return Fd(e,n,d,f,S,y)}function Fd(e,n,d,f,y,S){Zv(e,n);var P=(n.flags&128)!==0;if(!f&&!P)return y&&sv(n,d,!1),Ur(e,n,S);f=n.stateNode,X0.current=n;var I=P&&typeof d.getDerivedStateFromError!="function"?null:f.render();return n.flags|=1,e!==null&&P?(n.child=Vi(n,e.child,null,S),n.child=Vi(n,null,I,S)):Ct(e,n,I,S),n.memoizedState=f.state,y&&sv(n,d,!0),n.child}function tg(e){var n=e.stateNode;n.pendingContext?nv(e,n.pendingContext,n.pendingContext!==n.context):n.context&&nv(e,n.context,!1),_d(e,n.containerInfo)}function rg(e,n,d,f,y){return Hi(),md(y),n.flags|=256,Ct(e,n,d,f),n.child}var Ud={dehydrated:null,treeContext:null,retryLane:0};function $d(e){return{baseLanes:e,cachePool:null,transitions:null}}function ng(e,n,d){var f=n.pendingProps,y=We.current,S=!1,P=(n.flags&128)!==0,I;if((I=P)||(I=e!==null&&e.memoizedState===null?!1:(y&2)!==0),I?(S=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(y|=1),je(We,y&1),e===null)return gd(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((n.mode&1)===0?n.lanes=1:e.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(P=f.children,e=f.fallback,S?(f=n.mode,S=n.child,P={mode:"hidden",children:P},(f&1)===0&&S!==null?(S.childLanes=0,S.pendingProps=P):S=fl(P,f,0,null),e=Jn(e,f,d,null),S.return=n,e.return=n,S.sibling=e,n.child=S,n.child.memoizedState=$d(d),n.memoizedState=Ud,e):Wd(n,P));if(y=e.memoizedState,y!==null&&(I=y.dehydrated,I!==null))return Z0(e,n,P,f,I,y,d);if(S){S=f.fallback,P=n.mode,y=e.child,I=y.sibling;var b={mode:"hidden",children:f.children};return(P&1)===0&&n.child!==y?(f=n.child,f.childLanes=0,f.pendingProps=b,n.deletions=null):(f=Cn(y,b),f.subtreeFlags=y.subtreeFlags&14680064),I!==null?S=Cn(I,S):(S=Jn(S,P,d,null),S.flags|=2),S.return=n,f.return=n,f.sibling=S,n.child=f,f=S,S=n.child,P=e.child.memoizedState,P=P===null?$d(d):{baseLanes:P.baseLanes|d,cachePool:null,transitions:P.transitions},S.memoizedState=P,S.childLanes=e.childLanes&~d,n.memoizedState=Ud,f}return S=e.child,e=S.sibling,f=Cn(S,{mode:"visible",children:f.children}),(n.mode&1)===0&&(f.lanes=d),f.return=n,f.sibling=null,e!==null&&(d=n.deletions,d===null?(n.deletions=[e],n.flags|=16):d.push(e)),n.child=f,n.memoizedState=null,f}function Wd(e,n){return n=fl({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function tl(e,n,d,f){return f!==null&&md(f),Vi(n,e.child,null,d),e=Wd(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Z0(e,n,d,f,y,S,P){if(d)return n.flags&256?(n.flags&=-257,f=Ld(Error(r(422))),tl(e,n,P,f)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(S=f.fallback,y=n.mode,f=fl({mode:"visible",children:f.children},y,0,null),S=Jn(S,y,P,null),S.flags|=2,f.return=n,S.return=n,f.sibling=S,n.child=f,(n.mode&1)!==0&&Vi(n,e.child,null,P),n.child.memoizedState=$d(P),n.memoizedState=Ud,S);if((n.mode&1)===0)return tl(e,n,P,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var I=f.dgst;return f=I,S=Error(r(419)),f=Ld(S,f,void 0),tl(e,n,P,f)}if(I=(P&e.childLanes)!==0,bt||I){if(f=ot,f!==null){switch(P&-P){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|P))!==0?0:y,y!==0&&y!==S.retryLane&&(S.retryLane=y,Br(e,y),lr(f,e,y,-1))}return op(),f=Ld(Error(r(421))),tl(e,n,P,f)}return y.data==="$?"?(n.flags|=128,n.child=e.child,n=p_.bind(null,e),y._reactRetry=n,null):(e=S.treeContext,Bt=un(y.nextSibling),qt=n,Fe=!0,or=null,e!==null&&(Kt[Jt++]=Lr,Kt[Jt++]=qr,Kt[Jt++]=qn,Lr=e.id,qr=e.overflow,qn=n),n=Wd(n,f.children),n.flags|=4096,n)}function ig(e,n,d){e.lanes|=n;var f=e.alternate;f!==null&&(f.lanes|=n),wd(e.return,n,d)}function Hd(e,n,d,f,y){var S=e.memoizedState;S===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:f,tail:d,tailMode:y}:(S.isBackwards=n,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=d,S.tailMode=y)}function sg(e,n,d){var f=n.pendingProps,y=f.revealOrder,S=f.tail;if(Ct(e,n,f.children,d),f=We.current,(f&2)!==0)f=f&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ig(e,d,n);else if(e.tag===19)ig(e,d,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}f&=1}if(je(We,f),(n.mode&1)===0)n.memoizedState=null;else switch(y){case"forwards":for(d=n.child,y=null;d!==null;)e=d.alternate,e!==null&&Ju(e)===null&&(y=d),d=d.sibling;d=y,d===null?(y=n.child,n.child=null):(y=d.sibling,d.sibling=null),Hd(n,!1,y,d,S);break;case"backwards":for(d=null,y=n.child,n.child=null;y!==null;){if(e=y.alternate,e!==null&&Ju(e)===null){n.child=y;break}e=y.sibling,y.sibling=d,d=y,y=e}Hd(n,!0,d,null,S);break;case"together":Hd(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function rl(e,n){(n.mode&1)===0&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Ur(e,n,d){if(e!==null&&(n.dependencies=e.dependencies),Wn|=n.lanes,(d&n.childLanes)===0)return null;if(e!==null&&n.child!==e.child)throw Error(r(153));if(n.child!==null){for(e=n.child,d=Cn(e,e.pendingProps),n.child=d,d.return=n;e.sibling!==null;)e=e.sibling,d=d.sibling=Cn(e,e.pendingProps),d.return=n;d.sibling=null}return n.child}function e_(e,n,d){switch(n.tag){case 3:tg(n),Hi();break;case 5:Sv(n);break;case 1:At(n.type)&&Lu(n);break;case 4:_d(n,n.stateNode.containerInfo);break;case 10:var f=n.type._context,y=n.memoizedProps.value;je(Wu,f._currentValue),f._currentValue=y;break;case 13:if(f=n.memoizedState,f!==null)return f.dehydrated!==null?(je(We,We.current&1),n.flags|=128,null):(d&n.child.childLanes)!==0?ng(e,n,d):(je(We,We.current&1),e=Ur(e,n,d),e!==null?e.sibling:null);je(We,We.current&1);break;case 19:if(f=(d&n.childLanes)!==0,(e.flags&128)!==0){if(f)return sg(e,n,d);n.flags|=128}if(y=n.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),je(We,We.current),f)break;return null;case 22:case 23:return n.lanes=0,Xv(e,n,d)}return Ur(e,n,d)}var og,Vd,ag,cg;og=function(e,n){for(var d=n.child;d!==null;){if(d.tag===5||d.tag===6)e.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break;for(;d.sibling===null;){if(d.return===null||d.return===n)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Vd=function(){},ag=function(e,n,d,f){var y=e.memoizedProps;if(y!==f){e=n.stateNode,Un(wr.current);var S=null;switch(d){case"input":y=Gr(e,y),f=Gr(e,f),S=[];break;case"select":y=V({},y,{value:void 0}),f=V({},f,{value:void 0}),S=[];break;case"textarea":y=Yr(e,y),f=Yr(e,f),S=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(e.onclick=ju)}Zr(d,f);var P;d=null;for(j in y)if(!f.hasOwnProperty(j)&&y.hasOwnProperty(j)&&y[j]!=null)if(j==="style"){var I=y[j];for(P in I)I.hasOwnProperty(P)&&(d||(d={}),d[P]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(o.hasOwnProperty(j)?S||(S=[]):(S=S||[]).push(j,null));for(j in f){var b=f[j];if(I=y!=null?y[j]:void 0,f.hasOwnProperty(j)&&b!==I&&(b!=null||I!=null))if(j==="style")if(I){for(P in I)!I.hasOwnProperty(P)||b&&b.hasOwnProperty(P)||(d||(d={}),d[P]="");for(P in b)b.hasOwnProperty(P)&&I[P]!==b[P]&&(d||(d={}),d[P]=b[P])}else d||(S||(S=[]),S.push(j,d)),d=b;else j==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,I=I?I.__html:void 0,b!=null&&I!==b&&(S=S||[]).push(j,b)):j==="children"?typeof b!="string"&&typeof b!="number"||(S=S||[]).push(j,""+b):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(o.hasOwnProperty(j)?(b!=null&&j==="onScroll"&&ze("scroll",e),S||I===b||(S=[])):(S=S||[]).push(j,b))}d&&(S=S||[]).push("style",d);var j=S;(n.updateQueue=j)&&(n.flags|=4)}},cg=function(e,n,d,f){d!==f&&(n.flags|=4)};function Hs(e,n){if(!Fe)switch(e.tailMode){case"hidden":n=e.tail;for(var d=null;n!==null;)n.alternate!==null&&(d=n),n=n.sibling;d===null?e.tail=null:d.sibling=null;break;case"collapsed":d=e.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:f.sibling=null}}function yt(e){var n=e.alternate!==null&&e.alternate.child===e.child,d=0,f=0;if(n)for(var y=e.child;y!==null;)d|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=e,y=y.sibling;else for(y=e.child;y!==null;)d|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=e,y=y.sibling;return e.subtreeFlags|=f,e.childLanes=d,n}function t_(e,n,d){var f=n.pendingProps;switch(fd(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(n),null;case 1:return At(n.type)&&zu(),yt(n),null;case 3:return f=n.stateNode,Gi(),Le(It),Le(gt),Id(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(e===null||e.child===null)&&(Uu(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,or!==null&&(np(or),or=null))),Vd(e,n),yt(n),null;case 5:Ed(n);var y=Un(Bs.current);if(d=n.type,e!==null&&n.stateNode!=null)ag(e,n,d,f,y),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!f){if(n.stateNode===null)throw Error(r(166));return yt(n),null}if(e=Un(wr.current),Uu(n)){f=n.stateNode,d=n.type;var S=n.memoizedProps;switch(f[Cr]=n,f[js]=S,e=(n.mode&1)!==0,d){case"dialog":ze("cancel",f),ze("close",f);break;case"iframe":case"object":case"embed":ze("load",f);break;case"video":case"audio":for(y=0;y<Ms.length;y++)ze(Ms[y],f);break;case"source":ze("error",f);break;case"img":case"image":case"link":ze("error",f),ze("load",f);break;case"details":ze("toggle",f);break;case"input":Ai(f,S),ze("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!S.multiple},ze("invalid",f);break;case"textarea":On(f,S),ze("invalid",f)}Zr(d,S),y=null;for(var P in S)if(S.hasOwnProperty(P)){var I=S[P];P==="children"?typeof I=="string"?f.textContent!==I&&(S.suppressHydrationWarning!==!0&&Du(f.textContent,I,e),y=["children",I]):typeof I=="number"&&f.textContent!==""+I&&(S.suppressHydrationWarning!==!0&&Du(f.textContent,I,e),y=["children",""+I]):o.hasOwnProperty(P)&&I!=null&&P==="onScroll"&&ze("scroll",f)}switch(d){case"input":Ar(f),bi(f,S,!0);break;case"textarea":Ar(f),Dt(f);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(f.onclick=ju)}f=y,n.updateQueue=f,f!==null&&(n.flags|=4)}else{P=y.nodeType===9?y:y.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Mn(d)),e==="http://www.w3.org/1999/xhtml"?d==="script"?(e=P.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof f.is=="string"?e=P.createElement(d,{is:f.is}):(e=P.createElement(d),d==="select"&&(P=e,f.multiple?P.multiple=!0:f.size&&(P.size=f.size))):e=P.createElementNS(e,d),e[Cr]=n,e[js]=f,og(e,n,!1,!1),n.stateNode=e;e:{switch(P=en(d,f),d){case"dialog":ze("cancel",e),ze("close",e),y=f;break;case"iframe":case"object":case"embed":ze("load",e),y=f;break;case"video":case"audio":for(y=0;y<Ms.length;y++)ze(Ms[y],e);y=f;break;case"source":ze("error",e),y=f;break;case"img":case"image":case"link":ze("error",e),ze("load",e),y=f;break;case"details":ze("toggle",e),y=f;break;case"input":Ai(e,f),y=Gr(e,f),ze("invalid",e);break;case"option":y=f;break;case"select":e._wrapperState={wasMultiple:!!f.multiple},y=V({},f,{value:void 0}),ze("invalid",e);break;case"textarea":On(e,f),y=Yr(e,f),ze("invalid",e);break;default:y=f}Zr(d,y),I=y;for(S in I)if(I.hasOwnProperty(S)){var b=I[S];S==="style"?Xr(e,b):S==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&Or(e,b)):S==="children"?typeof b=="string"?(d!=="textarea"||b!=="")&&Mr(e,b):typeof b=="number"&&Mr(e,""+b):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(o.hasOwnProperty(S)?b!=null&&S==="onScroll"&&ze("scroll",e):b!=null&&T(e,S,b,P))}switch(d){case"input":Ar(e),bi(e,f,!1);break;case"textarea":Ar(e),Dt(e);break;case"option":f.value!=null&&e.setAttribute("value",""+_e(f.value));break;case"select":e.multiple=!!f.multiple,S=f.value,S!=null?Vt(e,!!f.multiple,S,!1):f.defaultValue!=null&&Vt(e,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(e.onclick=ju)}switch(d){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return yt(n),null;case 6:if(e&&n.stateNode!=null)cg(e,n,e.memoizedProps,f);else{if(typeof f!="string"&&n.stateNode===null)throw Error(r(166));if(d=Un(Bs.current),Un(wr.current),Uu(n)){if(f=n.stateNode,d=n.memoizedProps,f[Cr]=n,(S=f.nodeValue!==d)&&(e=qt,e!==null))switch(e.tag){case 3:Du(f.nodeValue,d,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Du(f.nodeValue,d,(e.mode&1)!==0)}S&&(n.flags|=4)}else f=(d.nodeType===9?d:d.ownerDocument).createTextNode(f),f[Cr]=n,n.stateNode=f}return yt(n),null;case 13:if(Le(We),f=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fe&&Bt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)dv(),Hi(),n.flags|=98560,S=!1;else if(S=Uu(n),f!==null&&f.dehydrated!==null){if(e===null){if(!S)throw Error(r(318));if(S=n.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[Cr]=n}else Hi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;yt(n),S=!1}else or!==null&&(np(or),or=null),S=!0;if(!S)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=d,n):(f=f!==null,f!==(e!==null&&e.memoizedState!==null)&&f&&(n.child.flags|=8192,(n.mode&1)!==0&&(e===null||(We.current&1)!==0?rt===0&&(rt=3):op())),n.updateQueue!==null&&(n.flags|=4),yt(n),null);case 4:return Gi(),Vd(e,n),e===null&&xs(n.stateNode.containerInfo),yt(n),null;case 10:return Cd(n.type._context),yt(n),null;case 17:return At(n.type)&&zu(),yt(n),null;case 19:if(Le(We),S=n.memoizedState,S===null)return yt(n),null;if(f=(n.flags&128)!==0,P=S.rendering,P===null)if(f)Hs(S,!1);else{if(rt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(P=Ju(e),P!==null){for(n.flags|=128,Hs(S,!1),f=P.updateQueue,f!==null&&(n.updateQueue=f,n.flags|=4),n.subtreeFlags=0,f=d,d=n.child;d!==null;)S=d,e=f,S.flags&=14680066,P=S.alternate,P===null?(S.childLanes=0,S.lanes=e,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=P.childLanes,S.lanes=P.lanes,S.child=P.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=P.memoizedProps,S.memoizedState=P.memoizedState,S.updateQueue=P.updateQueue,S.type=P.type,e=P.dependencies,S.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),d=d.sibling;return je(We,We.current&1|2),n.child}e=e.sibling}S.tail!==null&&Ge()>Zi&&(n.flags|=128,f=!0,Hs(S,!1),n.lanes=4194304)}else{if(!f)if(e=Ju(P),e!==null){if(n.flags|=128,f=!0,d=e.updateQueue,d!==null&&(n.updateQueue=d,n.flags|=4),Hs(S,!0),S.tail===null&&S.tailMode==="hidden"&&!P.alternate&&!Fe)return yt(n),null}else 2*Ge()-S.renderingStartTime>Zi&&d!==1073741824&&(n.flags|=128,f=!0,Hs(S,!1),n.lanes=4194304);S.isBackwards?(P.sibling=n.child,n.child=P):(d=S.last,d!==null?d.sibling=P:n.child=P,S.last=P)}return S.tail!==null?(n=S.tail,S.rendering=n,S.tail=n.sibling,S.renderingStartTime=Ge(),n.sibling=null,d=We.current,je(We,f?d&1|2:d&1),n):(yt(n),null);case 22:case 23:return sp(),f=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==f&&(n.flags|=8192),f&&(n.mode&1)!==0?(Ft&1073741824)!==0&&(yt(n),n.subtreeFlags&6&&(n.flags|=8192)):yt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function r_(e,n){switch(fd(n),n.tag){case 1:return At(n.type)&&zu(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Gi(),Le(It),Le(gt),Id(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 5:return Ed(n),null;case 13:if(Le(We),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(r(340));Hi()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Le(We),null;case 4:return Gi(),null;case 10:return Cd(n.type._context),null;case 22:case 23:return sp(),null;case 24:return null;default:return null}}var nl=!1,St=!1,n_=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Yi(e,n){var d=e.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(f){Je(e,n,f)}else d.current=null}function Kd(e,n,d){try{d()}catch(f){Je(e,n,f)}}var ug=!1;function i_(e,n){if(sd=Pu,e=Ff(),Yl(e)){if("selectionStart"in e)var d={start:e.selectionStart,end:e.selectionEnd};else e:{d=(d=e.ownerDocument)&&d.defaultView||window;var f=d.getSelection&&d.getSelection();if(f&&f.rangeCount!==0){d=f.anchorNode;var y=f.anchorOffset,S=f.focusNode;f=f.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var P=0,I=-1,b=-1,j=0,B=0,F=e,q=null;t:for(;;){for(var X;F!==d||y!==0&&F.nodeType!==3||(I=P+y),F!==S||f!==0&&F.nodeType!==3||(b=P+f),F.nodeType===3&&(P+=F.nodeValue.length),(X=F.firstChild)!==null;)q=F,F=X;for(;;){if(F===e)break t;if(q===d&&++j===y&&(I=P),q===S&&++B===f&&(b=P),(X=F.nextSibling)!==null)break;F=q,q=F.parentNode}F=X}d=I===-1||b===-1?null:{start:I,end:b}}else d=null}d=d||{start:0,end:0}}else d=null;for(od={focusedElem:e,selectionRange:d},Pu=!1,Z=n;Z!==null;)if(n=Z,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Z=e;else for(;Z!==null;){n=Z;try{var re=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(re!==null){var ne=re.memoizedProps,Qe=re.memoizedState,M=n.stateNode,k=M.getSnapshotBeforeUpdate(n.elementType===n.type?ne:ar(n.type,ne),Qe);M.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var x=n.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(W){Je(n,n.return,W)}if(e=n.sibling,e!==null){e.return=n.return,Z=e;break}Z=n.return}return re=ug,ug=!1,re}function Vs(e,n,d){var f=n.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&e)===e){var S=y.destroy;y.destroy=void 0,S!==void 0&&Kd(n,d,S)}y=y.next}while(y!==f)}}function il(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var d=n=n.next;do{if((d.tag&e)===e){var f=d.create;d.destroy=f()}d=d.next}while(d!==n)}}function Jd(e){var n=e.ref;if(n!==null){var d=e.stateNode;switch(e.tag){case 5:e=d;break;default:e=d}typeof n=="function"?n(e):n.current=e}}function lg(e){var n=e.alternate;n!==null&&(e.alternate=null,lg(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[Cr],delete n[js],delete n[ld],delete n[B0],delete n[F0])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dg(e){return e.tag===5||e.tag===3||e.tag===4}function pg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gd(e,n,d){var f=e.tag;if(f===5||f===6)e=e.stateNode,n?d.nodeType===8?d.parentNode.insertBefore(e,n):d.insertBefore(e,n):(d.nodeType===8?(n=d.parentNode,n.insertBefore(e,d)):(n=d,n.appendChild(e)),d=d._reactRootContainer,d!=null||n.onclick!==null||(n.onclick=ju));else if(f!==4&&(e=e.child,e!==null))for(Gd(e,n,d),e=e.sibling;e!==null;)Gd(e,n,d),e=e.sibling}function Qd(e,n,d){var f=e.tag;if(f===5||f===6)e=e.stateNode,n?d.insertBefore(e,n):d.appendChild(e);else if(f!==4&&(e=e.child,e!==null))for(Qd(e,n,d),e=e.sibling;e!==null;)Qd(e,n,d),e=e.sibling}var ht=null,cr=!1;function vn(e,n,d){for(d=d.child;d!==null;)hg(e,n,d),d=d.sibling}function hg(e,n,d){if(Sr&&typeof Sr.onCommitFiberUnmount=="function")try{Sr.onCommitFiberUnmount(mu,d)}catch{}switch(d.tag){case 5:St||Yi(d,n);case 6:var f=ht,y=cr;ht=null,vn(e,n,d),ht=f,cr=y,ht!==null&&(cr?(e=ht,d=d.stateNode,e.nodeType===8?e.parentNode.removeChild(d):e.removeChild(d)):ht.removeChild(d.stateNode));break;case 18:ht!==null&&(cr?(e=ht,d=d.stateNode,e.nodeType===8?ud(e.parentNode,d):e.nodeType===1&&ud(e,d),_s(e)):ud(ht,d.stateNode));break;case 4:f=ht,y=cr,ht=d.stateNode.containerInfo,cr=!0,vn(e,n,d),ht=f,cr=y;break;case 0:case 11:case 14:case 15:if(!St&&(f=d.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var S=y,P=S.destroy;S=S.tag,P!==void 0&&((S&2)!==0||(S&4)!==0)&&Kd(d,n,P),y=y.next}while(y!==f)}vn(e,n,d);break;case 1:if(!St&&(Yi(d,n),f=d.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=d.memoizedProps,f.state=d.memoizedState,f.componentWillUnmount()}catch(I){Je(d,n,I)}vn(e,n,d);break;case 21:vn(e,n,d);break;case 22:d.mode&1?(St=(f=St)||d.memoizedState!==null,vn(e,n,d),St=f):vn(e,n,d);break;default:vn(e,n,d)}}function fg(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var d=e.stateNode;d===null&&(d=e.stateNode=new n_),n.forEach(function(f){var y=h_.bind(null,e,f);d.has(f)||(d.add(f),f.then(y,y))})}}function ur(e,n){var d=n.deletions;if(d!==null)for(var f=0;f<d.length;f++){var y=d[f];try{var S=e,P=n,I=P;e:for(;I!==null;){switch(I.tag){case 5:ht=I.stateNode,cr=!1;break e;case 3:ht=I.stateNode.containerInfo,cr=!0;break e;case 4:ht=I.stateNode.containerInfo,cr=!0;break e}I=I.return}if(ht===null)throw Error(r(160));hg(S,P,y),ht=null,cr=!1;var b=y.alternate;b!==null&&(b.return=null),y.return=null}catch(j){Je(y,n,j)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)vg(n,e),n=n.sibling}function vg(e,n){var d=e.alternate,f=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ur(n,e),Pr(e),f&4){try{Vs(3,e,e.return),il(3,e)}catch(ne){Je(e,e.return,ne)}try{Vs(5,e,e.return)}catch(ne){Je(e,e.return,ne)}}break;case 1:ur(n,e),Pr(e),f&512&&d!==null&&Yi(d,d.return);break;case 5:if(ur(n,e),Pr(e),f&512&&d!==null&&Yi(d,d.return),e.flags&32){var y=e.stateNode;try{Mr(y,"")}catch(ne){Je(e,e.return,ne)}}if(f&4&&(y=e.stateNode,y!=null)){var S=e.memoizedProps,P=d!==null?d.memoizedProps:S,I=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{I==="input"&&S.type==="radio"&&S.name!=null&&Zt(y,S),en(I,P);var j=en(I,S);for(P=0;P<b.length;P+=2){var B=b[P],F=b[P+1];B==="style"?Xr(y,F):B==="dangerouslySetInnerHTML"?Or(y,F):B==="children"?Mr(y,F):T(y,B,F,j)}switch(I){case"input":_t(y,S);break;case"textarea":ki(y,S);break;case"select":var q=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!S.multiple;var X=S.value;X!=null?Vt(y,!!S.multiple,X,!1):q!==!!S.multiple&&(S.defaultValue!=null?Vt(y,!!S.multiple,S.defaultValue,!0):Vt(y,!!S.multiple,S.multiple?[]:"",!1))}y[js]=S}catch(ne){Je(e,e.return,ne)}}break;case 6:if(ur(n,e),Pr(e),f&4){if(e.stateNode===null)throw Error(r(162));y=e.stateNode,S=e.memoizedProps;try{y.nodeValue=S}catch(ne){Je(e,e.return,ne)}}break;case 3:if(ur(n,e),Pr(e),f&4&&d!==null&&d.memoizedState.isDehydrated)try{_s(n.containerInfo)}catch(ne){Je(e,e.return,ne)}break;case 4:ur(n,e),Pr(e);break;case 13:ur(n,e),Pr(e),y=e.child,y.flags&8192&&(S=y.memoizedState!==null,y.stateNode.isHidden=S,!S||y.alternate!==null&&y.alternate.memoizedState!==null||(Zd=Ge())),f&4&&fg(e);break;case 22:if(B=d!==null&&d.memoizedState!==null,e.mode&1?(St=(j=St)||B,ur(n,e),St=j):ur(n,e),Pr(e),f&8192){if(j=e.memoizedState!==null,(e.stateNode.isHidden=j)&&!B&&(e.mode&1)!==0)for(Z=e,B=e.child;B!==null;){for(F=Z=B;Z!==null;){switch(q=Z,X=q.child,q.tag){case 0:case 11:case 14:case 15:Vs(4,q,q.return);break;case 1:Yi(q,q.return);var re=q.stateNode;if(typeof re.componentWillUnmount=="function"){f=q,d=q.return;try{n=f,re.props=n.memoizedProps,re.state=n.memoizedState,re.componentWillUnmount()}catch(ne){Je(f,d,ne)}}break;case 5:Yi(q,q.return);break;case 22:if(q.memoizedState!==null){yg(F);continue}}X!==null?(X.return=q,Z=X):yg(F)}B=B.sibling}e:for(B=null,F=e;;){if(F.tag===5){if(B===null){B=F;try{y=F.stateNode,j?(S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(I=F.stateNode,b=F.memoizedProps.style,P=b!=null&&b.hasOwnProperty("display")?b.display:null,I.style.display=xn("display",P))}catch(ne){Je(e,e.return,ne)}}}else if(F.tag===6){if(B===null)try{F.stateNode.nodeValue=j?"":F.memoizedProps}catch(ne){Je(e,e.return,ne)}}else if((F.tag!==22&&F.tag!==23||F.memoizedState===null||F===e)&&F.child!==null){F.child.return=F,F=F.child;continue}if(F===e)break e;for(;F.sibling===null;){if(F.return===null||F.return===e)break e;B===F&&(B=null),F=F.return}B===F&&(B=null),F.sibling.return=F.return,F=F.sibling}}break;case 19:ur(n,e),Pr(e),f&4&&fg(e);break;case 21:break;default:ur(n,e),Pr(e)}}function Pr(e){var n=e.flags;if(n&2){try{e:{for(var d=e.return;d!==null;){if(dg(d)){var f=d;break e}d=d.return}throw Error(r(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(Mr(y,""),f.flags&=-33);var S=pg(e);Qd(e,S,y);break;case 3:case 4:var P=f.stateNode.containerInfo,I=pg(e);Gd(e,I,P);break;default:throw Error(r(161))}}catch(b){Je(e,e.return,b)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function s_(e,n,d){Z=e,gg(e)}function gg(e,n,d){for(var f=(e.mode&1)!==0;Z!==null;){var y=Z,S=y.child;if(y.tag===22&&f){var P=y.memoizedState!==null||nl;if(!P){var I=y.alternate,b=I!==null&&I.memoizedState!==null||St;I=nl;var j=St;if(nl=P,(St=b)&&!j)for(Z=y;Z!==null;)P=Z,b=P.child,P.tag===22&&P.memoizedState!==null?Sg(y):b!==null?(b.return=P,Z=b):Sg(y);for(;S!==null;)Z=S,gg(S),S=S.sibling;Z=y,nl=I,St=j}mg(e)}else(y.subtreeFlags&8772)!==0&&S!==null?(S.return=y,Z=S):mg(e)}}function mg(e){for(;Z!==null;){var n=Z;if((n.flags&8772)!==0){var d=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:St||il(5,n);break;case 1:var f=n.stateNode;if(n.flags&4&&!St)if(d===null)f.componentDidMount();else{var y=n.elementType===n.type?d.memoizedProps:ar(n.type,d.memoizedProps);f.componentDidUpdate(y,d.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var S=n.updateQueue;S!==null&&yv(n,S,f);break;case 3:var P=n.updateQueue;if(P!==null){if(d=null,n.child!==null)switch(n.child.tag){case 5:d=n.child.stateNode;break;case 1:d=n.child.stateNode}yv(n,P,d)}break;case 5:var I=n.stateNode;if(d===null&&n.flags&4){d=I;var b=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&d.focus();break;case"img":b.src&&(d.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var j=n.alternate;if(j!==null){var B=j.memoizedState;if(B!==null){var F=B.dehydrated;F!==null&&_s(F)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}St||n.flags&512&&Jd(n)}catch(q){Je(n,n.return,q)}}if(n===e){Z=null;break}if(d=n.sibling,d!==null){d.return=n.return,Z=d;break}Z=n.return}}function yg(e){for(;Z!==null;){var n=Z;if(n===e){Z=null;break}var d=n.sibling;if(d!==null){d.return=n.return,Z=d;break}Z=n.return}}function Sg(e){for(;Z!==null;){var n=Z;try{switch(n.tag){case 0:case 11:case 15:var d=n.return;try{il(4,n)}catch(b){Je(n,d,b)}break;case 1:var f=n.stateNode;if(typeof f.componentDidMount=="function"){var y=n.return;try{f.componentDidMount()}catch(b){Je(n,y,b)}}var S=n.return;try{Jd(n)}catch(b){Je(n,S,b)}break;case 5:var P=n.return;try{Jd(n)}catch(b){Je(n,P,b)}}}catch(b){Je(n,n.return,b)}if(n===e){Z=null;break}var I=n.sibling;if(I!==null){I.return=n.return,Z=I;break}Z=n.return}}var o_=Math.ceil,sl=D.ReactCurrentDispatcher,Yd=D.ReactCurrentOwner,Yt=D.ReactCurrentBatchConfig,Te=0,ot=null,et=null,ft=0,Ft=0,Xi=ln(0),rt=0,Ks=null,Wn=0,ol=0,Xd=0,Js=null,kt=null,Zd=0,Zi=1/0,$r=null,al=!1,ep=null,gn=null,cl=!1,mn=null,ul=0,Gs=0,tp=null,ll=-1,dl=0;function wt(){return(Te&6)!==0?Ge():ll!==-1?ll:ll=Ge()}function yn(e){return(e.mode&1)===0?1:(Te&2)!==0&&ft!==0?ft&-ft:$0.transition!==null?(dl===0&&(dl=pf()),dl):(e=Me,e!==0||(e=window.event,e=e===void 0?16:wf(e.type)),e)}function lr(e,n,d,f){if(50<Gs)throw Gs=0,tp=null,Error(r(185));Ss(e,d,f),((Te&2)===0||e!==ot)&&(e===ot&&((Te&2)===0&&(ol|=d),rt===4&&Sn(e,ft)),Ot(e,f),d===1&&Te===0&&(n.mode&1)===0&&(Zi=Ge()+500,qu&&pn()))}function Ot(e,n){var d=e.callbackNode;$P(e,n);var f=Cu(e,e===ot?ft:0);if(f===0)d!==null&&uf(d),e.callbackNode=null,e.callbackPriority=0;else if(n=f&-f,e.callbackPriority!==n){if(d!=null&&uf(d),n===1)e.tag===0?U0(wg.bind(null,e)):ov(wg.bind(null,e)),L0(function(){(Te&6)===0&&pn()}),d=null;else{switch(hf(f)){case 1:d=Dl;break;case 4:d=lf;break;case 16:d=gu;break;case 536870912:d=df;break;default:d=gu}d=bg(d,Cg.bind(null,e))}e.callbackPriority=n,e.callbackNode=d}}function Cg(e,n){if(ll=-1,dl=0,(Te&6)!==0)throw Error(r(327));var d=e.callbackNode;if(es()&&e.callbackNode!==d)return null;var f=Cu(e,e===ot?ft:0);if(f===0)return null;if((f&30)!==0||(f&e.expiredLanes)!==0||n)n=pl(e,f);else{n=f;var y=Te;Te|=2;var S=Pg();(ot!==e||ft!==n)&&($r=null,Zi=Ge()+500,Vn(e,n));do try{u_();break}catch(I){Rg(e,I)}while(!0);Sd(),sl.current=S,Te=y,et!==null?n=0:(ot=null,ft=0,n=rt)}if(n!==0){if(n===2&&(y=jl(e),y!==0&&(f=y,n=rp(e,y))),n===1)throw d=Ks,Vn(e,0),Sn(e,f),Ot(e,Ge()),d;if(n===6)Sn(e,f);else{if(y=e.current.alternate,(f&30)===0&&!a_(y)&&(n=pl(e,f),n===2&&(S=jl(e),S!==0&&(f=S,n=rp(e,S))),n===1))throw d=Ks,Vn(e,0),Sn(e,f),Ot(e,Ge()),d;switch(e.finishedWork=y,e.finishedLanes=f,n){case 0:case 1:throw Error(r(345));case 2:Kn(e,kt,$r);break;case 3:if(Sn(e,f),(f&130023424)===f&&(n=Zd+500-Ge(),10<n)){if(Cu(e,0)!==0)break;if(y=e.suspendedLanes,(y&f)!==f){wt(),e.pingedLanes|=e.suspendedLanes&y;break}e.timeoutHandle=cd(Kn.bind(null,e,kt,$r),n);break}Kn(e,kt,$r);break;case 4:if(Sn(e,f),(f&4194240)===f)break;for(n=e.eventTimes,y=-1;0<f;){var P=31-ir(f);S=1<<P,P=n[P],P>y&&(y=P),f&=~S}if(f=y,f=Ge()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*o_(f/1960))-f,10<f){e.timeoutHandle=cd(Kn.bind(null,e,kt,$r),f);break}Kn(e,kt,$r);break;case 5:Kn(e,kt,$r);break;default:throw Error(r(329))}}}return Ot(e,Ge()),e.callbackNode===d?Cg.bind(null,e):null}function rp(e,n){var d=Js;return e.current.memoizedState.isDehydrated&&(Vn(e,n).flags|=256),e=pl(e,n),e!==2&&(n=kt,kt=d,n!==null&&np(n)),e}function np(e){kt===null?kt=e:kt.push.apply(kt,e)}function a_(e){for(var n=e;;){if(n.flags&16384){var d=n.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var f=0;f<d.length;f++){var y=d[f],S=y.getSnapshot;y=y.value;try{if(!sr(S(),y))return!1}catch{return!1}}}if(d=n.child,n.subtreeFlags&16384&&d!==null)d.return=n,n=d;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Sn(e,n){for(n&=~Xd,n&=~ol,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var d=31-ir(n),f=1<<d;e[d]=-1,n&=~f}}function wg(e){if((Te&6)!==0)throw Error(r(327));es();var n=Cu(e,0);if((n&1)===0)return Ot(e,Ge()),null;var d=pl(e,n);if(e.tag!==0&&d===2){var f=jl(e);f!==0&&(n=f,d=rp(e,f))}if(d===1)throw d=Ks,Vn(e,0),Sn(e,n),Ot(e,Ge()),d;if(d===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Kn(e,kt,$r),Ot(e,Ge()),null}function ip(e,n){var d=Te;Te|=1;try{return e(n)}finally{Te=d,Te===0&&(Zi=Ge()+500,qu&&pn())}}function Hn(e){mn!==null&&mn.tag===0&&(Te&6)===0&&es();var n=Te;Te|=1;var d=Yt.transition,f=Me;try{if(Yt.transition=null,Me=1,e)return e()}finally{Me=f,Yt.transition=d,Te=n,(Te&6)===0&&pn()}}function sp(){Ft=Xi.current,Le(Xi)}function Vn(e,n){e.finishedWork=null,e.finishedLanes=0;var d=e.timeoutHandle;if(d!==-1&&(e.timeoutHandle=-1,z0(d)),et!==null)for(d=et.return;d!==null;){var f=d;switch(fd(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&zu();break;case 3:Gi(),Le(It),Le(gt),Id();break;case 5:Ed(f);break;case 4:Gi();break;case 13:Le(We);break;case 19:Le(We);break;case 10:Cd(f.type._context);break;case 22:case 23:sp()}d=d.return}if(ot=e,et=e=Cn(e.current,null),ft=Ft=n,rt=0,Ks=null,Xd=ol=Wn=0,kt=Js=null,Fn!==null){for(n=0;n<Fn.length;n++)if(d=Fn[n],f=d.interleaved,f!==null){d.interleaved=null;var y=f.next,S=d.pending;if(S!==null){var P=S.next;S.next=y,f.next=P}d.pending=f}Fn=null}return e}function Rg(e,n){do{var d=et;try{if(Sd(),Gu.current=Zu,Qu){for(var f=He.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}Qu=!1}if($n=0,st=tt=He=null,Fs=!1,Us=0,Yd.current=null,d===null||d.return===null){rt=1,Ks=n,et=null;break}e:{var S=e,P=d.return,I=d,b=n;if(n=ft,I.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var j=b,B=I,F=B.tag;if((B.mode&1)===0&&(F===0||F===11||F===15)){var q=B.alternate;q?(B.updateQueue=q.updateQueue,B.memoizedState=q.memoizedState,B.lanes=q.lanes):(B.updateQueue=null,B.memoizedState=null)}var X=Kv(P);if(X!==null){X.flags&=-257,Jv(X,P,I,S,n),X.mode&1&&Vv(S,j,n),n=X,b=j;var re=n.updateQueue;if(re===null){var ne=new Set;ne.add(b),n.updateQueue=ne}else re.add(b);break e}else{if((n&1)===0){Vv(S,j,n),op();break e}b=Error(r(426))}}else if(Fe&&I.mode&1){var Qe=Kv(P);if(Qe!==null){(Qe.flags&65536)===0&&(Qe.flags|=256),Jv(Qe,P,I,S,n),md(Qi(b,I));break e}}S=b=Qi(b,I),rt!==4&&(rt=2),Js===null?Js=[S]:Js.push(S),S=P;do{switch(S.tag){case 3:S.flags|=65536,n&=-n,S.lanes|=n;var M=Wv(S,b,n);mv(S,M);break e;case 1:I=b;var k=S.type,x=S.stateNode;if((S.flags&128)===0&&(typeof k.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(gn===null||!gn.has(x)))){S.flags|=65536,n&=-n,S.lanes|=n;var W=Hv(S,I,n);mv(S,W);break e}}S=S.return}while(S!==null)}Eg(d)}catch(oe){n=oe,et===d&&d!==null&&(et=d=d.return);continue}break}while(!0)}function Pg(){var e=sl.current;return sl.current=Zu,e===null?Zu:e}function op(){(rt===0||rt===3||rt===2)&&(rt=4),ot===null||(Wn&268435455)===0&&(ol&268435455)===0||Sn(ot,ft)}function pl(e,n){var d=Te;Te|=2;var f=Pg();(ot!==e||ft!==n)&&($r=null,Vn(e,n));do try{c_();break}catch(y){Rg(e,y)}while(!0);if(Sd(),Te=d,sl.current=f,et!==null)throw Error(r(261));return ot=null,ft=0,rt}function c_(){for(;et!==null;)_g(et)}function u_(){for(;et!==null&&!DP();)_g(et)}function _g(e){var n=Ag(e.alternate,e,Ft);e.memoizedProps=e.pendingProps,n===null?Eg(e):et=n,Yd.current=null}function Eg(e){var n=e;do{var d=n.alternate;if(e=n.return,(n.flags&32768)===0){if(d=t_(d,n,Ft),d!==null){et=d;return}}else{if(d=r_(d,n),d!==null){d.flags&=32767,et=d;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{rt=6,et=null;return}}if(n=n.sibling,n!==null){et=n;return}et=n=e}while(n!==null);rt===0&&(rt=5)}function Kn(e,n,d){var f=Me,y=Yt.transition;try{Yt.transition=null,Me=1,l_(e,n,d,f)}finally{Yt.transition=y,Me=f}return null}function l_(e,n,d,f){do es();while(mn!==null);if((Te&6)!==0)throw Error(r(327));d=e.finishedWork;var y=e.finishedLanes;if(d===null)return null;if(e.finishedWork=null,e.finishedLanes=0,d===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var S=d.lanes|d.childLanes;if(WP(e,S),e===ot&&(et=ot=null,ft=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||cl||(cl=!0,bg(gu,function(){return es(),null})),S=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||S){S=Yt.transition,Yt.transition=null;var P=Me;Me=1;var I=Te;Te|=4,Yd.current=null,i_(e,d),vg(d,e),k0(od),Pu=!!sd,od=sd=null,e.current=d,s_(d),jP(),Te=I,Me=P,Yt.transition=S}else e.current=d;if(cl&&(cl=!1,mn=e,ul=y),S=e.pendingLanes,S===0&&(gn=null),LP(d.stateNode),Ot(e,Ge()),n!==null)for(f=e.onRecoverableError,d=0;d<n.length;d++)y=n[d],f(y.value,{componentStack:y.stack,digest:y.digest});if(al)throw al=!1,e=ep,ep=null,e;return(ul&1)!==0&&e.tag!==0&&es(),S=e.pendingLanes,(S&1)!==0?e===tp?Gs++:(Gs=0,tp=e):Gs=0,pn(),null}function es(){if(mn!==null){var e=hf(ul),n=Yt.transition,d=Me;try{if(Yt.transition=null,Me=16>e?16:e,mn===null)var f=!1;else{if(e=mn,mn=null,ul=0,(Te&6)!==0)throw Error(r(331));var y=Te;for(Te|=4,Z=e.current;Z!==null;){var S=Z,P=S.child;if((Z.flags&16)!==0){var I=S.deletions;if(I!==null){for(var b=0;b<I.length;b++){var j=I[b];for(Z=j;Z!==null;){var B=Z;switch(B.tag){case 0:case 11:case 15:Vs(8,B,S)}var F=B.child;if(F!==null)F.return=B,Z=F;else for(;Z!==null;){B=Z;var q=B.sibling,X=B.return;if(lg(B),B===j){Z=null;break}if(q!==null){q.return=X,Z=q;break}Z=X}}}var re=S.alternate;if(re!==null){var ne=re.child;if(ne!==null){re.child=null;do{var Qe=ne.sibling;ne.sibling=null,ne=Qe}while(ne!==null)}}Z=S}}if((S.subtreeFlags&2064)!==0&&P!==null)P.return=S,Z=P;else e:for(;Z!==null;){if(S=Z,(S.flags&2048)!==0)switch(S.tag){case 0:case 11:case 15:Vs(9,S,S.return)}var M=S.sibling;if(M!==null){M.return=S.return,Z=M;break e}Z=S.return}}var k=e.current;for(Z=k;Z!==null;){P=Z;var x=P.child;if((P.subtreeFlags&2064)!==0&&x!==null)x.return=P,Z=x;else e:for(P=k;Z!==null;){if(I=Z,(I.flags&2048)!==0)try{switch(I.tag){case 0:case 11:case 15:il(9,I)}}catch(oe){Je(I,I.return,oe)}if(I===P){Z=null;break e}var W=I.sibling;if(W!==null){W.return=I.return,Z=W;break e}Z=I.return}}if(Te=y,pn(),Sr&&typeof Sr.onPostCommitFiberRoot=="function")try{Sr.onPostCommitFiberRoot(mu,e)}catch{}f=!0}return f}finally{Me=d,Yt.transition=n}}return!1}function Tg(e,n,d){n=Qi(d,n),n=Wv(e,n,1),e=fn(e,n,1),n=wt(),e!==null&&(Ss(e,1,n),Ot(e,n))}function Je(e,n,d){if(e.tag===3)Tg(e,e,d);else for(;n!==null;){if(n.tag===3){Tg(n,e,d);break}else if(n.tag===1){var f=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(gn===null||!gn.has(f))){e=Qi(d,e),e=Hv(n,e,1),n=fn(n,e,1),e=wt(),n!==null&&(Ss(n,1,e),Ot(n,e));break}}n=n.return}}function d_(e,n,d){var f=e.pingCache;f!==null&&f.delete(n),n=wt(),e.pingedLanes|=e.suspendedLanes&d,ot===e&&(ft&d)===d&&(rt===4||rt===3&&(ft&130023424)===ft&&500>Ge()-Zd?Vn(e,0):Xd|=d),Ot(e,n)}function Ig(e,n){n===0&&((e.mode&1)===0?n=1:(n=Su,Su<<=1,(Su&130023424)===0&&(Su=4194304)));var d=wt();e=Br(e,n),e!==null&&(Ss(e,n,d),Ot(e,d))}function p_(e){var n=e.memoizedState,d=0;n!==null&&(d=n.retryLane),Ig(e,d)}function h_(e,n){var d=0;switch(e.tag){case 13:var f=e.stateNode,y=e.memoizedState;y!==null&&(d=y.retryLane);break;case 19:f=e.stateNode;break;default:throw Error(r(314))}f!==null&&f.delete(n),Ig(e,d)}var Ag;Ag=function(e,n,d){if(e!==null)if(e.memoizedProps!==n.pendingProps||It.current)bt=!0;else{if((e.lanes&d)===0&&(n.flags&128)===0)return bt=!1,e_(e,n,d);bt=(e.flags&131072)!==0}else bt=!1,Fe&&(n.flags&1048576)!==0&&av(n,Fu,n.index);switch(n.lanes=0,n.tag){case 2:var f=n.type;rl(e,n),e=n.pendingProps;var y=Ui(n,gt.current);Ji(n,d),y=kd(null,n,f,e,y,d);var S=Od();return n.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,At(f)?(S=!0,Lu(n)):S=!1,n.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Pd(n),y.updater=el,n.stateNode=y,y._reactInternals=n,zd(n,f,e,d),n=Fd(null,n,f,!0,S,d)):(n.tag=0,Fe&&S&&hd(n),Ct(null,n,y,d),n=n.child),n;case 16:f=n.elementType;e:{switch(rl(e,n),e=n.pendingProps,y=f._init,f=y(f._payload),n.type=f,y=n.tag=v_(f),e=ar(f,e),y){case 0:n=Bd(null,n,f,e,d);break e;case 1:n=eg(null,n,f,e,d);break e;case 11:n=Gv(null,n,f,e,d);break e;case 14:n=Qv(null,n,f,ar(f.type,e),d);break e}throw Error(r(306,f,""))}return n;case 0:return f=n.type,y=n.pendingProps,y=n.elementType===f?y:ar(f,y),Bd(e,n,f,y,d);case 1:return f=n.type,y=n.pendingProps,y=n.elementType===f?y:ar(f,y),eg(e,n,f,y,d);case 3:e:{if(tg(n),e===null)throw Error(r(387));f=n.pendingProps,S=n.memoizedState,y=S.element,gv(e,n),Ku(n,f,null,d);var P=n.memoizedState;if(f=P.element,S.isDehydrated)if(S={element:f,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},n.updateQueue.baseState=S,n.memoizedState=S,n.flags&256){y=Qi(Error(r(423)),n),n=rg(e,n,f,d,y);break e}else if(f!==y){y=Qi(Error(r(424)),n),n=rg(e,n,f,d,y);break e}else for(Bt=un(n.stateNode.containerInfo.firstChild),qt=n,Fe=!0,or=null,d=fv(n,null,f,d),n.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Hi(),f===y){n=Ur(e,n,d);break e}Ct(e,n,f,d)}n=n.child}return n;case 5:return Sv(n),e===null&&gd(n),f=n.type,y=n.pendingProps,S=e!==null?e.memoizedProps:null,P=y.children,ad(f,y)?P=null:S!==null&&ad(f,S)&&(n.flags|=32),Zv(e,n),Ct(e,n,P,d),n.child;case 6:return e===null&&gd(n),null;case 13:return ng(e,n,d);case 4:return _d(n,n.stateNode.containerInfo),f=n.pendingProps,e===null?n.child=Vi(n,null,f,d):Ct(e,n,f,d),n.child;case 11:return f=n.type,y=n.pendingProps,y=n.elementType===f?y:ar(f,y),Gv(e,n,f,y,d);case 7:return Ct(e,n,n.pendingProps,d),n.child;case 8:return Ct(e,n,n.pendingProps.children,d),n.child;case 12:return Ct(e,n,n.pendingProps.children,d),n.child;case 10:e:{if(f=n.type._context,y=n.pendingProps,S=n.memoizedProps,P=y.value,je(Wu,f._currentValue),f._currentValue=P,S!==null)if(sr(S.value,P)){if(S.children===y.children&&!It.current){n=Ur(e,n,d);break e}}else for(S=n.child,S!==null&&(S.return=n);S!==null;){var I=S.dependencies;if(I!==null){P=S.child;for(var b=I.firstContext;b!==null;){if(b.context===f){if(S.tag===1){b=Fr(-1,d&-d),b.tag=2;var j=S.updateQueue;if(j!==null){j=j.shared;var B=j.pending;B===null?b.next=b:(b.next=B.next,B.next=b),j.pending=b}}S.lanes|=d,b=S.alternate,b!==null&&(b.lanes|=d),wd(S.return,d,n),I.lanes|=d;break}b=b.next}}else if(S.tag===10)P=S.type===n.type?null:S.child;else if(S.tag===18){if(P=S.return,P===null)throw Error(r(341));P.lanes|=d,I=P.alternate,I!==null&&(I.lanes|=d),wd(P,d,n),P=S.sibling}else P=S.child;if(P!==null)P.return=S;else for(P=S;P!==null;){if(P===n){P=null;break}if(S=P.sibling,S!==null){S.return=P.return,P=S;break}P=P.return}S=P}Ct(e,n,y.children,d),n=n.child}return n;case 9:return y=n.type,f=n.pendingProps.children,Ji(n,d),y=Gt(y),f=f(y),n.flags|=1,Ct(e,n,f,d),n.child;case 14:return f=n.type,y=ar(f,n.pendingProps),y=ar(f.type,y),Qv(e,n,f,y,d);case 15:return Yv(e,n,n.type,n.pendingProps,d);case 17:return f=n.type,y=n.pendingProps,y=n.elementType===f?y:ar(f,y),rl(e,n),n.tag=1,At(f)?(e=!0,Lu(n)):e=!1,Ji(n,d),Uv(n,f,y),zd(n,f,y,d),Fd(null,n,f,!0,e,d);case 19:return sg(e,n,d);case 22:return Xv(e,n,d)}throw Error(r(156,n.tag))};function bg(e,n){return Nn(e,n)}function f_(e,n,d,f){this.tag=e,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(e,n,d,f){return new f_(e,n,d,f)}function ap(e){return e=e.prototype,!(!e||!e.isReactComponent)}function v_(e){if(typeof e=="function")return ap(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Be)return 11;if(e===Ce)return 14}return 2}function Cn(e,n){var d=e.alternate;return d===null?(d=Xt(e.tag,n,e.key,e.mode),d.elementType=e.elementType,d.type=e.type,d.stateNode=e.stateNode,d.alternate=e,e.alternate=d):(d.pendingProps=n,d.type=e.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=e.flags&14680064,d.childLanes=e.childLanes,d.lanes=e.lanes,d.child=e.child,d.memoizedProps=e.memoizedProps,d.memoizedState=e.memoizedState,d.updateQueue=e.updateQueue,n=e.dependencies,d.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},d.sibling=e.sibling,d.index=e.index,d.ref=e.ref,d}function hl(e,n,d,f,y,S){var P=2;if(f=e,typeof e=="function")ap(e)&&(P=1);else if(typeof e=="string")P=5;else e:switch(e){case ie:return Jn(d.children,y,S,n);case Y:P=8,y|=8;break;case Ie:return e=Xt(12,d,n,y|2),e.elementType=Ie,e.lanes=S,e;case Ee:return e=Xt(13,d,n,y),e.elementType=Ee,e.lanes=S,e;case pe:return e=Xt(19,d,n,y),e.elementType=pe,e.lanes=S,e;case se:return fl(d,y,S,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case De:P=10;break e;case Xe:P=9;break e;case Be:P=11;break e;case Ce:P=14;break e;case ae:P=16,f=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return n=Xt(P,d,n,y),n.elementType=e,n.type=f,n.lanes=S,n}function Jn(e,n,d,f){return e=Xt(7,e,f,n),e.lanes=d,e}function fl(e,n,d,f){return e=Xt(22,e,f,n),e.elementType=se,e.lanes=d,e.stateNode={isHidden:!1},e}function cp(e,n,d){return e=Xt(6,e,null,n),e.lanes=d,e}function up(e,n,d){return n=Xt(4,e.children!==null?e.children:[],e.key,n),n.lanes=d,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function g_(e,n,d,f,y){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nl(0),this.expirationTimes=Nl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nl(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function lp(e,n,d,f,y,S,P,I,b){return e=new g_(e,n,d,I,b),n===1?(n=1,S===!0&&(n|=8)):n=0,S=Xt(3,null,null,n),e.current=S,S.stateNode=e,S.memoizedState={element:f,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pd(S),e}function m_(e,n,d){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:f==null?null:""+f,children:e,containerInfo:n,implementation:d}}function kg(e){if(!e)return dn;e=e._reactInternals;e:{if(pt(e)!==e||e.tag!==1)throw Error(r(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(At(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(e.tag===1){var d=e.type;if(At(d))return iv(e,d,n)}return n}function Og(e,n,d,f,y,S,P,I,b){return e=lp(d,f,!0,e,y,S,P,I,b),e.context=kg(null),d=e.current,f=wt(),y=yn(d),S=Fr(f,y),S.callback=n??null,fn(d,S,y),e.current.lanes=y,Ss(e,y,f),Ot(e,f),e}function vl(e,n,d,f){var y=n.current,S=wt(),P=yn(y);return d=kg(d),n.context===null?n.context=d:n.pendingContext=d,n=Fr(S,P),n.payload={element:e},f=f===void 0?null:f,f!==null&&(n.callback=f),e=fn(y,n,P),e!==null&&(lr(e,y,P,S),Vu(e,y,P)),P}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Mg(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var d=e.retryLane;e.retryLane=d!==0&&d<n?d:n}}function dp(e,n){Mg(e,n),(e=e.alternate)&&Mg(e,n)}function y_(){return null}var xg=typeof reportError=="function"?reportError:function(e){console.error(e)};function pp(e){this._internalRoot=e}ml.prototype.render=pp.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(r(409));vl(e,n,null,null)},ml.prototype.unmount=pp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Hn(function(){vl(null,e,null,null)}),n[Nr]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var n=gf();e={blockedOn:null,target:e,priority:n};for(var d=0;d<on.length&&n!==0&&n<on[d].priority;d++);on.splice(d,0,e),d===0&&Sf(e)}};function hp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function yl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dg(){}function S_(e,n,d,f,y){if(y){if(typeof f=="function"){var S=f;f=function(){var j=gl(P);S.call(j)}}var P=Og(n,f,e,0,null,!1,!1,"",Dg);return e._reactRootContainer=P,e[Nr]=P.current,xs(e.nodeType===8?e.parentNode:e),Hn(),P}for(;y=e.lastChild;)e.removeChild(y);if(typeof f=="function"){var I=f;f=function(){var j=gl(b);I.call(j)}}var b=lp(e,0,!1,null,null,!1,!1,"",Dg);return e._reactRootContainer=b,e[Nr]=b.current,xs(e.nodeType===8?e.parentNode:e),Hn(function(){vl(n,b,d,f)}),b}function Sl(e,n,d,f,y){var S=d._reactRootContainer;if(S){var P=S;if(typeof y=="function"){var I=y;y=function(){var b=gl(P);I.call(b)}}vl(n,P,e,y)}else P=S_(d,n,e,y,f);return gl(P)}ff=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var d=ys(n.pendingLanes);d!==0&&(zl(n,d|1),Ot(n,Ge()),(Te&6)===0&&(Zi=Ge()+500,pn()))}break;case 13:Hn(function(){var f=Br(e,1);if(f!==null){var y=wt();lr(f,e,1,y)}}),dp(e,1)}},Ll=function(e){if(e.tag===13){var n=Br(e,134217728);if(n!==null){var d=wt();lr(n,e,134217728,d)}dp(e,134217728)}},vf=function(e){if(e.tag===13){var n=yn(e),d=Br(e,n);if(d!==null){var f=wt();lr(d,e,n,f)}dp(e,n)}},gf=function(){return Me},mf=function(e,n){var d=Me;try{return Me=e,n()}finally{Me=d}},xr=function(e,n,d){switch(n){case"input":if(_t(e,d),n=d.name,d.type==="radio"&&n!=null){for(d=e;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<d.length;n++){var f=d[n];if(f!==e&&f.form===e.form){var y=Nu(f);if(!y)throw Error(r(90));Ii(f),_t(f,y)}}}break;case"textarea":ki(e,d);break;case"select":n=d.value,n!=null&&Vt(e,!!d.multiple,n,!1)}},Mi=ip,z=Hn;var C_={usingClientEntryPoint:!1,Events:[Ns,Bi,Nu,Dr,Oi,ip]},Qs={findFiberByHostInstance:zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w_={bundleType:Qs.bundleType,version:Qs.version,rendererPackageName:Qs.rendererPackageName,rendererConfig:Qs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=jr(e),e===null?null:e.stateNode},findFiberByHostInstance:Qs.findFiberByHostInstance||y_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cl.isDisabled&&Cl.supportsFiber)try{mu=Cl.inject(w_),Sr=Cl}catch{}}return Mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C_,Mt.createPortal=function(e,n){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hp(n))throw Error(r(200));return m_(e,n,null,d)},Mt.createRoot=function(e,n){if(!hp(e))throw Error(r(299));var d=!1,f="",y=xg;return n!=null&&(n.unstable_strictMode===!0&&(d=!0),n.identifierPrefix!==void 0&&(f=n.identifierPrefix),n.onRecoverableError!==void 0&&(y=n.onRecoverableError)),n=lp(e,1,!1,null,null,d,!1,f,y),e[Nr]=n.current,xs(e.nodeType===8?e.parentNode:e),new pp(n)},Mt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=jr(n),e=e===null?null:e.stateNode,e},Mt.flushSync=function(e){return Hn(e)},Mt.hydrate=function(e,n,d){if(!yl(n))throw Error(r(200));return Sl(null,e,n,!0,d)},Mt.hydrateRoot=function(e,n,d){if(!hp(e))throw Error(r(405));var f=d!=null&&d.hydratedSources||null,y=!1,S="",P=xg;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onRecoverableError!==void 0&&(P=d.onRecoverableError)),n=Og(n,null,e,1,d??null,y,!1,S,P),e[Nr]=n.current,xs(e),f)for(e=0;e<f.length;e++)d=f[e],y=d._getVersion,y=y(d._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[d,y]:n.mutableSourceEagerHydrationData.push(d,y);return new ml(n)},Mt.render=function(e,n,d){if(!yl(n))throw Error(r(200));return Sl(null,e,n,!1,d)},Mt.unmountComponentAtNode=function(e){if(!yl(e))throw Error(r(40));return e._reactRootContainer?(Hn(function(){Sl(null,null,e,!1,function(){e._reactRootContainer=null,e[Nr]=null})}),!0):!1},Mt.unstable_batchedUpdates=ip,Mt.unstable_renderSubtreeIntoContainer=function(e,n,d,f){if(!yl(d))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Sl(e,n,d,!1,f)},Mt.version="18.3.1-next-f1338f8080-20240426",Mt}var Ug;function k_(){if(Ug)return gp.exports;Ug=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),gp.exports=b_(),gp.exports}var $g;function O_(){if($g)return wl;$g=1;var i=k_();return wl.createRoot=i.createRoot,wl.hydrateRoot=i.hydrateRoot,wl}var M_=O_();const x_=Kh(M_),D_="modulepreload",j_=function(i){return"/"+i},Wg={},ps=function(t,r,u){let o=Promise.resolve();if(r&&r.length>0){let a=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));o=a(r.map(p=>{if(p=j_(p),p in Wg)return;Wg[p]=!0;const h=p.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":D_,h||(g.as="script"),g.crossOrigin="",g.href=p,l&&g.setAttribute("nonce",l),document.head.appendChild(g),h)return new Promise((m,w)=>{g.addEventListener("load",m),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return o.then(a=>{for(const s of a||[])s.status==="rejected"&&c(s.reason);return t().catch(c)})},N_=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...r)=>ps(async()=>{const{default:u}=await Promise.resolve().then(()=>fs);return{default:u}},void 0).then(({default:u})=>u(...r)):t=fetch,(...r)=>t(...r)};class Gh extends Error{constructor(t,r="FunctionsError",u){super(t),this.name=r,this.context=u}}class z_ extends Gh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class L_ extends Gh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class q_ extends Gh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var bh;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(bh||(bh={}));var B_=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};class F_{constructor(t,{headers:r={},customFetch:u,region:o=bh.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=N_(u)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var u;return B_(this,void 0,void 0,function*(){try{const{headers:o,method:c,body:a}=r;let s={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(s["x-region"]=l);let p;a&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(s["Content-Type"]="application/octet-stream",p=a):typeof a=="string"?(s["Content-Type"]="text/plain",p=a):typeof FormData<"u"&&a instanceof FormData?p=a:(s["Content-Type"]="application/json",p=JSON.stringify(a)));const h=yield this.fetch(`${this.url}/${t}`,{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},s),this.headers),o),body:p}).catch(w=>{throw new z_(w)}),v=h.headers.get("x-relay-error");if(v&&v==="true")throw new L_(h);if(!h.ok)throw new q_(h);let g=((u=h.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),m;return g==="application/json"?m=yield h.json():g==="application/octet-stream"?m=yield h.blob():g==="text/event-stream"?m=h:g==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null}}catch(o){return{data:null,error:o}}})}}var ct={},ts={},rs={},ns={},is={},ss={},U_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},hs=U_();const $_=hs.fetch,lR=hs.fetch.bind(hs),dR=hs.Headers,W_=hs.Request,H_=hs.Response,fs=Object.freeze(Object.defineProperty({__proto__:null,Headers:dR,Request:W_,Response:H_,default:lR,fetch:$_},Symbol.toStringTag,{value:"Module"})),V_=uR(fs);var Rl={},Hg;function pR(){if(Hg)return Rl;Hg=1,Object.defineProperty(Rl,"__esModule",{value:!0});class i extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Rl.default=i,Rl}var Vg;function hR(){if(Vg)return ss;Vg=1;var i=ss&&ss.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(ss,"__esModule",{value:!0});const t=i(V_),r=i(pR());class u{constructor(c){this.shouldThrowOnError=!1,this.method=c.method,this.url=c.url,this.headers=c.headers,this.schema=c.schema,this.body=c.body,this.shouldThrowOnError=c.shouldThrowOnError,this.signal=c.signal,this.isMaybeSingle=c.isMaybeSingle,c.fetch?this.fetch=c.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(c,a){return this.headers=Object.assign({},this.headers),this.headers[c]=a,this}then(c,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let l=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var h,v,g;let m=null,w=null,C=null,R=p.status,_=p.statusText;if(p.ok){if(this.method!=="HEAD"){const N=await p.text();N===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?w=N:w=JSON.parse(N))}const T=(h=this.headers.Prefer)===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),D=(v=p.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");T&&D&&D.length>1&&(C=parseInt(D[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(m={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,C=null,R=406,_="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const T=await p.text();try{m=JSON.parse(T),Array.isArray(m)&&p.status===404&&(w=[],m=null,R=200,_="OK")}catch{p.status===404&&T===""?(R=204,_="No Content"):m={message:T}}if(m&&this.isMaybeSingle&&(!((g=m==null?void 0:m.details)===null||g===void 0)&&g.includes("0 rows"))&&(m=null,R=200,_="OK"),m&&this.shouldThrowOnError)throw new r.default(m)}return{error:m,data:w,count:C,status:R,statusText:_}});return this.shouldThrowOnError||(l=l.catch(p=>{var h,v,g;return{error:{message:`${(h=p==null?void 0:p.name)!==null&&h!==void 0?h:"FetchError"}: ${p==null?void 0:p.message}`,details:`${(v=p==null?void 0:p.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(g=p==null?void 0:p.code)!==null&&g!==void 0?g:""}`},data:null,count:null,status:0,statusText:""}})),l.then(c,a)}returns(){return this}overrideTypes(){return this}}return ss.default=u,ss}var Kg;function fR(){if(Kg)return is;Kg=1;var i=is&&is.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(is,"__esModule",{value:!0});const t=i(hR());class r extends t.default{select(o){let c=!1;const a=(o??"*").split("").map(s=>/\s/.test(s)&&!c?"":(s==='"'&&(c=!c),s)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(o,{ascending:c=!0,nullsFirst:a,foreignTable:s,referencedTable:l=s}={}){const p=l?`${l}.order`:"order",h=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${h?`${h},`:""}${o}.${c?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:c,referencedTable:a=c}={}){const s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${o}`),this}range(o,c,{foreignTable:a,referencedTable:s=a}={}){const l=typeof s>"u"?"offset":`${s}.offset`,p=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(l,`${o}`),this.url.searchParams.set(p,`${c-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:o=!1,verbose:c=!1,settings:a=!1,buffers:s=!1,wal:l=!1,format:p="text"}={}){var h;const v=[o?"analyze":null,c?"verbose":null,a?"settings":null,s?"buffers":null,l?"wal":null].filter(Boolean).join("|"),g=(h=this.headers.Accept)!==null&&h!==void 0?h:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${p}; for="${g}"; options=${v};`,p==="json"?this:this}rollback(){var o;return((o=this.headers.Prefer)!==null&&o!==void 0?o:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return is.default=r,is}var Jg;function Qh(){if(Jg)return ns;Jg=1;var i=ns&&ns.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ns,"__esModule",{value:!0});const t=i(fR());class r extends t.default{eq(o,c){return this.url.searchParams.append(o,`eq.${c}`),this}neq(o,c){return this.url.searchParams.append(o,`neq.${c}`),this}gt(o,c){return this.url.searchParams.append(o,`gt.${c}`),this}gte(o,c){return this.url.searchParams.append(o,`gte.${c}`),this}lt(o,c){return this.url.searchParams.append(o,`lt.${c}`),this}lte(o,c){return this.url.searchParams.append(o,`lte.${c}`),this}like(o,c){return this.url.searchParams.append(o,`like.${c}`),this}likeAllOf(o,c){return this.url.searchParams.append(o,`like(all).{${c.join(",")}}`),this}likeAnyOf(o,c){return this.url.searchParams.append(o,`like(any).{${c.join(",")}}`),this}ilike(o,c){return this.url.searchParams.append(o,`ilike.${c}`),this}ilikeAllOf(o,c){return this.url.searchParams.append(o,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(o,c){return this.url.searchParams.append(o,`ilike(any).{${c.join(",")}}`),this}is(o,c){return this.url.searchParams.append(o,`is.${c}`),this}in(o,c){const a=Array.from(new Set(c)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(o,`in.(${a})`),this}contains(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cs.{${c.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(c)}`),this}containedBy(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cd.{${c.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(c)}`),this}rangeGt(o,c){return this.url.searchParams.append(o,`sr.${c}`),this}rangeGte(o,c){return this.url.searchParams.append(o,`nxl.${c}`),this}rangeLt(o,c){return this.url.searchParams.append(o,`sl.${c}`),this}rangeLte(o,c){return this.url.searchParams.append(o,`nxr.${c}`),this}rangeAdjacent(o,c){return this.url.searchParams.append(o,`adj.${c}`),this}overlaps(o,c){return typeof c=="string"?this.url.searchParams.append(o,`ov.${c}`):this.url.searchParams.append(o,`ov.{${c.join(",")}}`),this}textSearch(o,c,{config:a,type:s}={}){let l="";s==="plain"?l="pl":s==="phrase"?l="ph":s==="websearch"&&(l="w");const p=a===void 0?"":`(${a})`;return this.url.searchParams.append(o,`${l}fts${p}.${c}`),this}match(o){return Object.entries(o).forEach(([c,a])=>{this.url.searchParams.append(c,`eq.${a}`)}),this}not(o,c,a){return this.url.searchParams.append(o,`not.${c}.${a}`),this}or(o,{foreignTable:c,referencedTable:a=c}={}){const s=a?`${a}.or`:"or";return this.url.searchParams.append(s,`(${o})`),this}filter(o,c,a){return this.url.searchParams.append(o,`${c}.${a}`),this}}return ns.default=r,ns}var Gg;function vR(){if(Gg)return rs;Gg=1;var i=rs&&rs.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(rs,"__esModule",{value:!0});const t=i(Qh());class r{constructor(o,{headers:c={},schema:a,fetch:s}){this.url=o,this.headers=c,this.schema=a,this.fetch=s}select(o,{head:c=!1,count:a}={}){const s=c?"HEAD":"GET";let l=!1;const p=(o??"*").split("").map(h=>/\s/.test(h)&&!l?"":(h==='"'&&(l=!l),h)).join("");return this.url.searchParams.set("select",p),a&&(this.headers.Prefer=`count=${a}`),new t.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(o,{count:c,defaultToNull:a=!0}={}){const s="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),c&&l.push(`count=${c}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(o)){const p=o.reduce((h,v)=>h.concat(Object.keys(v)),[]);if(p.length>0){const h=[...new Set(p)].map(v=>`"${v}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}upsert(o,{onConflict:c,ignoreDuplicates:a=!1,count:s,defaultToNull:l=!0}={}){const p="POST",h=[`resolution=${a?"ignore":"merge"}-duplicates`];if(c!==void 0&&this.url.searchParams.set("on_conflict",c),this.headers.Prefer&&h.push(this.headers.Prefer),s&&h.push(`count=${s}`),l||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(o)){const v=o.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(v.length>0){const g=[...new Set(v)].map(m=>`"${m}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}update(o,{count:c}={}){const a="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),c&&s.push(`count=${c}`),this.headers.Prefer=s.join(","),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}delete({count:o}={}){const c="DELETE",a=[];return o&&a.push(`count=${o}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return rs.default=r,rs}var Xs={},Zs={},Qg;function K_(){return Qg||(Qg=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.version=void 0,Zs.version="0.0.0-automated"),Zs}var Yg;function J_(){if(Yg)return Xs;Yg=1,Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.DEFAULT_HEADERS=void 0;const i=K_();return Xs.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${i.version}`},Xs}var Xg;function G_(){if(Xg)return ts;Xg=1;var i=ts&&ts.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(ts,"__esModule",{value:!0});const t=i(vR()),r=i(Qh()),u=J_();class o{constructor(a,{headers:s={},schema:l,fetch:p}={}){this.url=a,this.headers=Object.assign(Object.assign({},u.DEFAULT_HEADERS),s),this.schemaName=l,this.fetch=p}from(a){const s=new URL(`${this.url}/${a}`);return new t.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new o(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,s={},{head:l=!1,get:p=!1,count:h}={}){let v;const g=new URL(`${this.url}/rpc/${a}`);let m;l||p?(v=l?"HEAD":"GET",Object.entries(s).filter(([C,R])=>R!==void 0).map(([C,R])=>[C,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([C,R])=>{g.searchParams.append(C,R)})):(v="POST",m=s);const w=Object.assign({},this.headers);return h&&(w.Prefer=`count=${h}`),new r.default({method:v,url:g,headers:w,schema:this.schemaName,body:m,fetch:this.fetch,allowEmpty:!1})}}return ts.default=o,ts}var Zg;function Q_(){if(Zg)return ct;Zg=1;var i=ct&&ct.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ct,"__esModule",{value:!0}),ct.PostgrestError=ct.PostgrestBuilder=ct.PostgrestTransformBuilder=ct.PostgrestFilterBuilder=ct.PostgrestQueryBuilder=ct.PostgrestClient=void 0;const t=i(G_());ct.PostgrestClient=t.default;const r=i(vR());ct.PostgrestQueryBuilder=r.default;const u=i(Qh());ct.PostgrestFilterBuilder=u.default;const o=i(fR());ct.PostgrestTransformBuilder=o.default;const c=i(hR());ct.PostgrestBuilder=c.default;const a=i(pR());return ct.PostgrestError=a.default,ct.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:u.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:c.default,PostgrestError:a.default},ct}var Y_=Q_();const X_=Kh(Y_),{PostgrestClient:Z_,PostgrestQueryBuilder:Kb,PostgrestFilterBuilder:Jb,PostgrestTransformBuilder:Gb,PostgrestBuilder:Qb,PostgrestError:Yb}=X_,eE="2.11.2",tE={"X-Client-Info":`realtime-js/${eE}`},rE="1.0.0",gR=1e4,nE=1e3;var ds;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(ds||(ds={}));var Ht;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Ht||(Ht={}));var fr;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(fr||(fr={}));var kh;(function(i){i.websocket="websocket"})(kh||(kh={}));var Ri;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ri||(Ri={}));class iE{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),u=new TextDecoder;return this._decodeBroadcast(t,r,u)}_decodeBroadcast(t,r,u){const o=r.getUint8(1),c=r.getUint8(2);let a=this.HEADER_LENGTH+2;const s=u.decode(t.slice(a,a+o));a=a+o;const l=u.decode(t.slice(a,a+c));a=a+c;const p=JSON.parse(u.decode(t.slice(a,t.byteLength)));return{ref:null,topic:s,event:l,payload:p}}}class mR{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ne;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(Ne||(Ne={}));const em=(i,t,r={})=>{var u;const o=(u=r.skipTypes)!==null&&u!==void 0?u:[];return Object.keys(t).reduce((c,a)=>(c[a]=sE(a,i,t,o),c),{})},sE=(i,t,r,u)=>{const o=t.find(s=>s.name===i),c=o==null?void 0:o.type,a=r[i];return c&&!u.includes(c)?yR(c,a):Oh(a)},yR=(i,t)=>{if(i.charAt(0)==="_"){const r=i.slice(1,i.length);return uE(t,r)}switch(i){case Ne.bool:return oE(t);case Ne.float4:case Ne.float8:case Ne.int2:case Ne.int4:case Ne.int8:case Ne.numeric:case Ne.oid:return aE(t);case Ne.json:case Ne.jsonb:return cE(t);case Ne.timestamp:return lE(t);case Ne.abstime:case Ne.date:case Ne.daterange:case Ne.int4range:case Ne.int8range:case Ne.money:case Ne.reltime:case Ne.text:case Ne.time:case Ne.timestamptz:case Ne.timetz:case Ne.tsrange:case Ne.tstzrange:return Oh(t);default:return Oh(t)}},Oh=i=>i,oE=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},aE=i=>{if(typeof i=="string"){const t=parseFloat(i);if(!Number.isNaN(t))return t}return i},cE=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(t){return console.log(`JSON parse error: ${t}`),i}return i},uE=(i,t)=>{if(typeof i!="string")return i;const r=i.length-1,u=i[r];if(i[0]==="{"&&u==="}"){let c;const a=i.slice(1,r);try{c=JSON.parse("["+a+"]")}catch{c=a?a.split(","):[]}return c.map(s=>yR(t,s))}return i},lE=i=>typeof i=="string"?i.replace(" ","T"):i,SR=i=>{let t=i;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Sp{constructor(t,r,u={},o=gR){this.channel=t,this.event=r,this.payload=u,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var u;return this._hasReceived(t)&&r((u=this.receivedResp)===null||u===void 0?void 0:u.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(u=>u.status===t).forEach(u=>u.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var tm;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(tm||(tm={}));class cu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const u=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(u.state,{},o=>{const{onJoin:c,onLeave:a,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cu.syncState(this.state,o,c,a),this.pendingDiffs.forEach(l=>{this.state=cu.syncDiff(this.state,l,c,a)}),this.pendingDiffs=[],s()}),this.channel._on(u.diff,{},o=>{const{onJoin:c,onLeave:a,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=cu.syncDiff(this.state,o,c,a),s())}),this.onJoin((o,c,a)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:c,newPresences:a})}),this.onLeave((o,c,a)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:c,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,u,o){const c=this.cloneDeep(t),a=this.transformState(r),s={},l={};return this.map(c,(p,h)=>{a[p]||(l[p]=h)}),this.map(a,(p,h)=>{const v=c[p];if(v){const g=h.map(R=>R.presence_ref),m=v.map(R=>R.presence_ref),w=h.filter(R=>m.indexOf(R.presence_ref)<0),C=v.filter(R=>g.indexOf(R.presence_ref)<0);w.length>0&&(s[p]=w),C.length>0&&(l[p]=C)}else s[p]=h}),this.syncDiff(c,{joins:s,leaves:l},u,o)}static syncDiff(t,r,u,o){const{joins:c,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return u||(u=()=>{}),o||(o=()=>{}),this.map(c,(s,l)=>{var p;const h=(p=t[s])!==null&&p!==void 0?p:[];if(t[s]=this.cloneDeep(l),h.length>0){const v=t[s].map(m=>m.presence_ref),g=h.filter(m=>v.indexOf(m.presence_ref)<0);t[s].unshift(...g)}u(s,h,l)}),this.map(a,(s,l)=>{let p=t[s];if(!p)return;const h=l.map(v=>v.presence_ref);p=p.filter(v=>h.indexOf(v.presence_ref)<0),t[s]=p,o(s,p,l),p.length===0&&delete t[s]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(u=>r(u,t[u]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,u)=>{const o=t[u];return"metas"in o?r[u]=o.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):r[u]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var rm;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(rm||(rm={}));var nm;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(nm||(nm={}));var Jr;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Jr||(Jr={}));class Yh{constructor(t,r={config:{}},u){this.topic=t,this.params=r,this.socket=u,this.bindings={},this.state=Ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Sp(this,fr.join,this.params,this.timeout),this.rejoinTimer=new mR(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ht.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fr.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new cu(this),this.broadcastEndpointURL=SR(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var u,o;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:c,presence:a,private:s}}=this.params;this._onError(h=>t==null?void 0:t(Jr.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(Jr.CLOSED));const l={},p={broadcast:c,presence:a,postgres_changes:(o=(u=this.bindings.postgres_changes)===null||u===void 0?void 0:u.map(h=>h.filter))!==null&&o!==void 0?o:[],private:s};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:p},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket.setAuth(),h===void 0){t==null||t(Jr.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,m=(v=g==null?void 0:g.length)!==null&&v!==void 0?v:0,w=[];for(let C=0;C<m;C++){const R=g[C],{filter:{event:_,schema:E,table:T,filter:D}}=R,N=h&&h[C];if(N&&N.event===_&&N.schema===E&&N.table===T&&N.filter===D)w.push(Object.assign(Object.assign({},R),{id:N.id}));else{this.unsubscribe(),t==null||t(Jr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Jr.SUBSCRIBED);return}}).receive("error",h=>{t==null||t(Jr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Jr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,u){return this._on(t,r,u)}async send(t,r={}){var u,o;if(!this._canPush()&&t.type==="broadcast"){const{event:c,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:a,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(u=r.timeout)!==null&&u!==void 0?u:this.timeout);return await((o=p.body)===null||o===void 0?void 0:o.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var a,s,l;const p=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(s=(a=this.params)===null||a===void 0?void 0:a.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.ack)&&c("ok"),p.receive("ok",()=>c("ok")),p.receive("error",()=>c("error")),p.receive("timeout",()=>c("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ht.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(u=>{const o=new Sp(this,fr.leave,{},t);o.receive("ok",()=>{r(),u("ok")}).receive("timeout",()=>{r(),u("timed out")}).receive("error",()=>{u("error")}),o.send(),this._canPush()||o.trigger("ok",{})})}async _fetchWithTimeout(t,r,u){const o=new AbortController,c=setTimeout(()=>o.abort(),u),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(c),a}_push(t,r,u=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Sp(this,t,r,u);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(t,r,u){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,u){var o,c;const a=t.toLocaleLowerCase(),{close:s,error:l,leave:p,join:h}=fr;if(u&&[s,l,p,h].indexOf(a)>=0&&u!==this._joinRef())return;let g=this._onMessage(a,r,u);if(r&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(m=>{var w,C,R;return((w=m.filter)===null||w===void 0?void 0:w.event)==="*"||((R=(C=m.filter)===null||C===void 0?void 0:C.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===a}).map(m=>m.callback(g,u)):(c=this.bindings[a])===null||c===void 0||c.filter(m=>{var w,C,R,_,E,T;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const D=m.id,N=(w=m.filter)===null||w===void 0?void 0:w.event;return D&&((C=r.ids)===null||C===void 0?void 0:C.includes(D))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((R=r.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{const D=(E=(_=m==null?void 0:m.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return D==="*"||D===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof g=="object"&&"ids"in g){const w=g.data,{schema:C,table:R,commit_timestamp:_,type:E,errors:T}=w;g=Object.assign(Object.assign({},{schema:C,table:R,commit_timestamp:_,eventType:E,new:{},old:{},errors:T}),this._getPayloadRecords(w))}m.callback(g,u)})}_isClosed(){return this.state===Ht.closed}_isJoined(){return this.state===Ht.joined}_isJoining(){return this.state===Ht.joining}_isLeaving(){return this.state===Ht.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,u){const o=t.toLocaleLowerCase(),c={type:o,filter:r,callback:u};return this.bindings[o]?this.bindings[o].push(c):this.bindings[o]=[c],this}_off(t,r){const u=t.toLocaleLowerCase();return this.bindings[u]=this.bindings[u].filter(o=>{var c;return!(((c=o.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===u&&Yh.isEqual(o.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const u in t)if(t[u]!==r[u])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(fr.close,{},t)}_onError(t){this._on(fr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ht.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=em(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=em(t.columns,t.old_record)),r}}const dE=()=>{},pE=typeof WebSocket<"u",hE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class fE{constructor(t,r){var u;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=tE,this.params={},this.timeout=gR,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=dE,this.conn=null,this.sendBuffer=[],this.serializer=new iE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=c=>{let a;return c?a=c:typeof fetch>"u"?a=(...s)=>ps(async()=>{const{default:l}=await Promise.resolve().then(()=>fs);return{default:l}},void 0).then(({default:l})=>l(...s)):a=fetch,(...s)=>a(...s)},this.endPoint=`${t}/${kh.websocket}`,this.httpEndpoint=SR(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const o=(u=r==null?void 0:r.params)===null||u===void 0?void 0:u.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:c=>[1e3,2e3,5e3,1e4][c-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(c,a)=>a(JSON.stringify(c)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new mR(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(pE){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new vE(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ps(async()=>{const{default:t}=await import("./browser-CT0VsL2V.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:rE}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,u){this.logger(t,r,u)}connectionState(){switch(this.conn&&this.conn.readyState){case ds.connecting:return Ri.Connecting;case ds.open:return Ri.Open;case ds.closing:return Ri.Closing;default:return Ri.Closed}}isConnected(){return this.connectionState()===Ri.Open}channel(t,r={config:{}}){const u=new Yh(`realtime:${t}`,r,this);return this.channels.push(u),u}push(t){const{topic:r,event:u,payload:o,ref:c}=t,a=()=>{this.encode(t,s=>{var l;(l=this.conn)===null||l===void 0||l.send(s)})};this.log("push",`${r} ${u} (${c})`,o),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let u=null;try{u=JSON.parse(atob(r.split(".")[1]))}catch{}if(u&&u.exp&&!(Math.floor(Date.now()/1e3)-u.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${u.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${u.exp}`);this.accessTokenValue=r,this.channels.forEach(o=>{r&&o.updateJoinPayload({access_token:r}),o.joinedOnce&&o._isJoined()&&o._push(fr.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(nE,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(u=>u.topic===t&&(u._isJoined()||u._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:u,event:o,payload:c,ref:a}=r;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${c.status||""} ${u} ${o} ${a&&"("+a+")"||""}`,c),this.channels.filter(s=>s._isMember(u)).forEach(s=>s._trigger(o,c,a)),this.stateChangeCallbacks.message.forEach(s=>s(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(fr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const u=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${u}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const u=new Blob([hE],{type:"application/javascript"});r=URL.createObjectURL(u)}return r}}class vE{constructor(t,r,u){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ds.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=u.close}}class Xh extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ut(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class gE extends Xh{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Mh extends Xh{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var mE=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};const CR=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...r)=>ps(async()=>{const{default:u}=await Promise.resolve().then(()=>fs);return{default:u}},void 0).then(({default:u})=>u(...r)):t=fetch,(...r)=>t(...r)},yE=()=>mE(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ps(()=>Promise.resolve().then(()=>fs),void 0)).Response:Response}),xh=i=>{if(Array.isArray(i))return i.map(r=>xh(r));if(typeof i=="function"||i!==Object(i))return i;const t={};return Object.entries(i).forEach(([r,u])=>{const o=r.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));t[o]=xh(u)}),t};var _i=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};const Cp=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),SE=(i,t,r)=>_i(void 0,void 0,void 0,function*(){const u=yield yE();i instanceof u&&!(r!=null&&r.noResolveJson)?i.json().then(o=>{t(new gE(Cp(o),i.status||500))}).catch(o=>{t(new Mh(Cp(o),o))}):t(new Mh(Cp(i),i))}),CE=(i,t,r,u)=>{const o={method:i,headers:(t==null?void 0:t.headers)||{}};return i==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),u&&(o.body=JSON.stringify(u)),Object.assign(Object.assign({},o),r))};function pu(i,t,r,u,o,c){return _i(this,void 0,void 0,function*(){return new Promise((a,s)=>{i(r,CE(t,u,o,c)).then(l=>{if(!l.ok)throw l;return u!=null&&u.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>SE(l,s,u))})})}function kl(i,t,r,u){return _i(this,void 0,void 0,function*(){return pu(i,"GET",t,r,u)})}function In(i,t,r,u,o){return _i(this,void 0,void 0,function*(){return pu(i,"POST",t,u,o,r)})}function wE(i,t,r,u,o){return _i(this,void 0,void 0,function*(){return pu(i,"PUT",t,u,o,r)})}function RE(i,t,r,u){return _i(this,void 0,void 0,function*(){return pu(i,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),u)})}function wR(i,t,r,u,o){return _i(this,void 0,void 0,function*(){return pu(i,"DELETE",t,u,o,r)})}var xt=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};const PE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},im={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class _E{constructor(t,r={},u,o){this.url=t,this.headers=r,this.bucketId=u,this.fetch=CR(o)}uploadOrUpdate(t,r,u,o){return xt(this,void 0,void 0,function*(){try{let c;const a=Object.assign(Object.assign({},im),o);let s=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&u instanceof Blob?(c=new FormData,c.append("cacheControl",a.cacheControl),l&&c.append("metadata",this.encodeMetadata(l)),c.append("",u)):typeof FormData<"u"&&u instanceof FormData?(c=u,c.append("cacheControl",a.cacheControl),l&&c.append("metadata",this.encodeMetadata(l))):(c=u,s["cache-control"]=`max-age=${a.cacheControl}`,s["content-type"]=a.contentType,l&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),o!=null&&o.headers&&(s=Object.assign(Object.assign({},s),o.headers));const p=this._removeEmptyFolders(r),h=this._getFinalPath(p),v=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:t,body:c,headers:s},a!=null&&a.duplex?{duplex:a.duplex}:{})),g=yield v.json();return v.ok?{data:{path:p,id:g.Id,fullPath:g.Key},error:null}:{data:null,error:g}}catch(c){if(ut(c))return{data:null,error:c};throw c}})}upload(t,r,u){return xt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,u)})}uploadToSignedUrl(t,r,u,o){return xt(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(t),a=this._getFinalPath(c),s=new URL(this.url+`/object/upload/sign/${a}`);s.searchParams.set("token",r);try{let l;const p=Object.assign({upsert:im.upsert},o),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&u instanceof Blob?(l=new FormData,l.append("cacheControl",p.cacheControl),l.append("",u)):typeof FormData<"u"&&u instanceof FormData?(l=u,l.append("cacheControl",p.cacheControl)):(l=u,h["cache-control"]=`max-age=${p.cacheControl}`,h["content-type"]=p.contentType);const v=yield this.fetch(s.toString(),{method:"PUT",body:l,headers:h}),g=yield v.json();return v.ok?{data:{path:c,fullPath:g.Key},error:null}:{data:null,error:g}}catch(l){if(ut(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return xt(this,void 0,void 0,function*(){try{let u=this._getFinalPath(t);const o=Object.assign({},this.headers);r!=null&&r.upsert&&(o["x-upsert"]="true");const c=yield In(this.fetch,`${this.url}/object/upload/sign/${u}`,{},{headers:o}),a=new URL(this.url+c.url),s=a.searchParams.get("token");if(!s)throw new Xh("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:s},error:null}}catch(u){if(ut(u))return{data:null,error:u};throw u}})}update(t,r,u){return xt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,u)})}move(t,r,u){return xt(this,void 0,void 0,function*(){try{return{data:yield In(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:u==null?void 0:u.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(ut(o))return{data:null,error:o};throw o}})}copy(t,r,u){return xt(this,void 0,void 0,function*(){try{return{data:{path:(yield In(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:u==null?void 0:u.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(ut(o))return{data:null,error:o};throw o}})}createSignedUrl(t,r,u){return xt(this,void 0,void 0,function*(){try{let o=this._getFinalPath(t),c=yield In(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},u!=null&&u.transform?{transform:u.transform}:{}),{headers:this.headers});const a=u!=null&&u.download?`&download=${u.download===!0?"":u.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${a}`)},{data:c,error:null}}catch(o){if(ut(o))return{data:null,error:o};throw o}})}createSignedUrls(t,r,u){return xt(this,void 0,void 0,function*(){try{const o=yield In(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),c=u!=null&&u.download?`&download=${u.download===!0?"":u.download}`:"";return{data:o.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${c}`):null})),error:null}}catch(o){if(ut(o))return{data:null,error:o};throw o}})}download(t,r){return xt(this,void 0,void 0,function*(){const o=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=c?`?${c}`:"";try{const s=this._getFinalPath(t);return{data:yield(yield kl(this.fetch,`${this.url}/${o}/${s}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(s){if(ut(s))return{data:null,error:s};throw s}})}info(t){return xt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const u=yield kl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:xh(u),error:null}}catch(u){if(ut(u))return{data:null,error:u};throw u}})}exists(t){return xt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield RE(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(u){if(ut(u)&&u instanceof Mh){const o=u.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:u}}throw u}})}getPublicUrl(t,r){const u=this._getFinalPath(t),o=[],c=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";c!==""&&o.push(c);const s=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&o.push(l);let p=o.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${u}${p}`)}}}remove(t){return xt(this,void 0,void 0,function*(){try{return{data:yield wR(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(ut(r))return{data:null,error:r};throw r}})}list(t,r,u){return xt(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},PE),r),{prefix:t||""});return{data:yield In(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},u),error:null}}catch(o){if(ut(o))return{data:null,error:o};throw o}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const EE="2.7.1",TE={"X-Client-Info":`storage-js/${EE}`};var os=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};class IE{constructor(t,r={},u){this.url=t,this.headers=Object.assign(Object.assign({},TE),r),this.fetch=CR(u)}listBuckets(){return os(this,void 0,void 0,function*(){try{return{data:yield kl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ut(t))return{data:null,error:t};throw t}})}getBucket(t){return os(this,void 0,void 0,function*(){try{return{data:yield kl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(ut(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return os(this,void 0,void 0,function*(){try{return{data:yield In(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(ut(u))return{data:null,error:u};throw u}})}updateBucket(t,r){return os(this,void 0,void 0,function*(){try{return{data:yield wE(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(ut(u))return{data:null,error:u};throw u}})}emptyBucket(t){return os(this,void 0,void 0,function*(){try{return{data:yield In(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(ut(r))return{data:null,error:r};throw r}})}deleteBucket(t){return os(this,void 0,void 0,function*(){try{return{data:yield wR(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(ut(r))return{data:null,error:r};throw r}})}}class AE extends IE{constructor(t,r={},u){super(t,r,u)}from(t){return new _E(this.url,this.headers,t,this.fetch)}}const bE="2.49.4";let ou="";typeof Deno<"u"?ou="deno":typeof document<"u"?ou="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ou="react-native":ou="node";const kE={"X-Client-Info":`supabase-js-${ou}/${bE}`},OE={headers:kE},ME={schema:"public"},xE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DE={};var jE=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};const NE=i=>{let t;return i?t=i:typeof fetch>"u"?t=lR:t=fetch,(...r)=>t(...r)},zE=()=>typeof Headers>"u"?dR:Headers,LE=(i,t,r)=>{const u=NE(r),o=zE();return(c,a)=>jE(void 0,void 0,void 0,function*(){var s;const l=(s=yield t())!==null&&s!==void 0?s:i;let p=new o(a==null?void 0:a.headers);return p.has("apikey")||p.set("apikey",i),p.has("Authorization")||p.set("Authorization",`Bearer ${l}`),u(c,Object.assign(Object.assign({},a),{headers:p}))})};var qE=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};function BE(i){return i.replace(/\/$/,"")}function FE(i,t){const{db:r,auth:u,realtime:o,global:c}=i,{db:a,auth:s,realtime:l,global:p}=t,h={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},s),u),realtime:Object.assign(Object.assign({},l),o),global:Object.assign(Object.assign({},p),c),accessToken:()=>qE(this,void 0,void 0,function*(){return""})};return i.accessToken?h.accessToken=i.accessToken:delete h.accessToken,h}const RR="2.69.1",ls=30*1e3,Dh=3,wp=Dh*ls,UE="http://localhost:9999",$E="supabase.auth.token",WE={"X-Client-Info":`gotrue-js/${RR}`},jh="X-Supabase-Api-Version",PR={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},HE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,VE=6e5;class Zh extends Error{constructor(t,r,u){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=u}}function ye(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class KE extends Zh{constructor(t,r,u){super(t,r,u),this.name="AuthApiError",this.status=r,this.code=u}}function JE(i){return ye(i)&&i.name==="AuthApiError"}class _R extends Zh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class bn extends Zh{constructor(t,r,u,o){super(t,u,o),this.name=r,this.status=u}}class Pn extends bn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function GE(i){return ye(i)&&i.name==="AuthSessionMissingError"}class Rp extends bn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pl extends bn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class _l extends bn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function QE(i){return ye(i)&&i.name==="AuthImplicitGrantRedirectError"}class sm extends bn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nh extends bn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Pp(i){return ye(i)&&i.name==="AuthRetryableFetchError"}class om extends bn{constructor(t,r,u){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=u}}class uu extends bn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const am="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cm=` 	
\r=`.split(""),YE=(()=>{const i=new Array(128);for(let t=0;t<i.length;t+=1)i[t]=-1;for(let t=0;t<cm.length;t+=1)i[cm[t].charCodeAt(0)]=-2;for(let t=0;t<am.length;t+=1)i[am[t].charCodeAt(0)]=t;return i})();function ER(i,t,r){const u=YE[i];if(u>-1)for(t.queue=t.queue<<6|u,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(u===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function um(i){const t=[],r=a=>{t.push(String.fromCodePoint(a))},u={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},c=a=>{eT(a,u,r)};for(let a=0;a<i.length;a+=1)ER(i.charCodeAt(a),o,c);return t.join("")}function XE(i,t){if(i<=127){t(i);return}else if(i<=2047){t(192|i>>6),t(128|i&63);return}else if(i<=65535){t(224|i>>12),t(128|i>>6&63),t(128|i&63);return}else if(i<=1114111){t(240|i>>18),t(128|i>>12&63),t(128|i>>6&63),t(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function ZE(i,t){for(let r=0;r<i.length;r+=1){let u=i.charCodeAt(r);if(u>55295&&u<=56319){const o=(u-55296)*1024&65535;u=(i.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}XE(u,t)}}function eT(i,t,r){if(t.utf8seq===0){if(i<=127){r(i);return}for(let u=1;u<6;u+=1)if((i>>7-u&1)===0){t.utf8seq=u;break}if(t.utf8seq===2)t.codepoint=i&31;else if(t.utf8seq===3)t.codepoint=i&15;else if(t.utf8seq===4)t.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|i&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function tT(i){const t=[],r={queue:0,queuedBits:0},u=o=>{t.push(o)};for(let o=0;o<i.length;o+=1)ER(i.charCodeAt(o),r,u);return new Uint8Array(t)}function rT(i){const t=[];return ZE(i,r=>t.push(r)),new Uint8Array(t)}function nT(i){return Math.round(Date.now()/1e3)+i}function iT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=Math.random()*16|0;return(i=="x"?t:t&3|8).toString(16)})}const _r=()=>typeof window<"u"&&typeof document<"u",Gn={tested:!1,writable:!1},lu=()=>{if(!_r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Gn.tested)return Gn.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Gn.tested=!0,Gn.writable=!0}catch{Gn.tested=!0,Gn.writable=!1}return Gn.writable};function sT(i){const t={},r=new URL(i);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,c)=>{t[c]=o})}catch{}return r.searchParams.forEach((u,o)=>{t[o]=u}),t}const TR=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...r)=>ps(async()=>{const{default:u}=await Promise.resolve().then(()=>fs);return{default:u}},void 0).then(({default:u})=>u(...r)):t=fetch,(...r)=>t(...r)},oT=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",IR=async(i,t,r)=>{await i.setItem(t,JSON.stringify(r))},El=async(i,t)=>{const r=await i.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Tl=async(i,t)=>{await i.removeItem(t)};class Ol{constructor(){this.promise=new Ol.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ol.promiseConstructor=Promise;function _p(i){const t=i.split(".");if(t.length!==3)throw new uu("Invalid JWT structure");for(let u=0;u<t.length;u++)if(!HE.test(t[u]))throw new uu("JWT not in base64url format");return{header:JSON.parse(um(t[0])),payload:JSON.parse(um(t[1])),signature:tT(t[2]),raw:{header:t[0],payload:t[1]}}}async function aT(i){return await new Promise(t=>{setTimeout(()=>t(null),i)})}function cT(i,t){return new Promise((u,o)=>{(async()=>{for(let c=0;c<1/0;c++)try{const a=await i(c);if(!t(c,null,a)){u(a);return}}catch(a){if(!t(c,a)){o(a);return}}})()})}function uT(i){return("0"+i.toString(16)).substr(-2)}function lT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",u=r.length;let o="";for(let c=0;c<56;c++)o+=r.charAt(Math.floor(Math.random()*u));return o}return crypto.getRandomValues(t),Array.from(t,uT).join("")}async function dT(i){const r=new TextEncoder().encode(i),u=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(u);return Array.from(o).map(c=>String.fromCharCode(c)).join("")}async function pT(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const r=await dT(i);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function as(i,t,r=!1){const u=lT();let o=u;r&&(o+="/PASSWORD_RECOVERY"),await IR(i,`${t}-code-verifier`,o);const c=await pT(u);return[c,u===c?"plain":"s256"]}const hT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fT(i){const t=i.headers.get(jh);if(!t||!t.match(hT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function vT(i){if(!i)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(i<=t)throw new Error("JWT has expired")}function gT(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var mT=function(i,t){var r={};for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&t.indexOf(u)<0&&(r[u]=i[u]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,u=Object.getOwnPropertySymbols(i);o<u.length;o++)t.indexOf(u[o])<0&&Object.prototype.propertyIsEnumerable.call(i,u[o])&&(r[u[o]]=i[u[o]]);return r};const Si=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),yT=[502,503,504];async function lm(i){var t;if(!oT(i))throw new Nh(Si(i),0);if(yT.includes(i.status))throw new Nh(Si(i),i.status);let r;try{r=await i.json()}catch(c){throw new _R(Si(c),c)}let u;const o=fT(i);if(o&&o.getTime()>=PR["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?u=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(u=r.error_code),u){if(u==="weak_password")throw new om(Si(r),i.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(u==="session_not_found")throw new Pn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((c,a)=>c&&typeof a=="string",!0))throw new om(Si(r),i.status,r.weak_password.reasons);throw new KE(Si(r),i.status||500,u)}const ST=(i,t,r,u)=>{const o={method:i,headers:(t==null?void 0:t.headers)||{}};return i==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),o.body=JSON.stringify(u),Object.assign(Object.assign({},o),r))};async function Pe(i,t,r,u){var o;const c=Object.assign({},u==null?void 0:u.headers);c[jh]||(c[jh]=PR["2024-01-01"].name),u!=null&&u.jwt&&(c.Authorization=`Bearer ${u.jwt}`);const a=(o=u==null?void 0:u.query)!==null&&o!==void 0?o:{};u!=null&&u.redirectTo&&(a.redirect_to=u.redirectTo);const s=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await CT(i,t,r+s,{headers:c,noResolveJson:u==null?void 0:u.noResolveJson},{},u==null?void 0:u.body);return u!=null&&u.xform?u==null?void 0:u.xform(l):{data:Object.assign({},l),error:null}}async function CT(i,t,r,u,o,c){const a=ST(t,u,o,c);let s;try{s=await i(r,Object.assign({},a))}catch(l){throw console.error(l),new Nh(Si(l),0)}if(s.ok||await lm(s),u!=null&&u.noResolveJson)return s;try{return await s.json()}catch(l){await lm(l)}}function _n(i){var t;let r=null;_T(i)&&(r=Object.assign({},i),i.expires_at||(r.expires_at=nT(i.expires_in)));const u=(t=i.user)!==null&&t!==void 0?t:i;return{data:{session:r,user:u},error:null}}function dm(i){const t=_n(i);return!t.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((r,u)=>r&&typeof u=="string",!0)&&(t.data.weak_password=i.weak_password),t}function An(i){var t;return{data:{user:(t=i.user)!==null&&t!==void 0?t:i},error:null}}function wT(i){return{data:i,error:null}}function RT(i){const{action_link:t,email_otp:r,hashed_token:u,redirect_to:o,verification_type:c}=i,a=mT(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),s={action_link:t,email_otp:r,hashed_token:u,redirect_to:o,verification_type:c},l=Object.assign({},a);return{data:{properties:s,user:l},error:null}}function PT(i){return i}function _T(i){return i.access_token&&i.refresh_token&&i.expires_in}var ET=function(i,t){var r={};for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&t.indexOf(u)<0&&(r[u]=i[u]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,u=Object.getOwnPropertySymbols(i);o<u.length;o++)t.indexOf(u[o])<0&&Object.prototype.propertyIsEnumerable.call(i,u[o])&&(r[u[o]]=i[u[o]]);return r};class TT{constructor({url:t="",headers:r={},fetch:u}){this.url=t,this.headers=r,this.fetch=TR(u),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Pe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(u){if(ye(u))return{data:null,error:u};throw u}}async inviteUserByEmail(t,r={}){try{return await Pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:An})}catch(u){if(ye(u))return{data:{user:null},error:u};throw u}}async generateLink(t){try{const{options:r}=t,u=ET(t,["options"]),o=Object.assign(Object.assign({},u),r);return"newEmail"in u&&(o.new_email=u==null?void 0:u.newEmail,delete o.newEmail),await Pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:RT,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ye(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Pe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:An})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,u,o,c,a,s,l;try{const p={nextPage:null,lastPage:0,total:0},h=await Pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(u=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&u!==void 0?u:"",per_page:(c=(o=t==null?void 0:t.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:PT});if(h.error)throw h.error;const v=await h.json(),g=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(s=h.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(w=>{const C=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);p[`${R}Page`]=C}),p.total=parseInt(g)),{data:Object.assign(Object.assign({},v),p),error:null}}catch(p){if(ye(p))return{data:{users:[]},error:p};throw p}}async getUserById(t){try{return await Pe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:An})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Pe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:An})}catch(u){if(ye(u))return{data:{user:null},error:u};throw u}}async deleteUser(t,r=!1){try{return await Pe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:An})}catch(u){if(ye(u))return{data:{user:null},error:u};throw u}}async _listFactors(t){try{const{data:r,error:u}=await Pe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:u}}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Pe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ye(r))return{data:null,error:r};throw r}}}const IT={getItem:i=>lu()?globalThis.localStorage.getItem(i):null,setItem:(i,t)=>{lu()&&globalThis.localStorage.setItem(i,t)},removeItem:i=>{lu()&&globalThis.localStorage.removeItem(i)}};function pm(i={}){return{getItem:t=>i[t]||null,setItem:(t,r)=>{i[t]=r},removeItem:t=>{delete i[t]}}}function AT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const cs={debug:!!(globalThis&&lu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class AR extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class bT extends AR{}async function kT(i,t,r){cs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,t);const u=new globalThis.AbortController;return t>0&&setTimeout(()=>{u.abort(),cs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:u.signal},async o=>{if(o){cs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,o.name);try{return await r()}finally{cs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,o.name)}}else{if(t===0)throw cs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new bT(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(cs.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}AT();const OT={url:UE,storageKey:$E,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:WE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hm(i,t,r){return await r()}class du{constructor(t){var r,u;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=du.nextInstanceID,du.nextInstanceID+=1,this.instanceID>0&&_r()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},OT),t);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new TT({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=TR(o.fetch),this.lock=o.lock||hm,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:_r()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=kT:this.lock=hm,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:lu()?this.storage=IT:(this.memoryStorage={},this.storage=pm(this.memoryStorage)):(this.memoryStorage={},this.storage=pm(this.memoryStorage)),_r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${RR}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=sT(window.location.href);let u="none";if(this._isImplicitGrantCallback(r)?u="implicit":await this._isPKCECallback(r)&&(u="pkce"),_r()&&this.detectSessionInUrl&&u!=="none"){const{data:o,error:c}=await this._getSessionFromURL(r,u);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),QE(c)){const l=(t=c.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:a,redirectType:s}=o;return this._debug("#_initialize()","detected session in URL",a,"redirect type",s),await this._saveSession(a),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ye(r)?{error:r}:{error:new _R("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,u,o;try{const c=await Pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(u=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&u!==void 0?u:{},gotrue_meta_security:{captcha_token:(o=t==null?void 0:t.options)===null||o===void 0?void 0:o.captchaToken}},xform:_n}),{data:a,error:s}=c;if(s||!a)return{data:{user:null,session:null},error:s};const l=a.session,p=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:p,session:l},error:null}}catch(c){if(ye(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(t){var r,u,o;try{let c;if("email"in t){const{email:h,password:v,options:g}=t;let m=null,w=null;this.flowType==="pkce"&&([m,w]=await as(this.storage,this.storageKey)),c=await Pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:h,password:v,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:w},xform:_n})}else if("phone"in t){const{phone:h,password:v,options:g}=t;c=await Pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:v,data:(u=g==null?void 0:g.data)!==null&&u!==void 0?u:{},channel:(o=g==null?void 0:g.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:_n})}else throw new Pl("You must provide either an email or phone number and a password");const{data:a,error:s}=c;if(s||!a)return{data:{user:null,session:null},error:s};const l=a.session,p=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:p,session:l},error:null}}catch(c){if(ye(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(t){try{let r;if("email"in t){const{email:c,password:a,options:s}=t;r=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:dm})}else if("phone"in t){const{phone:c,password:a,options:s}=t;r=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:dm})}else throw new Pl("You must provide either an email or phone number and a password");const{data:u,error:o}=r;return o?{data:{user:null,session:null},error:o}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Rp}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:Object.assign({user:u.user,session:u.session},u.weak_password?{weakPassword:u.weak_password}:null),error:o})}catch(r){if(ye(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,u,o,c;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(c=t.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await El(this.storage,`${this.storageKey}-code-verifier`),[u,o]=(r??"").split("/");try{const{data:c,error:a}=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:u},xform:_n});if(await Tl(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new Rp}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:o??null}),error:a})}catch(c){if(ye(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(t){try{const{options:r,provider:u,token:o,access_token:c,nonce:a}=t,s=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:u,id_token:o,access_token:c,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:_n}),{data:l,error:p}=s;return p?{data:{user:null,session:null},error:p}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Rp}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:p})}catch(r){if(ye(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,u,o,c,a;try{if("email"in t){const{email:s,options:l}=t;let p=null,h=null;this.flowType==="pkce"&&([p,h]=await as(this.storage,this.storageKey));const{error:v}=await Pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(u=l==null?void 0:l.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:p,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in t){const{phone:s,options:l}=t,{data:p,error:h}=await Pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:s,data:(o=l==null?void 0:l.data)!==null&&o!==void 0?o:{},create_user:(c=l==null?void 0:l.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:p==null?void 0:p.message_id},error:h}}throw new Pl("You must provide either an email or phone number.")}catch(s){if(ye(s))return{data:{user:null,session:null},error:s};throw s}}async verifyOtp(t){var r,u;try{let o,c;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,c=(u=t.options)===null||u===void 0?void 0:u.captchaToken);const{data:a,error:s}=await Pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:c}}),redirectTo:o,xform:_n});if(s)throw s;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,p=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:p,session:l},error:null}}catch(o){if(ye(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(t){var r,u,o;try{let c=null,a=null;return this.flowType==="pkce"&&([c,a]=await as(this.storage,this.storageKey)),await Pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(u=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&u!==void 0?u:void 0}),!((o=t==null?void 0:t.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:a}),headers:this.headers,xform:wT})}catch(c){if(ye(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:u}=t;if(u)throw u;if(!r)throw new Pn;const{error:o}=await Pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(t){if(ye(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:u,type:o,options:c}=t,{error:a}=await Pe(this.fetch,"POST",r,{headers:this.headers,body:{email:u,type:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:u,type:o,options:c}=t,{data:a,error:s}=await Pe(this.fetch,"POST",r,{headers:this.headers,body:{phone:u,type:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:s}}throw new Pl("You must provide either an email or phone number and a type")}catch(r){if(ye(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const u=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await u,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const u=r();for(this.pendingInLock.push((async()=>{try{await u}catch{}})()),await u;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await u}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await El(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const u=t.expires_at?t.expires_at*1e3-Date.now()<wp:!1;if(this._debug("#__loadSession()",`session has${u?"":" not"} expired`,"expires_at",t.expires_at),!u){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,p,h)=>(!a&&p==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,p,h))})}return{data:{session:t},error:null}}const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{session:null},error:c}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:An}):await this._useSession(async r=>{var u,o,c;const{data:a,error:s}=r;if(s)throw s;return!(!((u=a.session)===null||u===void 0)&&u.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pn}:await Pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(o=a.session)===null||o===void 0?void 0:o.access_token)!==null&&c!==void 0?c:void 0,xform:An})})}catch(r){if(ye(r))return GE(r)&&(await this._removeSession(),await Tl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async u=>{const{data:o,error:c}=u;if(c)throw c;if(!o.session)throw new Pn;const a=o.session;let s=null,l=null;this.flowType==="pkce"&&t.email!=null&&([s,l]=await as(this.storage,this.storageKey));const{data:p,error:h}=await Pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:s,code_challenge_method:l}),jwt:a.access_token,xform:An});if(h)throw h;return a.user=p.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(u){if(ye(u))return{data:{user:null},error:u};throw u}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Pn;const r=Date.now()/1e3;let u=r,o=!0,c=null;const{payload:a}=_p(t.access_token);if(a.exp&&(u=a.exp,o=u<=r),o){const{session:s,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!s)return{data:{user:null,session:null},error:null};c=s}else{const{data:s,error:l}=await this._getUser(t.access_token);if(l)throw l;c={access_token:t.access_token,refresh_token:t.refresh_token,user:s.user,token_type:"bearer",expires_in:u-r,expires_at:u},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(r){if(ye(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var u;if(!t){const{data:a,error:s}=r;if(s)throw s;t=(u=a.session)!==null&&u!==void 0?u:void 0}if(!(t!=null&&t.refresh_token))throw new Pn;const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{user:null,session:null},error:c}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ye(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!_r())throw new _l("No browser detected.");if(t.error||t.error_description||t.error_code)throw new _l(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _l("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new sm("No code detected.");const{data:E,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:u,provider_refresh_token:o,access_token:c,refresh_token:a,expires_in:s,expires_at:l,token_type:p}=t;if(!c||!s||!a||!p)throw new _l("No session defined in URL");const h=Math.round(Date.now()/1e3),v=parseInt(s);let g=h+v;l&&(g=parseInt(l));const m=g-h;m*1e3<=ls&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${v}s`);const w=g-v;h-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,g,h):h-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,g,h);const{data:C,error:R}=await this._getUser(c);if(R)throw R;const _={provider_token:u,provider_refresh_token:o,access_token:c,expires_in:v,expires_at:g,refresh_token:a,token_type:p,user:C.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(u){if(ye(u))return{data:{session:null,redirectType:null},error:u};throw u}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await El(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var u;const{data:o,error:c}=r;if(c)return{error:c};const a=(u=o.session)===null||u===void 0?void 0:u.access_token;if(a){const{error:s}=await this.admin.signOut(a,t);if(s&&!(JE(s)&&(s.status===404||s.status===401||s.status===403)))return{error:s}}return t!=="others"&&(await this._removeSession(),await Tl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=iT(),u={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,u),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:u}}}async _emitInitialSession(t){return await this._useSession(async r=>{var u,o;try{const{data:{session:c},error:a}=r;if(a)throw a;await((u=this.stateChangeEmitters.get(t))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",t,"session",c)}catch(c){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",c),console.error(c)}})}async resetPasswordForEmail(t,r={}){let u=null,o=null;this.flowType==="pkce"&&([u,o]=await as(this.storage,this.storageKey,!0));try{return await Pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:u,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(c){if(ye(c))return{data:null,error:c};throw c}}async getUserIdentities(){var t;try{const{data:r,error:u}=await this.getUser();if(u)throw u;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ye(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:u,error:o}=await this._useSession(async c=>{var a,s,l,p,h;const{data:v,error:g}=c;if(g)throw g;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Pe(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(p=v.session)===null||p===void 0?void 0:p.access_token)!==null&&h!==void 0?h:void 0})});if(o)throw o;return _r()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(u==null?void 0:u.url),{data:{provider:t.provider,url:u==null?void 0:u.url},error:null}}catch(u){if(ye(u))return{data:{provider:t.provider,url:null},error:u};throw u}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var u,o;const{data:c,error:a}=r;if(a)throw a;return await Pe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(u=c.session)===null||u===void 0?void 0:u.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const u=Date.now();return await cT(async o=>(o>0&&await aT(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await Pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:_n})),(o,c)=>{const a=200*Math.pow(2,o);return c&&Pp(c)&&Date.now()+a-u<ls})}catch(u){if(this._debug(r,"error",u),ye(u))return{data:{session:null,user:null},error:u};throw u}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const u=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",u),_r()&&!r.skipBrowserRedirect&&window.location.assign(u),{data:{provider:t,url:u},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const u=await El(this.storage,this.storageKey);if(this._debug(r,"session from storage",u),!this._isValidSession(u)){this._debug(r,"session is not valid"),u!==null&&await this._removeSession();return}const o=((t=u.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<wp;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${wp}s`),o){if(this.autoRefreshToken&&u.refresh_token){const{error:c}=await this._callRefreshToken(u.refresh_token);c&&(console.error(c),Pp(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(r,"error",u),console.error(u);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,u;if(!t)throw new Pn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Ol;const{data:c,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!c.session)throw new Pn;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const s={session:c.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(c){if(this._debug(o,"error",c),ye(c)){const a={session:null,error:c};return Pp(c)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(u=this.refreshingDeferred)===null||u===void 0||u.reject(c),c}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,u=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${u}`);try{this.broadcastChannel&&u&&this.broadcastChannel.postMessage({event:t,session:r});const c=[],a=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(t,r)}catch(l){c.push(l)}});if(await Promise.all(a),c.length>0){for(let s=0;s<c.length;s+=1)console.error(c[s]);throw c[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await IR(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Tl(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_r()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ls);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:u}}=r;if(!u||!u.refresh_token||!u.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((u.expires_at*1e3-t)/ls);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${ls}ms, refresh threshold is ${Dh} ticks`),o<=Dh&&await this._callRefreshToken(u.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof AR)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_r()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,u){const o=[`provider=${encodeURIComponent(r)}`];if(u!=null&&u.redirectTo&&o.push(`redirect_to=${encodeURIComponent(u.redirectTo)}`),u!=null&&u.scopes&&o.push(`scopes=${encodeURIComponent(u.scopes)}`),this.flowType==="pkce"){const[c,a]=await as(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(a)}`});o.push(s.toString())}if(u!=null&&u.queryParams){const c=new URLSearchParams(u.queryParams);o.push(c.toString())}return u!=null&&u.skipBrowserRedirect&&o.push(`skip_http_redirect=${u.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var u;const{data:o,error:c}=r;return c?{data:null,error:c}:await Pe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(u=o==null?void 0:o.session)===null||u===void 0?void 0:u.access_token})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var u,o;const{data:c,error:a}=r;if(a)return{data:null,error:a};const s=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:p}=await Pe(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:(u=c==null?void 0:c.session)===null||u===void 0?void 0:u.access_token});return p?{data:null,error:p}:(t.factorType==="totp"&&(!((o=l==null?void 0:l.totp)===null||o===void 0)&&o.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var u;const{data:o,error:c}=r;if(c)return{data:null,error:c};const{data:a,error:s}=await Pe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(u=o==null?void 0:o.session)===null||u===void 0?void 0:u.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:s})})}catch(r){if(ye(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var u;const{data:o,error:c}=r;return c?{data:null,error:c}:await Pe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(u=o==null?void 0:o.session)===null||u===void 0?void 0:u.access_token})})}catch(r){if(ye(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:u}=await this._challenge({factorId:t.factorId});return u?{data:null,error:u}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const u=(t==null?void 0:t.factors)||[],o=u.filter(a=>a.factor_type==="totp"&&a.status==="verified"),c=u.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:u,totp:o,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,u;const{data:{session:o},error:c}=t;if(c)return{data:null,error:c};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=_p(o.access_token);let s=null;a.aal&&(s=a.aal);let l=s;((u=(r=o.user.factors)===null||r===void 0?void 0:r.filter(v=>v.status==="verified"))!==null&&u!==void 0?u:[]).length>0&&(l="aal2");const h=a.amr||[];return{data:{currentLevel:s,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(t,r={keys:[]}){let u=r.keys.find(a=>a.kid===t);if(u||(u=this.jwks.keys.find(a=>a.kid===t),u&&this.jwks_cached_at+VE>Date.now()))return u;const{data:o,error:c}=await Pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;if(!o.keys||o.keys.length===0)throw new uu("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),u=o.keys.find(a=>a.kid===t),!u)throw new uu("No matching signing key found in JWKS");return u}async getClaims(t,r={keys:[]}){try{let u=t;if(!u){const{data:m,error:w}=await this.getSession();if(w||!m.session)return{data:null,error:w};u=m.session.access_token}const{header:o,payload:c,signature:a,raw:{header:s,payload:l}}=_p(u);if(vT(c.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(u);if(m)throw m;return{data:{claims:c,header:o,signature:a},error:null}}const p=gT(o.alg),h=await this.fetchJwk(o.kid,r),v=await crypto.subtle.importKey("jwk",h,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,a,rT(`${s}.${l}`)))throw new uu("Invalid JWT signature");return{data:{claims:c,header:o,signature:a},error:null}}catch(u){if(ye(u))return{data:null,error:u};throw u}}}du.nextInstanceID=0;const MT=du;class xT extends MT{constructor(t){super(t)}}var DT=function(i,t,r,u){function o(c){return c instanceof r?c:new r(function(a){a(c)})}return new(r||(r=Promise))(function(c,a){function s(h){try{p(u.next(h))}catch(v){a(v)}}function l(h){try{p(u.throw(h))}catch(v){a(v)}}function p(h){h.done?c(h.value):o(h.value).then(s,l)}p((u=u.apply(i,t||[])).next())})};class jT{constructor(t,r,u){var o,c,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const s=BE(t);this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,this.functionsUrl=`${s}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,p={db:ME,realtime:DE,auth:Object.assign(Object.assign({},xE),{storageKey:l}),global:OE},h=FE(u??{},p);this.storageKey=(o=h.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(c=h.global.headers)!==null&&c!==void 0?c:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(v,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=LE(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Z_(`${s}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new F_(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new AE(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},u={}){return this.rest.rpc(t,r,u)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return DT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:u}=yield this.auth.getSession();return(r=(t=u.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:u,storage:o,storageKey:c,flowType:a,lock:s,debug:l},p,h){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xT({url:this.authUrl,headers:Object.assign(Object.assign({},v),p),storageKey:c,autoRefreshToken:t,persistSession:r,detectSessionInUrl:u,storage:o,flowType:a,lock:s,debug:l,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new fE(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,u)=>{this._handleTokenChanged(r,"CLIENT",u==null?void 0:u.access_token)})}_handleTokenChanged(t,r,u){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==u?this.changedAccessToken=u:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const NT=(i,t,r)=>new jT(i,t,r),zT="https://xvtjeyukupiedmlgvdxj.supabase.co",LT="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2dGpleXVrdXBpZWRtbGd2ZHhqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjM0NzAzOSwiZXhwIjoyMDYxOTIzMDM5fQ.rmQc9BE-1ooyEiyV9tyCqSqRo-TTkHP18euWmZfKxFc",be=NT(zT,LT);function qT(){const i=async()=>{const{error:t}=await be.auth.signInWithOAuth({provider:"google"});t&&console.error("Login error:",t.message)};return A.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 px-4",children:[A.jsx("h1",{className:"text-4xl font-bold text-blue-600 mb-12",children:"Basabisa"}),A.jsx("div",{className:"mt-4",children:A.jsxs("button",{onClick:i,className:"flex items-center justify-center w-64 bg-white text-gray-700 font-medium py-2 px-4 border border-gray-300 rounded hover:bg-gray-50 transition-all",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"w-5 h-5 mr-3",children:[A.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),A.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),A.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),A.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]})})]})}function bR({isOpen:i,onClose:t,onConfirm:r,message:u="Apakah Anda yakin ingin menghapus ini?"}){return i?A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:A.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full p-6",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Delete chat? ?"}),A.jsx("p",{className:"mt-2 text-sm text-gray-600",children:u}),A.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[A.jsx("button",{onClick:t,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-md",children:"Cancel"}),A.jsx("button",{onClick:r,className:"px-4 py-2 text-sm bg-red-500 text-white hover:bg-red-600 rounded-md",children:"Delete"})]})]})}):null}function BT({threads:i,selectedThreadId:t,onSelectThread:r,onCreateNew:u,onDeleteThread:o,onRenameThread:c,onLogout:a,currentUser:s}){var pe,Ce;const[l,p]=Q.useState(!1),[h,v]=Q.useState(!1),[g,m]=Q.useState(null),[w,C]=Q.useState(null),[R,_]=Q.useState(""),[E,T]=Q.useState(null),D=Q.useRef(null),N=Q.useRef(null);Q.useEffect(()=>{const ae=se=>{D.current&&!D.current.contains(se.target)&&m(null)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[]),Q.useEffect(()=>{w&&N.current&&(N.current.focus(),N.current.select())},[w]);const H=ae=>{T(ae)},ie=ae=>{C(ae.id),_(ae.title||"Untitled"),m(null)},Y=async ae=>{ae.preventDefault(),w&&(c(w,R),C(null),_(""))},Ie=()=>{C(null),_("")},De=ae=>{const se={Today:[],Yesterday:[],"Last 7 Days":[],Older:[]},$=["January","February","March","April","May","June","July","August","September","October","November","December"],ee=new Date,V=new Date(ee);return V.setDate(V.getDate()-1),ae.forEach(O=>{const L=new Date(O.updated_at||O.created_at),ce=Math.floor((ee-L)/(1e3*60*60*24)),fe=L.toDateString()===ee.toDateString(),Se=L.toDateString()===V.toDateString();if(fe)se.Today.push(O);else if(Se)se.Yesterday.push(O);else if(ce<7)se["Last 7 Days"].push(O);else if(ce<90){const me=`${$[L.getMonth()]} ${L.getFullYear()}`;se[me]=(se[me]||[]).concat(O)}else se.Older=(se.Older||[]).concat(O)}),se},[Xe,Be]=Q.useState({});Q.useEffect(()=>{const ae=De(i);Be(ae)},[i]);const Ee=ae=>w===ae.id?A.jsx("form",{onSubmit:Y,className:"w-full",children:A.jsxs("div",{className:"flex items-center px-2",children:[A.jsx("input",{ref:N,type:"text",value:R,onChange:se=>_(se.target.value),className:"flex-1 px-2 py-2 border border-blue-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",onBlur:Y}),A.jsx("button",{type:"submit",className:"ml-1 p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:A.jsx("polyline",{points:"20 6 9 17 4 12"})})}),A.jsx("button",{type:"button",onClick:Ie,className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Cancel",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}):A.jsxs("div",{className:"flex items-center w-full",children:[A.jsx("button",{onClick:()=>r(ae.id),onDoubleClick:()=>ie(ae),className:`flex-1 text-left px-3 py-2 rounded-lg truncate hover:bg-gray-100 ${t===ae.id?"bg-blue-50 text-blue-600":""}`,children:ae.title||"Untitled"}),A.jsxs("div",{className:"relative",children:[A.jsx("button",{onClick:se=>{se.stopPropagation(),m(g===ae.id?null:ae.id)},className:"p-1.5 rounded-full hover:bg-gray-200 text-gray-500",title:"Thread options",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("circle",{cx:"12",cy:"12",r:"1"}),A.jsx("circle",{cx:"12",cy:"5",r:"1"}),A.jsx("circle",{cx:"12",cy:"19",r:"1"})]})}),g===ae.id&&A.jsxs("div",{ref:D,className:"absolute right-0 z-10 mt-1 bg-white rounded-md shadow-lg py-1 w-40 border border-gray-200",children:[A.jsxs("button",{onClick:()=>ie(ae),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[A.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),A.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Rename"]}),A.jsxs("button",{onClick:()=>H(ae.id),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[A.jsx("polyline",{points:"3 6 5 6 21 6"}),A.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),A.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),A.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"Delete"]})]})]})]});return A.jsxs("div",{className:`bg-white border-r border-gray-200 overflow-y-auto transition-all duration-300 ease-in-out h-full flex flex-col ${h?"w-16 p-2":"w-64 p-4"}`,children:[!h&&A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h2",{className:"text-xl font-bold text-blue-600",children:"Basabisa"}),A.jsx("button",{onClick:()=>v(!0),className:"p-1.5 rounded-md hover:bg-gray-100 text-gray-500 transition-colors",title:"Hide Sidebar",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:A.jsx("path",{d:"M11 17l-5-5 5-5M18 17l-5-5 5-5"})})})]}),!h&&A.jsx("div",{className:"mb-4",children:A.jsx("button",{onClick:u,className:"w-full bg-blue-500 text-white py-2 px-3 rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"+ New Chat"})}),A.jsx("div",{className:`transition-opacity duration-300 flex-1 overflow-y-auto ${h?"opacity-0 hidden":"opacity-100"}`,children:Object.entries(Xe).map(([ae,se])=>se!=null&&se.length?A.jsxs("div",{className:"mb-6",children:[A.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:ae}),A.jsx("div",{className:"space-y-1",children:se.filter($=>$.title!=="Untitled").map($=>A.jsx("div",{className:"flex items-center",children:Ee($)},$.id))})]},ae):null)}),h&&A.jsxs("div",{className:"flex flex-col items-center space-y-4 mt-4",children:[A.jsx("button",{onClick:u,className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors shadow-md",title:"New Chat",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),A.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),A.jsx("button",{onClick:()=>v(!1),className:"p-2 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors shadow-md",title:"Show Sidebar",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:A.jsx("path",{d:"M13 17l5-5-5-5M6 17l5-5-5-5"})})})]}),!h&&s&&A.jsxs("div",{className:"mt-auto pt-4 border-t",children:[A.jsxs("div",{className:"flex items-center space-x-3 text-sm relative",children:[A.jsx("img",{src:`https://ui-avatars.com/api/?name=   ${encodeURIComponent(((pe=s.email)==null?void 0:pe.split("@")[0])||"User")}`,alt:"User Avatar",className:"w-8 h-8 rounded-full"}),A.jsx("button",{onClick:()=>p(!l),className:"font-medium truncate focus:outline-none",children:((Ce=s.email)==null?void 0:Ce.split("@")[0])||"User"})]}),l&&A.jsx("div",{className:"absolute bottom-12 left-4 mb-2 w-56 border border-gray-200 z-10 bg-white shadow-md rounded-md",children:A.jsx("button",{onClick:a,className:"block w-full text-left px-4 py-2 text-red-500 hover:bg-red-50",children:"Logout"})})]}),A.jsx(bR,{isOpen:!!E,onClose:()=>T(null),onConfirm:()=>{o(E),T(null)},message:"This action will permanently delete all the chats you've created and cannot be undone. Please confirm to proceed. "})]})}function FT({isOpen:i,onClose:t,threads:r,selectedThreadId:u,onSelectThread:o,onCreateNew:c,onDeleteThread:a,onRenameThread:s,onLogout:l,currentUser:p}){var Be,Ee;const[h,v]=Q.useState(null),[g,m]=Q.useState(null),[w,C]=Q.useState(""),[R,_]=Q.useState(null),E=Q.useRef(null),T=Q.useRef(null);Q.useEffect(()=>{const pe=Ce=>{E.current&&!E.current.contains(Ce.target)&&v(null)};return document.addEventListener("mousedown",pe),()=>{document.removeEventListener("mousedown",pe)}},[]),Q.useEffect(()=>{g&&T.current&&(T.current.focus(),T.current.select())},[g]);const D=pe=>{_(pe)},N=pe=>{m(pe.id),C(pe.title||"Untitled"),v(null)},H=async pe=>{pe.preventDefault(),g&&(s(g,w),m(null),C(""))},ie=()=>{m(null),C("")},Y=pe=>{const Ce={Today:[],Yesterday:[],"Last 7 Days":[],Older:[]},ae=["January","February","March","April","May","June","July","August","September","October","November","December"],se=new Date,$=new Date(se);return $.setDate($.getDate()-1),pe.forEach(ee=>{const V=new Date(ee.updated_at||ee.created_at),O=Math.floor((se-V)/(1e3*60*60*24)),L=V.toDateString()===se.toDateString(),ce=V.toDateString()===$.toDateString();if(L)Ce.Today.push(ee);else if(ce)Ce.Yesterday.push(ee);else if(O<7)Ce["Last 7 Days"].push(ee);else if(O<90){const fe=`${ae[V.getMonth()]} ${V.getFullYear()}`;Ce[fe]=(Ce[fe]||[]).concat(ee)}else Ce.Older=(Ce.Older||[]).concat(ee)}),Ce},[Ie,De]=Q.useState({});Q.useEffect(()=>{const pe=Y(r);De(pe)},[r]);const Xe=pe=>g===pe.id?A.jsx("form",{onSubmit:H,className:"w-full",children:A.jsxs("div",{className:"flex items-center px-2",children:[A.jsx("input",{ref:T,type:"text",value:w,onChange:Ce=>C(Ce.target.value),className:"flex-1 px-3 py-3 border border-blue-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-base",onBlur:H}),A.jsx("button",{type:"submit",className:"ml-2 p-2 text-green-600 hover:bg-green-50 rounded",title:"Save",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:A.jsx("polyline",{points:"20 6 9 17 4 12"})})}),A.jsx("button",{type:"button",onClick:ie,className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Cancel",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}):A.jsxs("div",{className:"flex items-center w-full",children:[A.jsx("button",{onClick:()=>{o(pe.id),t()},onDoubleClick:()=>N(pe),className:`flex-1 text-left px-4 py-3 rounded-lg truncate hover:bg-gray-100 text-base ${u===pe.id?"bg-blue-50 text-blue-600":""}`,children:pe.title||"Untitled"}),A.jsxs("div",{className:"relative",children:[A.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),v(h===pe.id?null:pe.id)},className:"p-2 rounded-full hover:bg-gray-200 text-gray-500",title:"Thread options",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("circle",{cx:"12",cy:"12",r:"1"}),A.jsx("circle",{cx:"12",cy:"5",r:"1"}),A.jsx("circle",{cx:"12",cy:"19",r:"1"})]})}),h===pe.id&&A.jsxs("div",{ref:E,className:"absolute right-0 z-10 mt-1 bg-white rounded-md shadow-lg py-2 w-48 border border-gray-200",children:[A.jsxs("button",{onClick:()=>N(pe),className:"w-full text-left px-4 py-3 text-base text-gray-700 hover:bg-gray-100 flex items-center",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-3",children:[A.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),A.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Rename"]}),A.jsxs("button",{onClick:()=>D(pe.id),className:"w-full text-left px-4 py-3 text-base text-red-600 hover:bg-red-50 flex items-center",children:[A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-3",children:[A.jsx("polyline",{points:"3 6 5 6 21 6"}),A.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),A.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),A.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"Delete"]})]})]})]});return i?A.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50",children:A.jsxs("div",{className:"absolute inset-y-0 left-0 w-full md:w-64 bg-white shadow-xl flex flex-col",children:[A.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[A.jsx("h2",{className:"text-xl font-bold text-blue-600",children:"Basabisa"}),A.jsx("button",{onClick:t,className:"p-2.5 rounded-md hover:bg-gray-100 text-gray-500",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsx("div",{className:"p-4",children:A.jsx("button",{onClick:()=>{c(),t()},className:"w-full bg-blue-500 text-white py-3 px-4 rounded-lg hover:bg-blue-600 transition-colors text-base font-medium",children:"+ New Chat"})}),A.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:Object.entries(Ie).map(([pe,Ce])=>{const ae=Ce.filter(se=>se.title!=="Untitled");return ae!=null&&ae.length?A.jsxs("div",{className:"mb-6",children:[A.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:pe}),A.jsx("div",{className:"space-y-1",children:ae.map(se=>A.jsx("div",{className:"flex items-center",children:Xe(se)},se.id))})]},pe):null})}),p&&A.jsx("div",{className:"p-5 border-t",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(((Be=p.email)==null?void 0:Be.split("@")[0])||"User")}`,alt:"User Avatar",className:"w-10 h-10 rounded-full"}),A.jsx("span",{className:"font-medium text-base",children:((Ee=p.email)==null?void 0:Ee.split("@")[0])||"User"})]}),A.jsx("button",{onClick:l,className:"text-base text-red-500 py-2 px-3 rounded-md hover:bg-red-50",children:"Logout"})]})}),A.jsx(bR,{isOpen:!!R,onClose:()=>_(null),onConfirm:()=>{a(R),_(null)},message:"This action will permanently delete all the chats you've created and cannot be undone. Please confirm to proceed. "})]})}):null}let Er=null,Tr=null,qe=!1,Ep=null;function UT(){if(!Er||Er.state==="closed")try{Er=new(window.AudioContext||window.webkitAudioContext),console.log(`Created new AudioContext, state: ${Er.state}`)}catch(i){throw console.error("Failed to create AudioContext:",i),new Error("Browser audio playback not supported")}return Er.state==="suspended"&&(console.log("Attempting to resume suspended AudioContext"),Er.resume().catch(i=>{console.warn("Failed to resume AudioContext:",i)})),Er}function $T(i){if(!i||typeof i!="string")return"";let t=i.trim();const r=300;return t=(t.match(/[^.!?]+[.!?]+/g)||[t]).map(o=>o.length>r?o.replace(/(\s*,\s*|\s*;\s*|\s*-\s*|\s*\s*|\s*\s*)(?=[a-zA-Z])/g,". ").replace(/(\w+):(\s*\d+\.\s+)/g,"$1. $2").replace(/(\d+)\.(\s*\w+)\s*\(([^\)]+)\):/g,"$1. $2 ($3)").replace(/:/g,"."):o).join(" "),t=t.replace(/(\w+):(\s*\d+\.\s+)/g,"$1. $2").replace(/(\d+)\.(\s*\w+)\s*\(([^\)]+)\):/g,"$1. $2 ($3)").replace(/:/g,".").replace(/\s{2,}/g," "),t}async function WT(i,t="en-US"){if(qe&&Ep&&(console.log("TTS already active, stopping previous playback"),await zh()),!i||i.trim()==="")return console.warn("TTS: Empty text provided"),Promise.resolve();const r=$T(i);console.log(`Processing text for TTS (${t}): ${r.substring(0,50)}...`);const u="http://192.168.0.198:3000/api/tts/speak",o=HT(r),c=[];let a=0;qe=!0;let s=0;const l=2;return Ep=new Promise(async(p,h)=>{let v;try{v=UT(),console.log(`Using AudioContext in state: ${v.state}`)}catch(R){console.error("Failed to get AudioContext:",R),qe=!1,h(R);return}if(v.state==="suspended")try{console.log("Attempting to resume AudioContext..."),await v.resume(),console.log("AudioContext resumed successfully")}catch(R){console.warn("Could not resume AudioContext:",R)}async function g(){let R=0;for(;s<o.length&&s<a+l&&qe;){const _=o[s];if(!_||!_.trim()){s++;continue}try{console.log(`Prefetching chunk ${s}: ${_.substring(0,30)}...`);const E=await m(_,t);E&&(c.push({index:s,buffer:E}),console.log(`Added chunk ${s} to queue (queue length: ${c.length})`),R++)}catch(E){if(console.error(`Failed to prefetch chunk ${s}:`,E),o.length>1)console.warn(`Skipping problematic chunk ${s}`);else if(R===0)throw E}s++}return R>0}async function m(R,_){if(!qe)return console.log("Playback canceled, aborting fetch"),null;if(v.state==="suspended")try{await v.resume(),console.log("AudioContext resumed before fetch")}catch(E){console.warn("Could not resume AudioContext:",E)}try{const E=new AbortController,T=setTimeout(()=>{E.abort(),console.warn("TTS fetch timeout after 8 seconds")},8e3);console.log(`Sending chunk to TTS backend: ${R.substring(0,50)}...`);const D=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:R,language:_}),signal:E.signal});if(clearTimeout(T),!D.ok){const H=await D.json().catch(()=>({error:"Unknown server error"}));if(console.error(`TTS request failed with status ${D.status}:`,H),D.status===400||D.status===413){console.warn("Content issue detected, trying to simplify chunk");const ie=R.replace(/[^\w\s.,?!-]/g," ").replace(/\s{2,}/g," ").trim();if(ie!==R)return await m(ie,_)}throw new Error(`TTS request failed: ${H.error||`Status ${D.status}`}`)}const N=await D.arrayBuffer();return!N||N.byteLength===0?(console.warn("Empty audio data received"),null):await v.decodeAudioData(N)}catch(E){throw E.name==="AbortError"?console.error("Fetch operation timed out"):E.message&&E.message.includes("decodeAudioData")?console.error("Failed to decode audio data:",E):console.error("TTS fetch error:",E),E}}function w(){if(!qe){console.log("Playback no longer active, stopping queue processing");return}if(!v||v.state==="closed"){console.warn("AudioContext is closed or invalid. Cannot play chunk."),qe=!1,c.length=0,p();return}if(c.length===0){a<o.length?setTimeout(()=>{qe&&a<o.length?w():a>=o.length&&(console.log("All chunks processed, playback complete"),qe=!1,p())},100):(console.log("Playback complete - no more chunks"),qe=!1,p());return}const R=c.findIndex(E=>E.index===a);if(R===-1)if(a<o.length){setTimeout(()=>{qe&&w()},100);return}else{console.log("Playback complete - no matching chunks"),qe=!1,p();return}const _=c.splice(R,1)[0];try{v.state==="suspended"?v.resume().then(()=>{qe&&C(_)}).catch(E=>{console.error("Failed to resume AudioContext:",E),a++,setTimeout(()=>{qe&&w()},100)}):C(_)}catch(E){console.error(`Error playing chunk ${_.index}:`,E),a++,setTimeout(()=>{qe&&w()},100)}}function C(R){if(Tr){try{Tr.stop(),Tr.disconnect()}catch(T){console.warn("Error cleaning up previous source:",T)}Tr=null}const _=v.createBufferSource();_.buffer=R.buffer;const E=v.createGain();E.gain.value=1,_.connect(E),E.connect(v.destination),_.onended=()=>{try{_.disconnect(),E.disconnect()}catch(T){console.warn("Error disconnecting audio nodes:",T)}if(!qe){console.log("Playback stopped externally, not continuing to next chunk");return}a++,g().catch(T=>console.error("Prefetch error:",T)),a<o.length?setTimeout(()=>{qe&&w()},10):(console.log("Playback of all chunks complete"),qe=!1,p())},Tr=_;try{_.start(0),console.log(`Playing chunk ${R.index} (chunks remaining: ${o.length-a-1})`)}catch(T){console.error("Error starting audio playback:",T),a++,setTimeout(()=>{qe&&w()},10)}}try{if(console.log(`Starting TTS playback with ${o.length} chunks`),o.length===0){console.log("No text chunks to play"),qe=!1,p();return}const R=setTimeout(()=>{console.warn("TTS: Operation timed out after 30 seconds"),qe=!1,p()},3e7);if(!await g()){console.error("No audio chunks could be fetched. Aborting playback."),qe=!1,clearTimeout(R),h(new Error("Failed to fetch any audio data"));return}w();const E=setInterval(()=>{qe||(clearInterval(E),clearTimeout(R),p())},200)}catch(R){console.error("TTS prefetch error:",R),qe=!1,h(R)}}),Ep}function zh(){return console.log("Stopping all audio playback"),qe=!1,new Promise(i=>{try{if(Tr){try{Tr.onended=null,Tr.stop(),Tr.disconnect(),console.log("Stopped current audio source")}catch(t){console.warn("Error stopping current source:",t)}Tr=null}Er&&Er.state!=="closed"?Er.suspend().then(()=>{console.log("AudioContext suspended"),i()}).catch(t=>{console.warn("Error suspending AudioContext:",t),i()}):i()}catch(t){console.error("Error in stopAllAudio:",t),i()}})}function HT(i){console.log("Original text length before splitting:",i.length);const t=100,r=180,u=[{pattern:/[.!?]\s+/g,priority:1},{pattern:/[:;]\s+/g,priority:2},{pattern:/[,]\s*/g,priority:3},{pattern:/\s+-\s+/g,priority:3.5},{pattern:/\s+/g,priority:4}],o=i.replace(/\n+/g,". ").replace(/([.!?])\s*\n/g,"$1 ").replace(/\s{2,}/g," ").trim();if(o.length<=t)return console.log("Text is short enough for a single chunk"),[o];let c=[],a=o;for(;a.length>0;){if(a.length<=r){c.push(a);break}let l=-1;for(const{pattern:h,priority:v}of u){let g=-1;const m=Array.from(a.matchAll(new RegExp(h,"g")));for(const w of m){const C=w.index+w[0].length;if(C>=t*.7&&C<=t){g=C;break}C>g&&C<r&&(g=C)}if(g>0){l=g;break}}(l===-1||l>r)&&(l=Math.min(t,a.length),console.warn("No ideal split point found, forcing split at",l));const p=a.substring(0,l).trim();p&&c.push(p),a=a.substring(l).trim()}const s=c.filter(l=>l.trim().length>0);return console.log(`Split text into ${s.length} chunks`),s}var Qn={},Yn={},eo={},Xn={},Ve={},Tp={},Zn={},Ip={},to={},Il={},fm;function kR(){if(fm)return Il;fm=1,Object.defineProperty(Il,"__esModule",{value:!0}),Il.default=r;let i;const t=new Uint8Array(16);function r(){if(!i&&(i=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(t)}return Il}var us={},ro={},no={},vm;function VT(){if(vm)return no;vm=1,Object.defineProperty(no,"__esModule",{value:!0}),no.default=void 0;var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return no.default=i,no}var gm;function Ml(){if(gm)return ro;gm=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.default=void 0;var i=t(VT());function t(o){return o&&o.__esModule?o:{default:o}}function r(o){return typeof o=="string"&&i.default.test(o)}var u=r;return ro.default=u,ro}var mm;function xl(){if(mm)return us;mm=1,Object.defineProperty(us,"__esModule",{value:!0}),us.default=void 0,us.unsafeStringify=u;var i=t(Ml());function t(a){return a&&a.__esModule?a:{default:a}}const r=[];for(let a=0;a<256;++a)r.push((a+256).toString(16).slice(1));function u(a,s=0){return r[a[s+0]]+r[a[s+1]]+r[a[s+2]]+r[a[s+3]]+"-"+r[a[s+4]]+r[a[s+5]]+"-"+r[a[s+6]]+r[a[s+7]]+"-"+r[a[s+8]]+r[a[s+9]]+"-"+r[a[s+10]]+r[a[s+11]]+r[a[s+12]]+r[a[s+13]]+r[a[s+14]]+r[a[s+15]]}function o(a,s=0){const l=u(a,s);if(!(0,i.default)(l))throw TypeError("Stringified UUID is invalid");return l}var c=o;return us.default=c,us}var ym;function KT(){if(ym)return to;ym=1,Object.defineProperty(to,"__esModule",{value:!0}),to.default=void 0;var i=r(kR()),t=xl();function r(p){return p&&p.__esModule?p:{default:p}}let u,o,c=0,a=0;function s(p,h,v){let g=h&&v||0;const m=h||new Array(16);p=p||{};let w=p.node||u,C=p.clockseq!==void 0?p.clockseq:o;if(w==null||C==null){const N=p.random||(p.rng||i.default)();w==null&&(w=u=[N[0]|1,N[1],N[2],N[3],N[4],N[5]]),C==null&&(C=o=(N[6]<<8|N[7])&16383)}let R=p.msecs!==void 0?p.msecs:Date.now(),_=p.nsecs!==void 0?p.nsecs:a+1;const E=R-c+(_-a)/1e4;if(E<0&&p.clockseq===void 0&&(C=C+1&16383),(E<0||R>c)&&p.nsecs===void 0&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=R,a=_,o=C,R+=122192928e5;const T=((R&268435455)*1e4+_)%4294967296;m[g++]=T>>>24&255,m[g++]=T>>>16&255,m[g++]=T>>>8&255,m[g++]=T&255;const D=R/4294967296*1e4&268435455;m[g++]=D>>>8&255,m[g++]=D&255,m[g++]=D>>>24&15|16,m[g++]=D>>>16&255,m[g++]=C>>>8|128,m[g++]=C&255;for(let N=0;N<6;++N)m[g+N]=w[N];return h||(0,t.unsafeStringify)(m)}var l=s;return to.default=l,to}var io={},Rn={},so={},Sm;function OR(){if(Sm)return so;Sm=1,Object.defineProperty(so,"__esModule",{value:!0}),so.default=void 0;var i=t(Ml());function t(o){return o&&o.__esModule?o:{default:o}}function r(o){if(!(0,i.default)(o))throw TypeError("Invalid UUID");let c;const a=new Uint8Array(16);return a[0]=(c=parseInt(o.slice(0,8),16))>>>24,a[1]=c>>>16&255,a[2]=c>>>8&255,a[3]=c&255,a[4]=(c=parseInt(o.slice(9,13),16))>>>8,a[5]=c&255,a[6]=(c=parseInt(o.slice(14,18),16))>>>8,a[7]=c&255,a[8]=(c=parseInt(o.slice(19,23),16))>>>8,a[9]=c&255,a[10]=(c=parseInt(o.slice(24,36),16))/1099511627776&255,a[11]=c/4294967296&255,a[12]=c>>>24&255,a[13]=c>>>16&255,a[14]=c>>>8&255,a[15]=c&255,a}var u=r;return so.default=u,so}var Cm;function MR(){if(Cm)return Rn;Cm=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.URL=Rn.DNS=void 0,Rn.default=a;var i=xl(),t=r(OR());function r(s){return s&&s.__esModule?s:{default:s}}function u(s){s=unescape(encodeURIComponent(s));const l=[];for(let p=0;p<s.length;++p)l.push(s.charCodeAt(p));return l}const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Rn.DNS=o;const c="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Rn.URL=c;function a(s,l,p){function h(v,g,m,w){var C;if(typeof v=="string"&&(v=u(v)),typeof g=="string"&&(g=(0,t.default)(g)),((C=g)===null||C===void 0?void 0:C.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let R=new Uint8Array(16+v.length);if(R.set(g),R.set(v,g.length),R=p(R),R[6]=R[6]&15|l,R[8]=R[8]&63|128,m){w=w||0;for(let _=0;_<16;++_)m[w+_]=R[_];return m}return(0,i.unsafeStringify)(R)}try{h.name=s}catch{}return h.DNS=o,h.URL=c,h}return Rn}var oo={},wm;function JT(){if(wm)return oo;wm=1,Object.defineProperty(oo,"__esModule",{value:!0}),oo.default=void 0;function i(m){if(typeof m=="string"){const w=unescape(encodeURIComponent(m));m=new Uint8Array(w.length);for(let C=0;C<w.length;++C)m[C]=w.charCodeAt(C)}return t(u(o(m),m.length*8))}function t(m){const w=[],C=m.length*32,R="0123456789abcdef";for(let _=0;_<C;_+=8){const E=m[_>>5]>>>_%32&255,T=parseInt(R.charAt(E>>>4&15)+R.charAt(E&15),16);w.push(T)}return w}function r(m){return(m+64>>>9<<4)+14+1}function u(m,w){m[w>>5]|=128<<w%32,m[r(w)-1]=w;let C=1732584193,R=-271733879,_=-1732584194,E=271733878;for(let T=0;T<m.length;T+=16){const D=C,N=R,H=_,ie=E;C=l(C,R,_,E,m[T],7,-680876936),E=l(E,C,R,_,m[T+1],12,-389564586),_=l(_,E,C,R,m[T+2],17,606105819),R=l(R,_,E,C,m[T+3],22,-1044525330),C=l(C,R,_,E,m[T+4],7,-176418897),E=l(E,C,R,_,m[T+5],12,1200080426),_=l(_,E,C,R,m[T+6],17,-1473231341),R=l(R,_,E,C,m[T+7],22,-45705983),C=l(C,R,_,E,m[T+8],7,1770035416),E=l(E,C,R,_,m[T+9],12,-1958414417),_=l(_,E,C,R,m[T+10],17,-42063),R=l(R,_,E,C,m[T+11],22,-1990404162),C=l(C,R,_,E,m[T+12],7,1804603682),E=l(E,C,R,_,m[T+13],12,-40341101),_=l(_,E,C,R,m[T+14],17,-1502002290),R=l(R,_,E,C,m[T+15],22,1236535329),C=p(C,R,_,E,m[T+1],5,-165796510),E=p(E,C,R,_,m[T+6],9,-1069501632),_=p(_,E,C,R,m[T+11],14,643717713),R=p(R,_,E,C,m[T],20,-373897302),C=p(C,R,_,E,m[T+5],5,-701558691),E=p(E,C,R,_,m[T+10],9,38016083),_=p(_,E,C,R,m[T+15],14,-660478335),R=p(R,_,E,C,m[T+4],20,-405537848),C=p(C,R,_,E,m[T+9],5,568446438),E=p(E,C,R,_,m[T+14],9,-1019803690),_=p(_,E,C,R,m[T+3],14,-187363961),R=p(R,_,E,C,m[T+8],20,1163531501),C=p(C,R,_,E,m[T+13],5,-1444681467),E=p(E,C,R,_,m[T+2],9,-51403784),_=p(_,E,C,R,m[T+7],14,1735328473),R=p(R,_,E,C,m[T+12],20,-1926607734),C=h(C,R,_,E,m[T+5],4,-378558),E=h(E,C,R,_,m[T+8],11,-2022574463),_=h(_,E,C,R,m[T+11],16,1839030562),R=h(R,_,E,C,m[T+14],23,-35309556),C=h(C,R,_,E,m[T+1],4,-1530992060),E=h(E,C,R,_,m[T+4],11,1272893353),_=h(_,E,C,R,m[T+7],16,-155497632),R=h(R,_,E,C,m[T+10],23,-1094730640),C=h(C,R,_,E,m[T+13],4,681279174),E=h(E,C,R,_,m[T],11,-358537222),_=h(_,E,C,R,m[T+3],16,-722521979),R=h(R,_,E,C,m[T+6],23,76029189),C=h(C,R,_,E,m[T+9],4,-640364487),E=h(E,C,R,_,m[T+12],11,-421815835),_=h(_,E,C,R,m[T+15],16,530742520),R=h(R,_,E,C,m[T+2],23,-995338651),C=v(C,R,_,E,m[T],6,-198630844),E=v(E,C,R,_,m[T+7],10,1126891415),_=v(_,E,C,R,m[T+14],15,-1416354905),R=v(R,_,E,C,m[T+5],21,-57434055),C=v(C,R,_,E,m[T+12],6,1700485571),E=v(E,C,R,_,m[T+3],10,-1894986606),_=v(_,E,C,R,m[T+10],15,-1051523),R=v(R,_,E,C,m[T+1],21,-2054922799),C=v(C,R,_,E,m[T+8],6,1873313359),E=v(E,C,R,_,m[T+15],10,-30611744),_=v(_,E,C,R,m[T+6],15,-1560198380),R=v(R,_,E,C,m[T+13],21,1309151649),C=v(C,R,_,E,m[T+4],6,-145523070),E=v(E,C,R,_,m[T+11],10,-1120210379),_=v(_,E,C,R,m[T+2],15,718787259),R=v(R,_,E,C,m[T+9],21,-343485551),C=c(C,D),R=c(R,N),_=c(_,H),E=c(E,ie)}return[C,R,_,E]}function o(m){if(m.length===0)return[];const w=m.length*8,C=new Uint32Array(r(w));for(let R=0;R<w;R+=8)C[R>>5]|=(m[R/8]&255)<<R%32;return C}function c(m,w){const C=(m&65535)+(w&65535);return(m>>16)+(w>>16)+(C>>16)<<16|C&65535}function a(m,w){return m<<w|m>>>32-w}function s(m,w,C,R,_,E){return c(a(c(c(w,m),c(R,E)),_),C)}function l(m,w,C,R,_,E,T){return s(w&C|~w&R,m,w,_,E,T)}function p(m,w,C,R,_,E,T){return s(w&R|C&~R,m,w,_,E,T)}function h(m,w,C,R,_,E,T){return s(w^C^R,m,w,_,E,T)}function v(m,w,C,R,_,E,T){return s(C^(w|~R),m,w,_,E,T)}var g=i;return oo.default=g,oo}var Rm;function GT(){if(Rm)return io;Rm=1,Object.defineProperty(io,"__esModule",{value:!0}),io.default=void 0;var i=r(MR()),t=r(JT());function r(c){return c&&c.__esModule?c:{default:c}}var o=(0,i.default)("v3",48,t.default);return io.default=o,io}var ao={},co={},Pm;function QT(){if(Pm)return co;Pm=1,Object.defineProperty(co,"__esModule",{value:!0}),co.default=void 0;var t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return co.default=t,co}var _m;function YT(){if(_m)return ao;_m=1,Object.defineProperty(ao,"__esModule",{value:!0}),ao.default=void 0;var i=u(QT()),t=u(kR()),r=xl();function u(a){return a&&a.__esModule?a:{default:a}}function o(a,s,l){if(i.default.randomUUID&&!s&&!a)return i.default.randomUUID();a=a||{};const p=a.random||(a.rng||t.default)();if(p[6]=p[6]&15|64,p[8]=p[8]&63|128,s){l=l||0;for(let h=0;h<16;++h)s[l+h]=p[h];return s}return(0,r.unsafeStringify)(p)}var c=o;return ao.default=c,ao}var uo={},lo={},Em;function XT(){if(Em)return lo;Em=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.default=void 0;function i(o,c,a,s){switch(o){case 0:return c&a^~c&s;case 1:return c^a^s;case 2:return c&a^c&s^a&s;case 3:return c^a^s}}function t(o,c){return o<<c|o>>>32-c}function r(o){const c=[1518500249,1859775393,2400959708,3395469782],a=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof o=="string"){const h=unescape(encodeURIComponent(o));o=[];for(let v=0;v<h.length;++v)o.push(h.charCodeAt(v))}else Array.isArray(o)||(o=Array.prototype.slice.call(o));o.push(128);const s=o.length/4+2,l=Math.ceil(s/16),p=new Array(l);for(let h=0;h<l;++h){const v=new Uint32Array(16);for(let g=0;g<16;++g)v[g]=o[h*64+g*4]<<24|o[h*64+g*4+1]<<16|o[h*64+g*4+2]<<8|o[h*64+g*4+3];p[h]=v}p[l-1][14]=(o.length-1)*8/Math.pow(2,32),p[l-1][14]=Math.floor(p[l-1][14]),p[l-1][15]=(o.length-1)*8&4294967295;for(let h=0;h<l;++h){const v=new Uint32Array(80);for(let _=0;_<16;++_)v[_]=p[h][_];for(let _=16;_<80;++_)v[_]=t(v[_-3]^v[_-8]^v[_-14]^v[_-16],1);let g=a[0],m=a[1],w=a[2],C=a[3],R=a[4];for(let _=0;_<80;++_){const E=Math.floor(_/20),T=t(g,5)+i(E,m,w,C)+R+c[E]+v[_]>>>0;R=C,C=w,w=t(m,30)>>>0,m=g,g=T}a[0]=a[0]+g>>>0,a[1]=a[1]+m>>>0,a[2]=a[2]+w>>>0,a[3]=a[3]+C>>>0,a[4]=a[4]+R>>>0}return[a[0]>>24&255,a[0]>>16&255,a[0]>>8&255,a[0]&255,a[1]>>24&255,a[1]>>16&255,a[1]>>8&255,a[1]&255,a[2]>>24&255,a[2]>>16&255,a[2]>>8&255,a[2]&255,a[3]>>24&255,a[3]>>16&255,a[3]>>8&255,a[3]&255,a[4]>>24&255,a[4]>>16&255,a[4]>>8&255,a[4]&255]}var u=r;return lo.default=u,lo}var Tm;function ZT(){if(Tm)return uo;Tm=1,Object.defineProperty(uo,"__esModule",{value:!0}),uo.default=void 0;var i=r(MR()),t=r(XT());function r(c){return c&&c.__esModule?c:{default:c}}var o=(0,i.default)("v5",80,t.default);return uo.default=o,uo}var po={},Im;function e1(){if(Im)return po;Im=1,Object.defineProperty(po,"__esModule",{value:!0}),po.default=void 0;var i="00000000-0000-0000-0000-000000000000";return po.default=i,po}var ho={},Am;function t1(){if(Am)return ho;Am=1,Object.defineProperty(ho,"__esModule",{value:!0}),ho.default=void 0;var i=t(Ml());function t(o){return o&&o.__esModule?o:{default:o}}function r(o){if(!(0,i.default)(o))throw TypeError("Invalid UUID");return parseInt(o.slice(14,15),16)}var u=r;return ho.default=u,ho}var bm;function r1(){return bm||(bm=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"NIL",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(i,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"v4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"validate",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return a.default}});var t=h(KT()),r=h(GT()),u=h(YT()),o=h(ZT()),c=h(e1()),a=h(t1()),s=h(Ml()),l=h(xl()),p=h(OR());function h(v){return v&&v.__esModule?v:{default:v}}}(Ip)),Ip}var km;function Ei(){if(km)return Zn;km=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.createNoDashGuid=Zn.createGuid=void 0;const i=r1(),t=()=>i.v4();Zn.createGuid=t;const r=()=>t().replace(new RegExp("-","g"),"").toUpperCase();return Zn.createNoDashGuid=r,Zn}var Om;function hu(){return Om||(Om=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.PlatformEvent=i.EventType=void 0;const t=Ei();(function(u){u[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warning=2]="Warning",u[u.Error=3]="Error",u[u.None=4]="None"})(i.EventType||(i.EventType={}));class r{constructor(o,c){this.privName=o,this.privEventId=t.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=c,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}i.PlatformEvent=r}(Tp)),Tp}var Mm;function n1(){if(Mm)return Ve;Mm=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.AudioStreamNodeErrorEvent=Ve.AudioStreamNodeDetachedEvent=Ve.AudioStreamNodeAttachedEvent=Ve.AudioStreamNodeAttachingEvent=Ve.AudioStreamNodeEvent=Ve.AudioSourceErrorEvent=Ve.AudioSourceOffEvent=Ve.AudioSourceReadyEvent=Ve.AudioSourceInitializingEvent=Ve.AudioSourceEvent=void 0;const i=hu();class t extends i.PlatformEvent{constructor(g,m,w=i.EventType.Info){super(g,w),this.privAudioSourceId=m}get audioSourceId(){return this.privAudioSourceId}}Ve.AudioSourceEvent=t;class r extends t{constructor(g){super("AudioSourceInitializingEvent",g)}}Ve.AudioSourceInitializingEvent=r;class u extends t{constructor(g){super("AudioSourceReadyEvent",g)}}Ve.AudioSourceReadyEvent=u;class o extends t{constructor(g){super("AudioSourceOffEvent",g)}}Ve.AudioSourceOffEvent=o;class c extends t{constructor(g,m){super("AudioSourceErrorEvent",g,i.EventType.Error),this.privError=m}get error(){return this.privError}}Ve.AudioSourceErrorEvent=c;class a extends t{constructor(g,m,w){super(g,m),this.privAudioNodeId=w}get audioNodeId(){return this.privAudioNodeId}}Ve.AudioStreamNodeEvent=a;class s extends a{constructor(g,m){super("AudioStreamNodeAttachingEvent",g,m)}}Ve.AudioStreamNodeAttachingEvent=s;class l extends a{constructor(g,m){super("AudioStreamNodeAttachedEvent",g,m)}}Ve.AudioStreamNodeAttachedEvent=l;class p extends a{constructor(g,m){super("AudioStreamNodeDetachedEvent",g,m)}}Ve.AudioStreamNodeDetachedEvent=p;class h extends a{constructor(g,m,w){super("AudioStreamNodeErrorEvent",g,m),this.privError=w}get error(){return this.privError}}return Ve.AudioStreamNodeErrorEvent=h,Ve}var Ye={},xm;function i1(){if(xm)return Ye;xm=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.ConnectionMessageSentEvent=Ye.ConnectionMessageReceivedEvent=Ye.ConnectionEstablishErrorEvent=Ye.ConnectionErrorEvent=Ye.ConnectionClosedEvent=Ye.ConnectionEstablishedEvent=Ye.ConnectionStartEvent=Ye.ConnectionEvent=Ye.ServiceEvent=void 0;const i=hu();class t extends i.PlatformEvent{constructor(v,g,m=i.EventType.Info){super(v,m),this.privJsonResult=g}get jsonString(){return this.privJsonResult}}Ye.ServiceEvent=t;class r extends i.PlatformEvent{constructor(v,g,m=i.EventType.Info){super(v,m),this.privConnectionId=g}get connectionId(){return this.privConnectionId}}Ye.ConnectionEvent=r;class u extends r{constructor(v,g,m){super("ConnectionStartEvent",v),this.privUri=g,this.privHeaders=m}get uri(){return this.privUri}get headers(){return this.privHeaders}}Ye.ConnectionStartEvent=u;class o extends r{constructor(v){super("ConnectionEstablishedEvent",v)}}Ye.ConnectionEstablishedEvent=o;class c extends r{constructor(v,g,m){super("ConnectionClosedEvent",v,i.EventType.Debug),this.privReason=m,this.privStatusCode=g}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Ye.ConnectionClosedEvent=c;class a extends r{constructor(v,g,m){super("ConnectionErrorEvent",v,i.EventType.Debug),this.privMessage=g,this.privType=m}get message(){return this.privMessage}get type(){return this.privType}}Ye.ConnectionErrorEvent=a;class s extends r{constructor(v,g,m){super("ConnectionEstablishErrorEvent",v,i.EventType.Error),this.privStatusCode=g,this.privReason=m}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}Ye.ConnectionEstablishErrorEvent=s;class l extends r{constructor(v,g,m){super("ConnectionMessageReceivedEvent",v),this.privNetworkReceivedTime=g,this.privMessage=m}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}Ye.ConnectionMessageReceivedEvent=l;class p extends r{constructor(v,g,m){super("ConnectionMessageSentEvent",v),this.privNetworkSentTime=g,this.privMessage=m}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}return Ye.ConnectionMessageSentEvent=p,Ye}var Ap={},Wr={},Dm;function Ir(){if(Dm)return Wr;Dm=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.ObjectDisposedError=Wr.InvalidOperationError=Wr.ArgumentNullError=void 0;class i extends Error{constructor(o){super(o),this.name="ArgumentNull",this.message=o}}Wr.ArgumentNullError=i;class t extends Error{constructor(o){super(o),this.name="InvalidOperation",this.message=o}}Wr.InvalidOperationError=t;class r extends Error{constructor(o,c){super(c),this.name=o+"ObjectDisposed",this.message=c}}return Wr.ObjectDisposedError=r,Wr}var jm;function xR(){return jm||(jm=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ConnectionMessage=i.MessageType=void 0;const t=Ir(),r=Ei();var u;(function(c){c[c.Text=0]="Text",c[c.Binary=1]="Binary"})(u=i.MessageType||(i.MessageType={}));class o{constructor(a,s,l,p){if(this.privBody=null,a===u.Text&&s&&typeof s!="string")throw new t.InvalidOperationError("Payload must be a string");if(a===u.Binary&&s&&!(s instanceof ArrayBuffer))throw new t.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=a,this.privBody=s,this.privHeaders=l||{},this.privId=p||r.createNoDashGuid(),this.messageType){case u.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case u.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===u.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===u.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}i.ConnectionMessage=o}(Ap)),Ap}var fo={},Nm;function s1(){if(Nm)return fo;Nm=1,Object.defineProperty(fo,"__esModule",{value:!0}),fo.ConnectionOpenResponse=void 0;let i=class{constructor(r,u){this.privStatusCode=r,this.privReason=u}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return fo.ConnectionOpenResponse=i,fo}var vo={},zm;function o1(){if(zm)return vo;zm=1,Object.defineProperty(vo,"__esModule",{value:!0}),vo.DeferralMap=void 0;let i=class{constructor(){this.privMap={}}add(r,u){this.privMap[r]=u}getId(r){return this.privMap[r]}complete(r,u){try{this.privMap[r].resolve(u)}catch(o){this.privMap[r].reject(o)}finally{this.privMap[r]=void 0}}};return vo.DeferralMap=i,vo}var ei={},Lm;function DR(){if(Lm)return ei;Lm=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.SendingAgentContextMessageEvent=ei.DialogEvent=void 0;const i=hu();class t extends i.PlatformEvent{constructor(o,c=i.EventType.Info){super(o,c)}}ei.DialogEvent=t;class r extends t{constructor(o){super("SendingAgentContextMessageEvent"),this.privAgentConfig=o}get agentConfig(){return this.privAgentConfig}}return ei.SendingAgentContextMessageEvent=r,ei}var go={},mo={},qm;function jR(){if(qm)return mo;qm=1,Object.defineProperty(mo,"__esModule",{value:!0}),mo.EventSource=void 0;const i=Ir(),t=Ei();let r=class{constructor(o){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=o}onEvent(o){if(this.isDisposed())throw new i.ObjectDisposedError("EventSource");if(this.metadata)for(const c in this.metadata)c&&o.metadata&&(o.metadata[c]||(o.metadata[c]=this.metadata[c]));for(const c in this.privEventListeners)c&&this.privEventListeners[c]&&this.privEventListeners[c](o)}attach(o){const c=t.createNoDashGuid();return this.privEventListeners[c]=o,{detach:()=>(delete this.privEventListeners[c],Promise.resolve())}}attachListener(o){return this.attach(c=>o.onEvent(c))}attachConsoleListener(o){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(c=>o.onEvent(c)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return mo.EventSource=r,mo}var Bm;function a1(){if(Bm)return go;Bm=1,Object.defineProperty(go,"__esModule",{value:!0}),go.Events=void 0;const i=Ir(),t=jR();let r=class Lh{static setEventSource(o){if(!o)throw new i.ArgumentNullError("eventSource");Lh.privInstance=o}static get instance(){return Lh.privInstance}};return go.Events=r,r.privInstance=new t.EventSource,go}var bp={},Fm;function c1(){return Fm||(Fm=1,Object.defineProperty(bp,"__esModule",{value:!0})),bp}var kp={},Um;function u1(){return Um||(Um=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ConnectionState=void 0,function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"}(i.ConnectionState||(i.ConnectionState={}))}(kp)),kp}var Op={},$m;function l1(){return $m||($m=1,Object.defineProperty(Op,"__esModule",{value:!0})),Op}var Mp={},Wm;function d1(){return Wm||(Wm=1,Object.defineProperty(Mp,"__esModule",{value:!0})),Mp}var xp={},Hm;function p1(){return Hm||(Hm=1,Object.defineProperty(xp,"__esModule",{value:!0})),xp}var Dp={},Vm;function h1(){return Vm||(Vm=1,Object.defineProperty(Dp,"__esModule",{value:!0})),Dp}var jp={},Km;function f1(){return Km||(Km=1,Object.defineProperty(jp,"__esModule",{value:!0})),jp}var Np={},Jm;function v1(){return Jm||(Jm=1,Object.defineProperty(Np,"__esModule",{value:!0})),Np}var zp={},Gm;function g1(){return Gm||(Gm=1,Object.defineProperty(zp,"__esModule",{value:!0})),zp}var Lp={},Qm;function m1(){return Qm||(Qm=1,Object.defineProperty(Lp,"__esModule",{value:!0})),Lp}var yo={},Ym;function NR(){if(Ym)return yo;Ym=1,Object.defineProperty(yo,"__esModule",{value:!0}),yo.List=void 0;const i=Ir();let t=class Ci{constructor(u){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],u)for(const o of u)this.privList.push(o)}get(u){return this.throwIfDisposed(),this.privList[u]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(u){this.throwIfDisposed(),this.insertAt(this.privList.length,u)}insertAt(u,o){this.throwIfDisposed(),u===0?this.privList.unshift(o):u===this.privList.length?this.privList.push(o):this.privList.splice(u,0,o),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(u){return this.throwIfDisposed(),this.remove(u,1)[0]}remove(u,o){this.throwIfDisposed();const c=this.privList.splice(u,o);return this.triggerSubscriptions(this.privRemoveSubscriptions),c}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(u){this.throwIfDisposed();const o=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[o]=u,{detach:()=>(delete this.privAddSubscriptions[o],Promise.resolve())}}onRemoved(u){this.throwIfDisposed();const o=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[o]=u,{detach:()=>(delete this.privRemoveSubscriptions[o],Promise.resolve())}}onDisposed(u){this.throwIfDisposed();const o=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[o]=u,{detach:()=>(delete this.privDisposedSubscriptions[o],Promise.resolve())}}join(u){return this.throwIfDisposed(),this.privList.join(u)}toArray(){const u=Array();return this.privList.forEach(o=>{u.push(o)}),u}any(u){return this.throwIfDisposed(),u?this.where(u).length()>0:this.length()>0}all(u){return this.throwIfDisposed(),this.where(u).length()===this.length()}forEach(u){this.throwIfDisposed();for(let o=0;o<this.length();o++)u(this.privList[o],o)}select(u){this.throwIfDisposed();const o=[];for(let c=0;c<this.privList.length;c++)o.push(u(this.privList[c],c));return new Ci(o)}where(u){this.throwIfDisposed();const o=new Ci;for(let c=0;c<this.privList.length;c++)u(this.privList[c],c)&&o.add(this.privList[c]);return o}orderBy(u){this.throwIfDisposed();const c=this.toArray().sort(u);return new Ci(c)}orderByDesc(u){return this.throwIfDisposed(),this.orderBy((o,c)=>u(c,o))}clone(){return this.throwIfDisposed(),new Ci(this.toArray())}concat(u){return this.throwIfDisposed(),new Ci(this.privList.concat(u.toArray()))}concatArray(u){return this.throwIfDisposed(),new Ci(this.privList.concat(u))}isDisposed(){return this.privList==null}dispose(u){this.isDisposed()||(this.privDisposeReason=u,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new i.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(u){if(u)for(const o in u)o&&u[o]()}};return yo.List=t,yo}var qp={},Xm;function zR(){return Xm||(Xm=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.marshalPromiseToCallbacks=i.Sink=i.Deferred=i.PromiseResultEventSource=i.PromiseResult=i.PromiseState=void 0;var t;(function(s){s[s.None=0]="None",s[s.Resolved=1]="Resolved",s[s.Rejected=2]="Rejected"})(t=i.PromiseState||(i.PromiseState={}));class r{constructor(l){this.throwIfError=()=>{if(this.isError)throw this.error},l.on(p=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=p)},p=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=p)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}i.PromiseResult=r;class u{constructor(){this.setResult=l=>{this.privOnSetResult(l)},this.setError=l=>{this.privOnSetError(l)},this.on=(l,p)=>{this.privOnSetResult=l,this.privOnSetError=p}}}i.PromiseResultEventSource=u;class o{constructor(){this.resolve=l=>(this.privResolve(l),this),this.reject=l=>(this.privReject(l),this),this.privPromise=new Promise((l,p)=>{this.privResolve=l,this.privReject=p})}get promise(){return this.privPromise}}i.Deferred=o;class c{constructor(){this.privState=t.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new u,this.privPromiseResult=new r(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(l){if(this.privState!==t.None)throw new Error("'Cannot resolve a completed promise'");this.privState=t.Resolved,this.privPromiseResultEvents.setResult(l);for(let p=0;p<this.privSuccessHandlers.length;p++)this.executeSuccessCallback(l,this.privSuccessHandlers[p],this.privErrorHandlers[p]);this.detachHandlers()}reject(l){if(this.privState!==t.None)throw new Error("'Cannot reject a completed promise'");this.privState=t.Rejected,this.privPromiseResultEvents.setError(l);for(const p of this.privErrorHandlers)this.executeErrorCallback(l,p);this.detachHandlers()}on(l,p){l==null&&(l=()=>{}),this.privState===t.None?(this.privSuccessHandlers.push(l),this.privErrorHandlers.push(p)):(this.privState===t.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,l,p):this.privState===t.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,p),this.detachHandlers())}executeSuccessCallback(l,p,h){try{p(l)}catch(v){this.executeErrorCallback(`'Unhandled callback error: ${v}'`,h)}}executeErrorCallback(l,p){if(p)try{p(l)}catch(h){throw new Error(`'Unhandled callback error: ${h}. InnerError: ${l}'`)}else throw new Error(`'Unhandled error: ${l}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}i.Sink=c;function a(s,l,p){s.then(h=>{try{l&&l(h)}catch(v){if(p)try{if(v instanceof Error){const g=v;p(g.name+": "+g.message)}else p(v)}catch{}}},h=>{if(p)try{if(h instanceof Error){const v=h;p(v.name+": "+v.message)}else p(h)}catch{}})}i.marshalPromiseToCallbacks=a}(qp)),qp}var So={},Zm;function LR(){if(Zm)return So;Zm=1,Object.defineProperty(So,"__esModule",{value:!0}),So.Queue=void 0;const i=Ir(),t=NR(),r=zR();var u;(function(c){c[c.Dequeue=0]="Dequeue",c[c.Peek=1]="Peek"})(u||(u={}));let o=class{constructor(a){this.privPromiseStore=new t.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=a||new t.List,this.privDetachables=[],this.privSubscribers=new t.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(a){this.throwIfDispose(),this.enqueueFromPromise(new Promise(s=>s(a)))}enqueueFromPromise(a){this.throwIfDispose(),a.then(s=>{this.privList.add(s)},()=>{})}dequeue(){this.throwIfDispose();const a=new r.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:a,type:u.Dequeue}),this.drain()),a.promise}peek(){this.throwIfDispose();const a=new r.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:a,type:u.Peek}),this.drain()),a.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(a,s){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=s,this.privIsDisposing=!0;const l=this.privSubscribers;if(l){for(;l.length()>0;)l.removeFirst().deferral.resolve(void 0);this.privSubscribers===l&&(this.privSubscribers=l)}for(const p of this.privDetachables)await p.detach();if(this.privPromiseStore.length()>0&&a){const p=[];return this.privPromiseStore.toArray().forEach(h=>{p.push(h)}),Promise.all(p).finally(()=>{this.privSubscribers=null,this.privList.forEach(h=>{a(h)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(a){await this.drainAndDispose(null,a)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const a=this.privSubscribers,s=this.privList;if(a&&s){for(;s.length()>0&&a.length()>0&&!this.privIsDisposing;){const l=a.removeFirst();if(l.type===u.Peek)l.deferral.resolve(s.first());else{const p=s.removeFirst();l.deferral.resolve(p)}}this.privSubscribers===a&&(this.privSubscribers=a),this.privList===s&&(this.privList=s)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new i.InvalidOperationError(this.privDisposeReason):new i.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new i.InvalidOperationError("Queue disposing")}};return So.Queue=o,So}var Co={},ey;function y1(){if(ey)return Co;ey=1,Object.defineProperty(Co,"__esModule",{value:!0}),Co.RawWebsocketMessage=void 0;const i=xR(),t=Ir(),r=Ei();let u=class{constructor(c,a,s){if(this.privPayload=null,!a)throw new t.ArgumentNullError("payload");if(c===i.MessageType.Binary&&Object.getPrototypeOf(a).constructor.name!=="ArrayBuffer")throw new t.InvalidOperationError("Payload must be ArrayBuffer");if(c===i.MessageType.Text&&typeof a!="string")throw new t.InvalidOperationError("Payload must be a string");this.privMessageType=c,this.privPayload=a,this.privId=s||r.createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===i.MessageType.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===i.MessageType.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return Co.RawWebsocketMessage=u,Co}var wo={},ty;function S1(){if(ty)return wo;ty=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.RiffPcmEncoder=void 0;let i=class{constructor(r,u){this.privActualSampleRate=r,this.privDesiredSampleRate=u}encode(r){const u=this.downSampleAudioFrame(r,this.privActualSampleRate,this.privDesiredSampleRate);if(!u)return null;const o=u.length*2,c=new ArrayBuffer(o),a=new DataView(c);return this.floatTo16BitPCM(a,0,u),c}setString(r,u,o){for(let c=0;c<o.length;c++)r.setUint8(u+c,o.charCodeAt(c))}floatTo16BitPCM(r,u,o){for(let c=0;c<o.length;c++,u+=2){const a=Math.max(-1,Math.min(1,o[c]));r.setInt16(u,a<0?a*32768:a*32767,!0)}}downSampleAudioFrame(r,u,o){if(!r)return null;if(o===u||o>u)return r;const c=u/o,a=Math.round(r.length/c),s=new Float32Array(a);let l=0,p=0;for(;p<a;){const h=Math.round((p+1)*c);let v=0,g=0;for(;l<h&&l<r.length;)v+=r[l++],g++;s[p++]=v/g}return s}};return wo.RiffPcmEncoder=i,wo}var Ro={},ry;function C1(){if(ry)return Ro;ry=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.Stream=void 0;const i=Ir(),t=Ei(),r=LR();let u=class{constructor(c){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=c||t.createNoDashGuid(),this.privReaderQueue=new r.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(c){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(c)}catch{}}read(){if(this.privIsReadEnded)throw new i.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async c=>((c===void 0||c.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),c))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new r.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new i.InvalidOperationError("Stream closed")}};return Ro.Stream=u,Ro}var Bp={},ny;function ef(){return ny||(ny=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.TranslationStatus=void 0,function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"}(i.TranslationStatus||(i.TranslationStatus={}))}(Bp)),Bp}var Po={},iy;function w1(){if(iy)return Po;iy=1,Object.defineProperty(Po,"__esModule",{value:!0}),Po.ChunkedArrayBufferStream=void 0;const i=de();let t=class extends i.Stream{constructor(u,o){super(o),this.privTargetChunkSize=Math.round(u),this.privNextBufferReadyBytes=0}writeStreamChunk(u){if(u.isEnd||this.privNextBufferReadyBytes===0&&u.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(u);return}let o=0;for(;o<u.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=u.timeReceived);const c=Math.min(u.buffer.byteLength-o,this.privTargetChunkSize-this.privNextBufferReadyBytes),a=new Uint8Array(this.privNextBufferToWrite),s=new Uint8Array(u.buffer.slice(o,c+o));a.set(s,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=c,o+=c,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return Po.ChunkedArrayBufferStream=t,Po}var Fp={},sy;function R1(){return sy||(sy=1,Object.defineProperty(Fp,"__esModule",{value:!0})),Fp}var _o={},oy;function P1(){if(oy)return _o;oy=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.Timeout=void 0;let i=class En{static load(){const r=new Map([[0,()=>{}]]),u=new Map,c="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),a=new Worker(c);return a.addEventListener("message",({data:p})=>{if(En.isCallNotification(p)){const{params:{timerId:h}}=p,v=r.get(h);if(typeof v=="number"){const g=u.get(v);if(g===void 0||g!==h)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v(),r.delete(h);else throw new Error("The timer is in an undefined state.")}else if(En.isClearResponse(p)){const{id:h}=p,v=u.get(h);if(v===void 0)throw new Error("The timer is in an undefined state.");u.delete(h),r.delete(v)}else{const{error:{message:h}}=p;throw new Error(h)}}),{clearTimeout:p=>{const h=Math.random();u.set(h,p),r.set(p,h),a.postMessage({id:h,method:"clear",params:{timerId:p}})},setTimeout:(p,h)=>{const v=Math.random();return r.set(v,p),a.postMessage({id:null,method:"set",params:{delay:h,now:performance.now(),timerId:v}}),v}}}static loadWorkerTimers(){return()=>(En.workerTimers!==null||(En.workerTimers=En.load()),En.workerTimers)}static isCallNotification(r){return r.method!==void 0&&r.method==="call"}static isClearResponse(r){return r.error===null&&typeof r.id=="number"}};return _o.Timeout=i,i.workerTimers=null,i.clearTimeout=t=>i.timers().clearTimeout(t),i.setTimeout=(t,r)=>i.timers().setTimeout(t,r),i.timers=i.loadWorkerTimers(),_o}var Re={},ay;function _1(){if(ay)return Re;ay=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.OCSPCacheUpdateErrorEvent=Re.OCSPResponseRetrievedEvent=Re.OCSPCacheFetchErrorEvent=Re.OCSPVerificationFailedEvent=Re.OCSPCacheHitEvent=Re.OCSPCacheEntryNeedsRefreshEvent=Re.OCSPCacheEntryExpiredEvent=Re.OCSPWSUpgradeStartedEvent=Re.OCSPStapleReceivedEvent=Re.OCSPCacheUpdateCompleteEvent=Re.OCSPDiskCacheStoreEvent=Re.OCSPMemoryCacheStoreEvent=Re.OCSPCacheUpdateNeededEvent=Re.OCSPDiskCacheHitEvent=Re.OCSPCacheMissEvent=Re.OCSPMemoryCacheHitEvent=Re.OCSPEvent=void 0;const i=hu();class t extends i.PlatformEvent{constructor(T,D,N){super(T,D),this.privSignature=N}}Re.OCSPEvent=t;class r extends t{constructor(T){super("OCSPMemoryCacheHitEvent",i.EventType.Debug,T)}}Re.OCSPMemoryCacheHitEvent=r;class u extends t{constructor(T){super("OCSPCacheMissEvent",i.EventType.Debug,T)}}Re.OCSPCacheMissEvent=u;class o extends t{constructor(T){super("OCSPDiskCacheHitEvent",i.EventType.Debug,T)}}Re.OCSPDiskCacheHitEvent=o;class c extends t{constructor(T){super("OCSPCacheUpdateNeededEvent",i.EventType.Debug,T)}}Re.OCSPCacheUpdateNeededEvent=c;class a extends t{constructor(T){super("OCSPMemoryCacheStoreEvent",i.EventType.Debug,T)}}Re.OCSPMemoryCacheStoreEvent=a;class s extends t{constructor(T){super("OCSPDiskCacheStoreEvent",i.EventType.Debug,T)}}Re.OCSPDiskCacheStoreEvent=s;class l extends t{constructor(T){super("OCSPCacheUpdateCompleteEvent",i.EventType.Debug,T)}}Re.OCSPCacheUpdateCompleteEvent=l;class p extends t{constructor(){super("OCSPStapleReceivedEvent",i.EventType.Debug,"")}}Re.OCSPStapleReceivedEvent=p;class h extends t{constructor(T){super("OCSPWSUpgradeStartedEvent",i.EventType.Debug,T)}}Re.OCSPWSUpgradeStartedEvent=h;class v extends t{constructor(T,D){super("OCSPCacheEntryExpiredEvent",i.EventType.Debug,T),this.privExpireTime=D}}Re.OCSPCacheEntryExpiredEvent=v;class g extends t{constructor(T,D,N){super("OCSPCacheEntryNeedsRefreshEvent",i.EventType.Debug,T),this.privExpireTime=N,this.privStartTime=D}}Re.OCSPCacheEntryNeedsRefreshEvent=g;class m extends t{constructor(T,D,N){super("OCSPCacheHitEvent",i.EventType.Debug,T),this.privExpireTime=N,this.privExpireTimeString=new Date(N).toLocaleDateString(),this.privStartTime=D,this.privStartTimeString=new Date(D).toLocaleTimeString()}}Re.OCSPCacheHitEvent=m;class w extends t{constructor(T,D){super("OCSPVerificationFailedEvent",i.EventType.Debug,T),this.privError=D}}Re.OCSPVerificationFailedEvent=w;class C extends t{constructor(T,D){super("OCSPCacheFetchErrorEvent",i.EventType.Debug,T),this.privError=D}}Re.OCSPCacheFetchErrorEvent=C;class R extends t{constructor(T){super("OCSPResponseRetrievedEvent",i.EventType.Debug,T)}}Re.OCSPResponseRetrievedEvent=R;class _ extends t{constructor(T,D){super("OCSPCacheUpdateErrorEvent",i.EventType.Debug,T),this.privError=D}}return Re.OCSPCacheUpdateErrorEvent=_,Re}var Eo={},cy;function E1(){if(cy)return Eo;cy=1,Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.BackgroundEvent=void 0;const i=de();class t extends i.PlatformEvent{constructor(u){super("BackgroundEvent",i.EventType.Error),this.privError=u}get error(){return this.privError}}return Eo.BackgroundEvent=t,Eo}var uy;function de(){return uy||(uy=1,function(i){var t=Xn&&Xn.__createBinding||(Object.create?function(o,c,a,s){s===void 0&&(s=a),Object.defineProperty(o,s,{enumerable:!0,get:function(){return c[a]}})}:function(o,c,a,s){s===void 0&&(s=a),o[s]=c[a]}),r=Xn&&Xn.__exportStar||function(o,c){for(var a in o)a!=="default"&&!c.hasOwnProperty(a)&&t(c,o,a)};Object.defineProperty(i,"__esModule",{value:!0}),r(n1(),i),r(i1(),i),r(xR(),i),r(s1(),i),r(o1(),i),r(DR(),i),r(Ir(),i),r(a1(),i),r(jR(),i),r(Ei(),i),r(c1(),i),r(u1(),i),r(l1(),i),r(d1(),i),r(p1(),i),r(h1(),i),r(f1(),i),r(v1(),i),r(g1(),i),r(m1(),i),r(NR(),i),r(hu(),i),r(zR(),i),r(LR(),i),r(y1(),i),r(S1(),i),r(C1(),i);var u=ef();Object.defineProperty(i,"TranslationStatus",{enumerable:!0,get:function(){return u.TranslationStatus}}),r(w1(),i),r(R1(),i),r(P1(),i),r(_1(),i),r(E1(),i)}(Xn)),Xn}var To={},ly;function Pt(){if(ly)return To;ly=1,Object.defineProperty(To,"__esModule",{value:!0}),To.HeaderNames=void 0;let i=class{};return To.HeaderNames=i,i.AuthKey="Ocp-Apim-Subscription-Key",i.Authorization="Authorization",i.SpIDAuthKey="Apim-Subscription-Id",i.ConnectionId="X-ConnectionId",i.ContentType="Content-Type",i.CustomCommandsAppId="X-CommandsAppId",i.Path="Path",i.RequestId="X-RequestId",i.RequestStreamId="X-StreamId",i.RequestTimestamp="X-Timestamp",To}var Io={},dy;function tf(){if(dy)return Io;dy=1,Object.defineProperty(Io,"__esModule",{value:!0}),Io.AuthInfo=void 0;class i{constructor(r,u){this.privHeaderName=r,this.privToken=u}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return Io.AuthInfo=i,Io}var py;function T1(){if(py)return eo;py=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.CognitiveSubscriptionKeyAuthentication=void 0;const i=de(),t=Pt(),r=tf();let u=class{constructor(c){if(!c)throw new i.ArgumentNullError("subscriptionKey");this.privAuthInfo=new r.AuthInfo(t.HeaderNames.AuthKey,c)}fetch(c){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(c){return Promise.resolve(this.privAuthInfo)}};return eo.CognitiveSubscriptionKeyAuthentication=u,eo}var Ao={},hy;function I1(){if(hy)return Ao;hy=1,Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.CognitiveTokenAuthentication=void 0;const i=de(),t=tf(),r=Pt();let u=class qh{constructor(c,a){if(!c)throw new i.ArgumentNullError("fetchCallback");if(!a)throw new i.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=c,this.privFetchOnExpiryCallback=a}fetch(c){return this.privFetchCallback(c).then(a=>new t.AuthInfo(r.HeaderNames.Authorization,a===void 0?void 0:qh.privTokenPrefix+a))}fetchOnExpiry(c){return this.privFetchOnExpiryCallback(c).then(a=>new t.AuthInfo(r.HeaderNames.Authorization,a===void 0?void 0:qh.privTokenPrefix+a))}};return Ao.CognitiveTokenAuthentication=u,u.privTokenPrefix="Bearer ",Ao}var Up={},fy;function A1(){return fy||(fy=1,Object.defineProperty(Up,"__esModule",{value:!0})),Up}var $p={},vy;function b1(){return vy||(vy=1,Object.defineProperty($p,"__esModule",{value:!0})),$p}var bo={},ti={},dr={};const k1={},O1=Object.freeze(Object.defineProperty({__proto__:null,default:k1},Symbol.toStringTag,{value:"Module"})),Pi=uR(O1);var Wp={},gy;function qR(){return gy||(gy=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.LogLevel=void 0;const t=de();Object.defineProperty(i,"LogLevel",{enumerable:!0,get:function(){return t.EventType}})}(Wp)),Wp}var ko={},my;function ge(){if(my)return ko;my=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.Contracts=void 0;let i=class wi{static throwIfNullOrUndefined(r,u){if(r==null)throw new Error("throwIfNullOrUndefined:"+u)}static throwIfNull(r,u){if(r===null)throw new Error("throwIfNull:"+u)}static throwIfNullOrWhitespace(r,u){if(wi.throwIfNullOrUndefined(r,u),(""+r).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+u)}static throwIfNullOrTooLong(r,u,o){if(wi.throwIfNullOrUndefined(r,u),(""+r).length>o)throw new Error("throwIfNullOrTooLong:"+u+" (more than "+o.toString()+" characters)")}static throwIfNullOrTooShort(r,u,o){if(wi.throwIfNullOrUndefined(r,u),(""+r).length<o)throw new Error("throwIfNullOrTooShort:"+u+" (less than "+o.toString()+" characters)")}static throwIfDisposed(r){if(r)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(r,u){if(wi.throwIfNullOrUndefined(r,u),r.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+u);for(const o of r)wi.throwIfNullOrWhitespace(o,u)}static throwIfFileDoesNotExist(r,u){wi.throwIfNullOrWhitespace(r,u)}static throwIfNotUndefined(r,u){if(r!==void 0)throw new Error("throwIfNotUndefined:"+u)}};return ko.Contracts=i,ko}var yy;function M1(){if(yy)return dr;yy=1;var i=dr&&dr.__createBinding||(Object.create?function(s,l,p,h){h===void 0&&(h=p),Object.defineProperty(s,h,{enumerable:!0,get:function(){return l[p]}})}:function(s,l,p,h){h===void 0&&(h=p),s[h]=l[p]}),t=dr&&dr.__setModuleDefault||(Object.create?function(s,l){Object.defineProperty(s,"default",{enumerable:!0,value:l})}:function(s,l){s.default=l}),r=dr&&dr.__importStar||function(s){if(s&&s.__esModule)return s;var l={};if(s!=null)for(var p in s)p!=="default"&&Object.hasOwnProperty.call(s,p)&&i(l,s,p);return t(l,s),l};Object.defineProperty(dr,"__esModule",{value:!0}),dr.ConsoleLoggingListener=void 0;const u=r(Pi),o=qR(),c=ge();let a=class{constructor(l=o.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=l}set logPath(l){c.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available`),this.privLogPath=l}set enableConsoleOutput(l){this.privEnableConsoleOutput=l}onEvent(l){if(l.eventType>=this.privLogLevelFilter){const p=this.toString(l);if(this.logCallback&&this.logCallback(p),this.privLogPath&&u.writeFileSync(this.privLogPath,p+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(l.eventType){case o.LogLevel.Debug:console.debug(p);break;case o.LogLevel.Info:console.info(p);break;case o.LogLevel.Warning:console.warn(p);break;case o.LogLevel.Error:console.error(p);break;default:console.log(p);break}}}toString(l){const p=[`${l.eventTime}`,`${l.name}`],h=l;for(const v in h)if(v&&l.hasOwnProperty(v)&&v!=="eventTime"&&v!=="eventType"&&v!=="eventId"&&v!=="name"&&v!=="constructor"){const g=h[v];let m="<NULL>";g!=null&&(typeof g=="number"||typeof g=="string"?m=g.toString():m=JSON.stringify(g)),p.push(`${v}: ${m}`)}return p.join(" | ")}};return dr.ConsoleLoggingListener=a,dr}var Hp={},Sy;function x1(){return Sy||(Sy=1,Object.defineProperty(Hp,"__esModule",{value:!0})),Hp}var Vp={},Kp={},Cy;function Ti(){return Cy||(Cy=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.AudioStreamFormatImpl=i.AudioStreamFormat=i.AudioFormatTag=void 0;var t;(function(o){o[o.PCM=1]="PCM",o[o.MuLaw=2]="MuLaw",o[o.Siren=3]="Siren",o[o.MP3=4]="MP3",o[o.SILKSkype=5]="SILKSkype",o[o.OGG_OPUS=6]="OGG_OPUS",o[o.WEBM_OPUS=7]="WEBM_OPUS",o[o.ALaw=8]="ALaw",o[o.FLAC=9]="FLAC",o[o.OPUS=10]="OPUS",o[o.AMR_WB=11]="AMR_WB",o[o.G722=12]="G722"})(t=i.AudioFormatTag||(i.AudioFormatTag={}));class r{static getDefaultInputFormat(){return u.getDefaultInputFormat()}static getWaveFormat(c,a,s,l){return new u(c,a,s,l)}static getWaveFormatPCM(c,a,s){return new u(c,a,s)}}i.AudioStreamFormat=r;class u extends r{constructor(c=16e3,a=16,s=1,l=t.PCM){super();let p=!0;switch(l){case t.PCM:this.formatTag=1;break;case t.ALaw:this.formatTag=6;break;case t.MuLaw:this.formatTag=7;break;default:p=!1}if(this.bitsPerSample=a,this.samplesPerSec=c,this.channels=s,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),p){this.privHeader=new ArrayBuffer(44);const h=new DataView(this.privHeader);this.setString(h,0,"RIFF"),h.setUint32(4,0,!0),this.setString(h,8,"WAVEfmt "),h.setUint32(16,16,!0),h.setUint16(20,this.formatTag,!0),h.setUint16(22,this.channels,!0),h.setUint32(24,this.samplesPerSec,!0),h.setUint32(28,this.avgBytesPerSec,!0),h.setUint16(32,this.channels*(this.bitsPerSample/8),!0),h.setUint16(34,this.bitsPerSample,!0),this.setString(h,36,"data"),h.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new u}static getAudioContext(c){const a=window.AudioContext||window.webkitAudioContext||!1;if(a)return c!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new a({sampleRate:c}):new a;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(c,a,s){for(let l=0;l<s.length;l++)c.setUint8(a+l,s.charCodeAt(l))}}i.AudioStreamFormatImpl=u}(Kp)),Kp}var wy;function D1(){return wy||(wy=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.MicAudioSource=i.AudioWorkletSourceURLPropertyName=void 0;const t=te(),r=de(),u=Ti();i.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class o{constructor(a,s,l,p){this.privRecorder=a,this.deviceId=s,this.privStreams={},this.privOutputChunkSize=o.AUDIOFORMAT.avgBytesPerSec/10,this.privId=l||r.createNoDashGuid(),this.privEvents=new r.EventSource,this.privMediaStream=p||null,this.privIsClosing=!1}get format(){return Promise.resolve(o.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new r.Deferred;try{this.createAudioContext()}catch(l){if(l instanceof Error){const p=l;this.privInitializeDeferral.reject(p.name+": "+p.message)}else this.privInitializeDeferral.reject(l);return this.privInitializeDeferral.promise}const a=window.navigator;let s=a.getUserMedia||a.webkitGetUserMedia||a.mozGetUserMedia||a.msGetUserMedia;if(a.mediaDevices&&(s=(l,p,h)=>{a.mediaDevices.getUserMedia(l).then(p).catch(h)}),s){const l=()=>{this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):s({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},p=>{this.privMediaStream=p,this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},p=>{const h=`Error occurred during microphone initialization: ${p}`;this.privInitializeDeferral.reject(h),this.onEvent(new r.AudioSourceErrorEvent(this.privId,h))})};this.privContext.state==="suspended"?this.privContext.resume().then(l).catch(p=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${p}`)}):l()}else{const l="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(l),this.onEvent(new r.AudioSourceErrorEvent(l,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(a){return this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,a)),this.listen(a).then(s=>(this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,a)),{detach:async()=>(s.readEnded(),delete this.privStreams[a],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,a)),this.turnOff()),id:()=>a,read:()=>s.read()}))}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,a)))}async turnOff(){for(const a in this.privStreams)if(a){const s=this.privStreams[a];s&&s.close()}this.onEvent(new r.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(a=>({bitspersample:o.AUDIOFORMAT.bitsPerSample,channelcount:o.AUDIOFORMAT.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:a,samplerate:o.AUDIOFORMAT.samplesPerSec,type:t.type.Microphones}))}setProperty(a,s){if(a===i.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(s);else throw new Error("Property '"+a+"' is not supported on Microphone.")}getMicrophoneLabel(){const a="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(a);this.privMicrophoneLabel=a;const s=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(s===void 0)return Promise.resolve(this.privMicrophoneLabel);const l=new r.Deferred;return navigator.mediaDevices.enumerateDevices().then(p=>{for(const h of p)if(h.deviceId===s){this.privMicrophoneLabel=h.label;break}l.resolve(this.privMicrophoneLabel)},()=>l.resolve(this.privMicrophoneLabel)),l.promise}async listen(a){await this.turnOn();const s=new r.ChunkedArrayBufferStream(this.privOutputChunkSize,a);this.privStreams[a]=s;try{this.privRecorder.record(this.privContext,this.privMediaStream,s)}catch(p){throw this.onEvent(new r.AudioStreamNodeErrorEvent(this.privId,a,p)),p}return s}onEvent(a){this.privEvents.onEvent(a),r.Events.instance.onEvent(a)}createAudioContext(){this.privContext||(this.privContext=u.AudioStreamFormatImpl.getAudioContext(o.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let a=!1;"close"in this.privContext&&(a=!0),a?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}i.MicAudioSource=o,o.AUDIOFORMAT=u.AudioStreamFormat.getDefaultInputFormat()}(Vp)),Vp}var Oo={},Ry;function j1(){if(Ry)return Oo;Ry=1,Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.FileAudioSource=void 0;const i=te(),t=de(),r=Ti();let u=class{constructor(c,a,s){this.privStreams={},this.privHeaderEnd=44,this.privId=s||t.createNoDashGuid(),this.privEvents=new t.EventSource,this.privSource=c,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=c.name:this.privFilename=a||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const c=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new t.AudioSourceErrorEvent(c,"")),Promise.reject(c)}this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(c){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,c));const a=await this.upload(c);return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,c)),Promise.resolve({detach:async()=>{a.readEnded(),delete this.privStreams[c],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,c)),await this.turnOff()},id:()=>c,read:()=>a.read()})}detach(c){c&&this.privStreams[c]&&(this.privStreams[c].close(),delete this.privStreams[c],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,c)))}turnOff(){for(const c in this.privStreams)if(c){const a=this.privStreams[c];a&&!a.isClosed&&a.close()}return this.onEvent(new t.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(c=>Promise.resolve({bitspersample:c.bitsPerSample,channelcount:c.channels,connectivity:i.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:c.samplesPerSec,type:i.type.File}))}readHeader(){const a=this.privSource.slice(0,4296),s=new t.Deferred,l=p=>{const h=new DataView(p),v=_=>String.fromCharCode(h.getUint8(_),h.getUint8(_+1),h.getUint8(_+2),h.getUint8(_+3));if(v(0)!=="RIFF"){s.reject("Invalid WAV header in file, RIFF was not found");return}if(v(8)!=="WAVE"||v(12)!=="fmt "){s.reject("Invalid WAV header in file, WAVEfmt was not found");return}const g=h.getInt32(16,!0),m=h.getUint16(22,!0),w=h.getUint32(24,!0),C=h.getUint16(34,!0);let R=36+Math.max(g-16,0);for(;v(R)!=="data";R+=2)if(R>4288){s.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=R+8,s.resolve(r.AudioStreamFormat.getWaveFormatPCM(w,C,m))};if(typeof window<"u"&&typeof Blob<"u"&&a instanceof Blob){const p=new FileReader;p.onload=h=>{const v=h.target.result;l(v)},p.readAsArrayBuffer(a)}else{const p=a;l(p.buffer.slice(p.byteOffset,p.byteOffset+p.byteLength))}return s.promise}async upload(c){const a=s=>{const l=`Error occurred while processing '${this.privFilename}'. ${s}`;throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,c,l)),new Error(l)};try{await this.turnOn();const s=await this.privAudioFormatPromise,l=new t.ChunkedArrayBufferStream(s.avgBytesPerSec/10,c);this.privStreams[c]=l;const p=this.privSource.slice(this.privHeaderEnd),h=v=>{l.isClosed||(l.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()}),l.close())};if(typeof window<"u"&&typeof Blob<"u"&&p instanceof Blob){const v=new FileReader;v.onerror=g=>a(g.toString()),v.onload=g=>{const m=g.target.result;h(m)},v.readAsArrayBuffer(p)}else{const v=p;h(v.buffer.slice(v.byteOffset,v.byteOffset+v.byteLength))}return l}catch(s){a(s)}}onEvent(c){this.privEvents.onEvent(c),t.Events.instance.onEvent(c)}};return Oo.FileAudioSource=u,Oo}var Mo={},Py;function N1(){if(Py)return Mo;Py=1,Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.PcmRecorder=void 0;const i=de();class t{constructor(u){this.privStopInputOnRelease=u}record(u,o,c){const s=new i.RiffPcmEncoder(u.sampleRate,16e3),l=u.createMediaStreamSource(o),p=()=>{const v=(()=>{let g=0;try{return u.createScriptProcessor(g,1,1)}catch{g=2048;let w=u.sampleRate;for(;g<16384&&w>=32e3;)g<<=1,w>>=1;return u.createScriptProcessor(g,1,1)}})();v.onaudioprocess=g=>{const m=g.inputBuffer.getChannelData(0);if(c&&!c.isClosed){const w=s.encode(m);w&&c.writeStreamChunk({buffer:w,isEnd:!1,timeReceived:Date.now()})}},l.connect(v),v.connect(u.destination),this.privMediaResources={scriptProcessorNode:v,source:l,stream:o}},h=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(u.audioWorklet&&!h){if(!this.privSpeechProcessorScript){const v=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,g=new Blob([v],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(g)}u.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const v=new AudioWorkletNode(u,"speech-processor");v.port.onmessage=g=>{const m=g.data;if(c&&!c.isClosed){const w=s.encode(m);w&&c.writeStreamChunk({buffer:w,isEnd:!1,timeReceived:Date.now()})}},l.connect(v),v.connect(u.destination),this.privMediaResources={scriptProcessorNode:v,source:l,stream:o}}).catch(()=>{p()})}else try{p()}catch(v){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${v}`)}}releaseMediaResources(u){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(u.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(o=>o.stop()),this.privMediaResources.source=null))}setWorkletUrl(u){this.privSpeechProcessorScript=u}}return Mo.PcmRecorder=t,Mo}var xo={},Ut={},_y;function BR(){if(_y)return Ut;_y=1;var i=Ut&&Ut.__createBinding||(Object.create?function(g,m,w,C){C===void 0&&(C=w),Object.defineProperty(g,C,{enumerable:!0,get:function(){return m[w]}})}:function(g,m,w,C){C===void 0&&(C=w),g[C]=m[w]}),t=Ut&&Ut.__setModuleDefault||(Object.create?function(g,m){Object.defineProperty(g,"default",{enumerable:!0,value:m})}:function(g,m){g.default=m}),r=Ut&&Ut.__importStar||function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var w in g)w!=="default"&&Object.hasOwnProperty.call(g,w)&&i(m,g,w);return t(m,g),m},u=Ut&&Ut.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.WebsocketMessageAdapter=void 0;const o=r(Pi),c=r(Pi),a=u(Pi),s=u(Pi),l=u(Pi),p=Pt(),h=de();let v=class Bh{constructor(m,w,C,R,_,E){if(!m)throw new h.ArgumentNullError("uri");if(!C)throw new h.ArgumentNullError("messageFormatter");this.proxyInfo=R,this.privConnectionEvents=new h.EventSource,this.privConnectionId=w,this.privMessageFormatter=C,this.privConnectionState=h.ConnectionState.None,this.privUri=m,this.privHeaders=_,this.privEnableCompression=E,this.privHeaders[p.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===h.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new h.Deferred,this.privCertificateValidatedDeferral=new h.Deferred,this.privConnectionState=h.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!Bh.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{const m={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),m.agent=this.getAgent();let C=new URL(this.privUri).protocol;(C==null?void 0:C.toLocaleLowerCase())==="wss:"?C="https:":(C==null?void 0:C.toLocaleLowerCase())==="ws:"&&(C="http:"),m.agent.protocol=C,this.privWebsocketClient=new l.default(this.privUri,m)}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new h.Queue,this.privDisconnectDeferral=new h.Deferred,this.privSendMessageQueue=new h.Queue,this.processSendQueue().catch(m=>{h.Events.instance.onEvent(new h.BackgroundEvent(m))})}catch(m){return this.privConnectionEstablishDeferral.resolve(new h.ConnectionOpenResponse(500,m)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new h.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=h.ConnectionState.Connected,this.onEvent(new h.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new h.ConnectionOpenResponse(200,""))},m=>{this.privConnectionEstablishDeferral.reject(m)})},this.privWebsocketClient.onerror=m=>{this.onEvent(new h.ConnectionErrorEvent(this.privConnectionId,m.message,m.type)),this.privLastErrorReceived=m.message},this.privWebsocketClient.onclose=m=>{this.privConnectionState===h.ConnectionState.Connecting?(this.privConnectionState=h.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new h.ConnectionOpenResponse(m.code,m.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=h.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new h.ConnectionClosedEvent(this.privConnectionId,m.code,m.reason))),this.onClose(m.code,m.reason).catch(w=>{h.Events.instance.onEvent(new h.BackgroundEvent(w))})},this.privWebsocketClient.onmessage=m=>{const w=new Date().toISOString();if(this.privConnectionState===h.ConnectionState.Connected){const C=new h.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(C.promise),m.data instanceof ArrayBuffer){const R=new h.RawWebsocketMessage(h.MessageType.Binary,m.data);this.privMessageFormatter.toConnectionMessage(R).then(_=>{this.onEvent(new h.ConnectionMessageReceivedEvent(this.privConnectionId,w,_)),C.resolve(_)},_=>{C.reject(`Invalid binary message format. Error: ${_}`)})}else{const R=new h.RawWebsocketMessage(h.MessageType.Text,m.data);this.privMessageFormatter.toConnectionMessage(R).then(_=>{this.onEvent(new h.ConnectionMessageReceivedEvent(this.privConnectionId,w,_)),C.resolve(_)},_=>{C.reject(`Invalid text message format. Error: ${_}`)})}}},this.privConnectionEstablishDeferral.promise}send(m){if(this.privConnectionState!==h.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${h.ConnectionState[this.privConnectionState]} state`);const w=new h.Deferred,C=new h.Deferred;return this.privSendMessageQueue.enqueueFromPromise(C.promise),this.privMessageFormatter.fromConnectionMessage(m).then(R=>{C.resolve({Message:m,RawWebsocketMessage:R,sendStatusDeferral:w})},R=>{C.reject(`Error formatting the message. ${R}`)}),w.promise}read(){return this.privConnectionState!==h.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(m){if(this.privWebsocketClient)this.privConnectionState!==h.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,m||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(m){try{if(!m)return Promise.resolve();if(this.onEvent(new h.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),m.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(m.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+m.Message.id+" "+new Error().stack);return Promise.resolve()}catch(w){return Promise.reject(`websocket send error: ${w}`)}}async onClose(m,w){const C=`Connection closed. ${m}: ${w}`;this.privConnectionState=h.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},C),await this.privSendMessageQueue.drainAndDispose(R=>{R.sendStatusDeferral.reject(C)},C)}async processSendQueue(){for(;;){const w=await this.privSendMessageQueue.dequeue();if(!w)return;try{await this.sendRawMessage(w),w.sendStatusDeferral.resolve()}catch(C){w.sendStatusDeferral.reject(C)}}}onEvent(m){this.privConnectionEvents.onEvent(m),h.Events.instance.onEvent(m)}getAgent(){const m=new a.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(m.proxyInfo=this.proxyInfo),m}static GetProxyAgent(m){const w={host:m.HostName,port:m.Port};return m.UserName?w.headers={"Proxy-Authentication":"Basic "+new Buffer(`${m.UserName}:${m.Password===void 0?"":m.Password}`).toString("base64")}:w.headers={},w.headers.requestOCSP="true",new s.default(w)}createConnection(m,w){let C;if(w={...w,requestOCSP:!0,servername:w.host},this.proxyInfo){const _=Bh.GetProxyAgent(this.proxyInfo);C=new Promise((E,T)=>{_.callback(m,w,(D,N)=>{D?T(D):E(N)})})}else w.secureEndpoint?C=Promise.resolve(c.connect(w)):C=Promise.resolve(o.connect(w));return C}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return Ut.WebsocketMessageAdapter=v,v.forceNpmWebSocket=!1,Ut}var Ey;function z1(){if(Ey)return xo;Ey=1,Object.defineProperty(xo,"__esModule",{value:!0}),xo.WebsocketConnection=void 0;const i=de(),t=BR();let r=class{constructor(o,c,a,s,l,p=!1,h){if(this.privIsDisposed=!1,!o)throw new i.ArgumentNullError("uri");if(!s)throw new i.ArgumentNullError("messageFormatter");this.privMessageFormatter=s;let v="",g=0;if(c){for(const m in c)if(m){v+=g===0&&o.indexOf("?")===-1?"?":"&";const w=encodeURIComponent(m);v+=w;let C=c[m];C&&(C=encodeURIComponent(C),v+=`=${C}`),g++}}if(a){for(const m in a)if(m){v+=g===0&&o.indexOf("?")===-1?"?":"&";const w=encodeURIComponent(a[m]);v+=`${m}=${w}`,g++}}this.privUri=o+v,this.privId=h||i.createNoDashGuid(),this.privConnectionMessageAdapter=new t.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,l,a,p)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(o){return this.privConnectionMessageAdapter.send(o)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return xo.WebsocketConnection=r,xo}var Do={},Ty;function L1(){if(Ty)return Do;Ty=1,Object.defineProperty(Do,"__esModule",{value:!0}),Do.ReplayableAudioNode=void 0;let i=class{constructor(u,o){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=u,this.privBytesPerSecond=o}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const u=this.privReplayOffset-this.privBufferStartOffset;let o=Math.round(u*this.privBytesPerSecond*1e-7);o%2!==0&&o++;let c=0;for(;c<this.privBuffers.length&&o>=this.privBuffers[c].chunk.buffer.byteLength;)o-=this.privBuffers[c++].chunk.buffer.byteLength;if(c<this.privBuffers.length){const a=this.privBuffers[c].chunk.buffer.slice(o);return this.privReplayOffset+=a.byteLength/this.privBytesPerSecond*1e7,c===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:a,isEnd:!1,timeReceived:this.privBuffers[c].chunk.timeReceived})}}return this.privAudioNode.read().then(u=>(u&&u.buffer&&(this.privBuffers.push(new t(u,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=u.buffer.byteLength),u))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(u){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=u;const o=u-this.privBufferStartOffset;let c=Math.round(o*this.privBytesPerSecond*1e-7),a=0;for(;a<this.privBuffers.length&&c>=this.privBuffers[a].chunk.buffer.byteLength;)c-=this.privBuffers[a++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(u-c/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(a)}findTimeAtOffset(u){if(u<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const o of this.privBuffers){const c=o.byteOffset/this.privBytesPerSecond*1e7,a=c+o.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(u>=c&&u<=a)return o.chunk.timeReceived}return 0}};Do.ReplayableAudioNode=i;class t{constructor(u,o,c){this.chunk=u,this.serial=o,this.byteOffset=c}}return Do}var jo={},Jp={},Hr={},pr={},Iy;function FR(){if(Iy)return pr;Iy=1;var i=pr&&pr.__createBinding||(Object.create?function(a,s,l,p){p===void 0&&(p=l),Object.defineProperty(a,p,{enumerable:!0,get:function(){return s[l]}})}:function(a,s,l,p){p===void 0&&(p=l),a[p]=s[l]}),t=pr&&pr.__setModuleDefault||(Object.create?function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}:function(a,s){a.default=s}),r=pr&&pr.__importStar||function(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var l in a)l!=="default"&&Object.hasOwnProperty.call(a,l)&&i(s,a,l);return t(s,a),s};Object.defineProperty(pr,"__esModule",{value:!0}),pr.AudioFileWriter=void 0;const u=r(Pi),o=ge();let c=class{constructor(s){o.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=u.openSync(s,"w")}set format(s){o.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=s;let l=0;this.privAudioFormat.hasHeader&&(l=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=u.createWriteStream("",{fd:this.privFd,start:l,autoClose:!1}))}write(s){o.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(s.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),u.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),u.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return pr.AudioFileWriter=c,pr}var $t={},Ay;function UR(){if(Ay)return $t;Ay=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.PullAudioInputStreamImpl=$t.PullAudioInputStream=$t.PushAudioInputStreamImpl=$t.PushAudioInputStream=$t.AudioInputStream=void 0;const i=te(),t=de(),r=Ei(),u=U(),o=Ti();let c=class{constructor(){}static createPushStream(v){return a.create(v)}static createPullStream(v,g){return l.create(v,g)}};$t.AudioInputStream=c;class a extends c{static create(v){return new s(v)}}$t.PushAudioInputStream=a;class s extends a{constructor(v){super(),v===void 0?this.privFormat=o.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=v,this.privEvents=new t.EventSource,this.privId=r.createNoDashGuid(),this.privStream=new t.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(v){this.privStream.writeStreamChunk({buffer:v,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(v){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,v)),await this.turnOn();const g=this.privStream;return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,v)),{detach:async()=>(this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,v)),this.turnOff()),id:()=>v,read:()=>g.read()}}detach(v){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,v))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:i.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:i.type.Stream})}onEvent(v){this.privEvents.onEvent(v),t.Events.instance.onEvent(v)}toBuffer(v){const g=Buffer.alloc(v.byteLength),m=new Uint8Array(v);for(let w=0;w<g.length;++w)g[w]=m[w];return g}}$t.PushAudioInputStreamImpl=s;class l extends c{constructor(){super()}static create(v,g){return new p(v,g)}}$t.PullAudioInputStream=l;class p extends l{constructor(v,g){super(),g===void 0?this.privFormat=u.AudioStreamFormat.getDefaultInputFormat():this.privFormat=g,this.privEvents=new t.EventSource,this.privId=r.createNoDashGuid(),this.privCallback=v,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(v){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,v)),await this.turnOn(),this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,v)),{detach:()=>(this.privCallback.close(),this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,v)),this.turnOff()),id:()=>v,read:()=>{let g=0,m;for(;g<this.privBufferSize;){const w=new ArrayBuffer(this.privBufferSize-g),C=this.privCallback.read(w);if(m===void 0?m=w:new Int8Array(m).set(new Int8Array(w),g),C===0)break;g+=C}return Promise.resolve({buffer:m.slice(0,g),isEnd:this.privIsClosed||g===0,timeReceived:Date.now()})}}}detach(v){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,v))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:i.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:i.type.Stream})}onEvent(v){this.privEvents.onEvent(v),t.Events.instance.onEvent(v)}}return $t.PullAudioInputStreamImpl=p,$t}var Wt={},No={},Gp={},by;function $R(){return by||(by=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SpeechSynthesisOutputFormat=void 0,function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",t[t.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",t[t.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",t[t.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",t[t.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",t[t.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",t[t.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",t[t.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",t[t.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",t[t.AmrWb16000Hz=37]="AmrWb16000Hz",t[t.G72216Khz64Kbps=38]="G72216Khz64Kbps"}(i.SpeechSynthesisOutputFormat||(i.SpeechSynthesisOutputFormat={}))}(Gp)),Gp}var ky;function fu(){if(ky)return No;ky=1,Object.defineProperty(No,"__esModule",{value:!0}),No.AudioOutputFormatImpl=void 0;const i=$R(),t=Ti();class r extends t.AudioStreamFormatImpl{constructor(o,c,a,s,l,p,h,v,g){super(a,p,c,o),this.formatTag=o,this.avgBytesPerSec=s,this.blockAlign=l,this.priAudioFormatString=h,this.priRequestAudioFormatString=v,this.priHasHeader=g}static fromSpeechSynthesisOutputFormat(o){return o===void 0?r.getDefaultOutputFormat():r.fromSpeechSynthesisOutputFormatString(r.SpeechSynthesisOutputFormatToString[o])}static fromSpeechSynthesisOutputFormatString(o){switch(o){case"raw-8khz-8bit-mono-mulaw":return new r(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,o,o,!1);case"riff-16khz-16kbps-mono-siren":return new r(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,o,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new r(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,o,o,!1);case"audio-16khz-32kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,4096,2,16,o,o,!1);case"audio-16khz-128kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,16384,2,16,o,o,!1);case"audio-16khz-64kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,8192,2,16,o,o,!1);case"audio-24khz-48kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,6144,2,16,o,o,!1);case"audio-24khz-96kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,12288,2,16,o,o,!1);case"audio-24khz-160kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,20480,2,16,o,o,!1);case"raw-16khz-16bit-mono-truesilk":return new r(t.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,o,o,!1);case"riff-8khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,o,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,o,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new r(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,o,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,o,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,o,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,o,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,o,o,!1);case"ogg-24khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,o,o,!1);case"raw-48khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,o,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,o,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,48e3,12288,2,16,o,o,!1);case"audio-48khz-192kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,48e3,24576,2,16,o,o,!1);case"ogg-48khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,o,o,!1);case"webm-16khz-16bit-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,o,o,!1);case"webm-24khz-16bit-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,o,o,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,o,o,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,16e3,4e3,2,16,o,o,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,24e3,6e3,2,16,o,o,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,24e3,3e3,2,16,o,o,!1);case"audio-24khz-16bit-mono-flac":return new r(t.AudioFormatTag.FLAC,1,24e3,24e3,2,16,o,o,!1);case"audio-48khz-16bit-mono-flac":return new r(t.AudioFormatTag.FLAC,1,48e3,3e4,2,16,o,o,!1);case"raw-24khz-16bit-mono-truesilk":return new r(t.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,o,o,!1);case"raw-8khz-8bit-mono-alaw":return new r(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,o,o,!1);case"riff-8khz-8bit-mono-alaw":return new r(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,o,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,22050,44100,2,16,o,o,!1);case"riff-22050hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,22050,44100,2,16,o,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,44100,88200,2,16,o,o,!1);case"riff-44100hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,44100,88200,2,16,o,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new r(t.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,o,o,!1);case"g722-16khz-64kbps":return new r(t.AudioFormatTag.G722,1,16e3,8e3,2,16,o,o,!1);case"riff-16khz-16bit-mono-pcm":default:return new r(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return r.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(o){if(this.priHasHeader){const c=new DataView(this.privHeader);c.setUint32(4,o+this.privHeader.byteLength-8,!0),c.setUint32(40,o,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(o){if(!this.hasHeader)return o;this.updateHeader(o.byteLength);const c=new Uint8Array(o.byteLength+this.header.byteLength);return c.set(new Uint8Array(this.header),0),c.set(new Uint8Array(o),this.header.byteLength),c.buffer}}return No.AudioOutputFormatImpl=r,r.SpeechSynthesisOutputFormatToString={[i.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[i.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[i.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[i.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[i.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[i.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[i.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[i.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[i.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[i.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[i.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[i.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[i.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[i.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[i.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[i.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[i.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[i.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[i.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[i.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[i.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},No}var Oy;function vs(){if(Oy)return Wt;Oy=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PushAudioOutputStreamImpl=Wt.PushAudioOutputStream=Wt.PullAudioOutputStreamImpl=Wt.PullAudioOutputStream=Wt.AudioOutputStream=void 0;const i=de(),t=ge(),r=fu();let u=class{constructor(){}static createPullStream(){return o.create()}};Wt.AudioOutputStream=u;class o extends u{static create(){return new c}}Wt.PullAudioOutputStream=o;class c extends o{constructor(){super(),this.privId=i.createNoDashGuid(),this.privStream=new i.Stream}set format(p){p==null&&(this.privFormat=r.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=p}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(p){const h=new Int8Array(p);let v=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>p.byteLength)return h.set(this.privLastChunkView.slice(0,p.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(p.byteLength),Promise.resolve(p.byteLength);h.set(this.privLastChunkView),v=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;v<p.byteLength&&!this.privStream.isReadEnded;){const g=await this.privStream.read();if(g!==void 0&&!g.isEnd){let m;g.buffer.byteLength>p.byteLength-v?(m=g.buffer.slice(0,p.byteLength-v),this.privLastChunkView=new Int8Array(g.buffer.slice(p.byteLength-v))):m=g.buffer,h.set(new Int8Array(m),v),v+=m.byteLength}else this.privStream.readEnded()}return v}write(p){t.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:p,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}Wt.PullAudioOutputStreamImpl=c;class a extends u{constructor(){super()}static create(p){return new s(p)}}Wt.PushAudioOutputStream=a;class s extends a{constructor(p){super(),this.privId=i.createNoDashGuid(),this.privCallback=p}set format(p){}write(p){this.privCallback.write&&this.privCallback.write(p)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return Wt.PushAudioOutputStreamImpl=s,Wt}var My;function HR(){if(My)return Hr;My=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.AudioOutputConfigImpl=Hr.AudioConfigImpl=Hr.AudioConfig=void 0;const i=lt(),t=ge(),r=U(),u=FR(),o=UR(),c=vs();let a=class WR{static fromDefaultMicrophoneInput(){const h=new i.PcmRecorder(!0);return new s(new i.MicAudioSource(h))}static fromMicrophoneInput(h){const v=new i.PcmRecorder(!0);return new s(new i.MicAudioSource(v,h))}static fromWavFileInput(h,v="unnamedBuffer.wav"){return new s(new i.FileAudioSource(h,v))}static fromStreamInput(h){if(h instanceof r.PullAudioInputStreamCallback)return new s(new o.PullAudioInputStreamImpl(h));if(h instanceof r.AudioInputStream)return new s(h);if(typeof MediaStream<"u"&&h instanceof MediaStream){const v=new i.PcmRecorder(!1);return new s(new i.MicAudioSource(v,null,null,h))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new l(new r.SpeakerAudioDestination)}static fromSpeakerOutput(h){if(h===void 0)return WR.fromDefaultSpeakerOutput();if(h instanceof r.SpeakerAudioDestination)return new l(h);throw new Error("Not Supported Type")}static fromAudioFileOutput(h){return new l(new u.AudioFileWriter(h))}static fromStreamOutput(h){if(h instanceof r.PushAudioOutputStreamCallback)return new l(new c.PushAudioOutputStreamImpl(h));if(h instanceof r.PushAudioOutputStream)return new l(h);if(h instanceof r.PullAudioOutputStream)return new l(h);throw new Error("Not Supported Type")}};Hr.AudioConfig=a;class s extends a{constructor(h){super(),this.privSource=h}get format(){return this.privSource.format}close(h,v){this.privSource.turnOff().then(()=>{h&&h()},g=>{v&&v(g)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(h){return this.privSource.attach(h)}detach(h){return this.privSource.detach(h)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(h,v){if(t.Contracts.throwIfNull(v,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(h,v);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(h,v){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(h,v);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}Hr.AudioConfigImpl=s;class l extends a{constructor(h){super(),this.privDestination=h}set format(h){this.privDestination.format=h}write(h){this.privDestination.write(h)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return Hr.AudioOutputConfigImpl=l,Hr}var Qp={},xy;function q1(){return xy||(xy=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.CancellationReason=void 0,function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"}(i.CancellationReason||(i.CancellationReason={}))}(Qp)),Qp}var zo={},Dy;function B1(){if(Dy)return zo;Dy=1,Object.defineProperty(zo,"__esModule",{value:!0}),zo.PullAudioInputStreamCallback=void 0;let i=class{};return zo.PullAudioInputStreamCallback=i,zo}var Lo={},jy;function F1(){if(jy)return Lo;jy=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.PushAudioOutputStreamCallback=void 0;let i=class{};return Lo.PushAudioOutputStreamCallback=i,Lo}var qo={},Ny;function U1(){if(Ny)return qo;Ny=1,Object.defineProperty(qo,"__esModule",{value:!0}),qo.KeywordRecognitionModel=void 0;const i=ge();let t=class{constructor(){this.privDisposed=!1}static fromFile(u){throw i.Contracts.throwIfFileDoesNotExist(u,"fileName"),new Error("Not yet implemented.")}static fromStream(u){throw i.Contracts.throwIfNull(u,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return qo.KeywordRecognitionModel=t,qo}var Bo={},zy;function $1(){if(zy)return Bo;zy=1,Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.SessionEventArgs=void 0;let i=class{constructor(r){this.privSessionId=r}get sessionId(){return this.privSessionId}};return Bo.SessionEventArgs=i,Bo}var Fo={},Ly;function W1(){if(Ly)return Fo;Ly=1,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.RecognitionEventArgs=void 0;const i=U();let t=class extends i.SessionEventArgs{constructor(u,o){super(o),this.privOffset=u}get offset(){return this.privOffset}};return Fo.RecognitionEventArgs=t,Fo}var Yp={},qy;function H1(){return qy||(qy=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.OutputFormat=void 0,function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"}(i.OutputFormat||(i.OutputFormat={}))}(Yp)),Yp}var Uo={},By;function V1(){if(By)return Uo;By=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.IntentRecognitionEventArgs=void 0;const i=U();let t=class extends i.RecognitionEventArgs{constructor(u,o,c){super(o,c),this.privResult=u}get result(){return this.privResult}};return Uo.IntentRecognitionEventArgs=t,Uo}var $o={},Fy;function K1(){if(Fy)return $o;Fy=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.RecognitionResult=void 0;let i=class{constructor(r,u,o,c,a,s,l,p,h,v){this.privResultId=r,this.privReason=u,this.privText=o,this.privDuration=c,this.privOffset=a,this.privLanguage=s,this.privLanguageDetectionConfidence=l,this.privErrorDetails=p,this.privJson=h,this.privProperties=v}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return $o.RecognitionResult=i,$o}var Wo={},Uy;function J1(){if(Uy)return Wo;Uy=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.SpeechRecognitionResult=void 0;const i=U();let t=class extends i.RecognitionResult{constructor(u,o,c,a,s,l,p,h,v,g,m){super(u,o,c,a,s,l,p,v,g,m),this.privSpeakerId=h}get speakerId(){return this.privSpeakerId}};return Wo.SpeechRecognitionResult=t,Wo}var Ho={},$y;function G1(){if($y)return Ho;$y=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.IntentRecognitionResult=void 0;const i=U();let t=class extends i.SpeechRecognitionResult{constructor(u,o,c,a,s,l,p,h,v,g,m){super(o,c,a,s,l,p,h,void 0,v,g,m),this.privIntentId=u}get intentId(){return this.privIntentId}};return Ho.IntentRecognitionResult=t,Ho}var ri={},Wy;function Q1(){if(Wy)return ri;Wy=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.LanguageUnderstandingModelImpl=ri.LanguageUnderstandingModel=void 0;const i=ge();let t=class{constructor(){}static fromEndpoint(o){i.Contracts.throwIfNull(o,"uri"),i.Contracts.throwIfNullOrWhitespace(o.hostname,"uri");const c=new r,a=o.host.indexOf(".");if(a===-1)throw new Error("Could not determine region from endpoint");c.region=o.host.substr(0,a);const s=o.pathname.lastIndexOf("/")+1;if(s===-1)throw new Error("Could not determine appId from endpoint");if(c.appId=o.pathname.substr(s),c.subscriptionKey=o.searchParams.get("subscription-key"),c.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return c}static fromAppId(o){i.Contracts.throwIfNullOrWhitespace(o,"appId");const c=new r;return c.appId=o,c}static fromSubscription(o,c,a){i.Contracts.throwIfNullOrWhitespace(o,"subscriptionKey"),i.Contracts.throwIfNullOrWhitespace(c,"appId"),i.Contracts.throwIfNullOrWhitespace(a,"region");const s=new r;return s.appId=c,s.region=a,s.subscriptionKey=o,s}};ri.LanguageUnderstandingModel=t;class r extends t{}return ri.LanguageUnderstandingModelImpl=r,ri}var Vr={},Hy;function Y1(){if(Hy)return Vr;Hy=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.MeetingTranscriptionEventArgs=Vr.ConversationTranscriptionEventArgs=Vr.SpeechRecognitionEventArgs=void 0;const i=U();let t=class extends i.RecognitionEventArgs{constructor(c,a,s){super(a,s),this.privResult=c}get result(){return this.privResult}};Vr.SpeechRecognitionEventArgs=t;class r extends i.RecognitionEventArgs{constructor(c,a,s){super(a,s),this.privResult=c}get result(){return this.privResult}}Vr.ConversationTranscriptionEventArgs=r;class u extends t{}return Vr.MeetingTranscriptionEventArgs=u,Vr}var Vo={},Ko={},Vy;function vu(){if(Vy)return Ko;Vy=1,Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.CancellationEventArgsBase=void 0;const i=U();let t=class extends i.RecognitionEventArgs{constructor(u,o,c,a,s){super(a,s),this.privReason=u,this.privErrorDetails=o,this.privErrorCode=c}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Ko.CancellationEventArgsBase=t,Ko}var Ky;function X1(){if(Ky)return Vo;Ky=1,Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.SpeechRecognitionCanceledEventArgs=void 0;const i=vu();let t=class extends i.CancellationEventArgsBase{};return Vo.SpeechRecognitionCanceledEventArgs=t,Vo}var Jo={},Jy;function Z1(){if(Jy)return Jo;Jy=1,Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.TranslationRecognitionEventArgs=void 0;const i=U();let t=class extends i.RecognitionEventArgs{constructor(u,o,c){super(o,c),this.privResult=u}get result(){return this.privResult}};return Jo.TranslationRecognitionEventArgs=t,Jo}var Go={},Gy;function eI(){if(Gy)return Go;Gy=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.TranslationSynthesisEventArgs=void 0;const i=U();let t=class extends i.SessionEventArgs{constructor(u,o){super(o),this.privResult=u}get result(){return this.privResult}};return Go.TranslationSynthesisEventArgs=t,Go}var Qo={},Qy;function KR(){if(Qy)return Qo;Qy=1,Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.TranslationRecognitionResult=void 0;const i=U();let t=class VR extends i.SpeechRecognitionResult{constructor(u,o,c,a,s,l,p,h,v,g,m){super(o,c,a,s,l,p,h,void 0,v,g,m),this.privTranslations=u}static fromSpeechRecognitionResult(u){return new VR(void 0,u.resultId,u.reason,u.text,u.duration,u.offset,u.language,u.languageDetectionConfidence,u.errorDetails,u.json,u.properties)}get translations(){return this.privTranslations}};return Qo.TranslationRecognitionResult=t,Qo}var Yo={},Yy;function tI(){if(Yy)return Yo;Yy=1,Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.TranslationSynthesisResult=void 0;let i=class{constructor(r,u){this.privReason=r,this.privAudio=u}get audio(){return this.privAudio}get reason(){return this.privReason}};return Yo.TranslationSynthesisResult=i,Yo}var Xp={},Xy;function rI(){return Xy||(Xy=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ResultReason=void 0,function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.RecognizingIntent=5]="RecognizingIntent",t[t.RecognizedIntent=6]="RecognizedIntent",t[t.TranslatingSpeech=7]="TranslatingSpeech",t[t.TranslatedSpeech=8]="TranslatedSpeech",t[t.SynthesizingAudio=9]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",t[t.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",t[t.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",t[t.RecognizedSpeakers=14]="RecognizedSpeakers",t[t.RecognizedSpeaker=15]="RecognizedSpeaker",t[t.ResetVoiceProfile=16]="ResetVoiceProfile",t[t.DeletedVoiceProfile=17]="DeletedVoiceProfile",t[t.VoicesListRetrieved=18]="VoicesListRetrieved",t[t.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",t[t.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",t[t.TranslatedInstantMessage=21]="TranslatedInstantMessage",t[t.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(i.ResultReason||(i.ResultReason={}))}(Xp)),Xp}var ni={},Zy;function nI(){if(Zy)return ni;Zy=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.SpeechConfigImpl=ni.SpeechConfig=void 0;const i=te(),t=ge(),r=U();let u=class{constructor(){}static fromSubscription(a,s){t.Contracts.throwIfNullOrWhitespace(a,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(s,"region");const l=new o;return l.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),l.setProperty(r.PropertyId.SpeechServiceConnection_IntentRegion,s),l.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),l}static fromEndpoint(a,s){t.Contracts.throwIfNull(a,"endpoint");const l=new o;return l.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,a.href),s!==void 0&&l.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),l}static fromHost(a,s){t.Contracts.throwIfNull(a,"hostName");const l=new o;return l.setProperty(r.PropertyId.SpeechServiceConnection_Host,a.protocol+"//"+a.hostname+(a.port===""?"":":"+a.port)),s!==void 0&&l.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),l}static fromAuthorizationToken(a,s){t.Contracts.throwIfNull(a,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(s,"region");const l=new o;return l.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),l.setProperty(r.PropertyId.SpeechServiceConnection_IntentRegion,s),l.authorizationToken=a,l}close(){}};ni.SpeechConfig=u;class o extends u{constructor(){super(),this.privProperties=new r.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=r.OutputFormat.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,a)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,a)}get outputFormat(){return r.OutputFormat[this.privProperties.getProperty(i.OutputFormatPropertyName,void 0)]}set outputFormat(a){this.privProperties.setProperty(i.OutputFormatPropertyName,r.OutputFormat[a])}get endpointId(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,a)}setProperty(a,s){t.Contracts.throwIfNull(s,"value"),this.privProperties.setProperty(a,s)}getProperty(a,s){return this.privProperties.getProperty(a,s)}setProxy(a,s,l,p){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],a),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],s),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],p)}setServiceProperty(a,s){const l=JSON.parse(this.privProperties.getProperty(i.ServicePropertiesPropertyName,"{}"));l[a]=s,this.privProperties.setProperty(i.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[a])}enableAudioLogging(){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(i.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(i.ForceDictationPropertyName,"true")}clone(){const a=new o;return a.privProperties=this.privProperties.clone(),a}get speechSynthesisLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,a)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,a)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(a){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[a])}}return ni.SpeechConfigImpl=o,ni}var ii={},eS;function iI(){if(eS)return ii;eS=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.SpeechTranslationConfigImpl=ii.SpeechTranslationConfig=void 0;const i=te(),t=ge(),r=U();let u=class extends r.SpeechConfig{constructor(){super()}static fromSubscription(a,s){t.Contracts.throwIfNullOrWhitespace(a,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(s,"region");const l=new o;return l.properties.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),l.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),l}static fromAuthorizationToken(a,s){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(s,"region");const l=new o;return l.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a),l.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),l}static fromHost(a,s){t.Contracts.throwIfNull(a,"hostName");const l=new o;return l.setProperty(r.PropertyId.SpeechServiceConnection_Host,a.protocol+"//"+a.hostname+(a.port===""?"":":"+a.port)),s!==void 0&&l.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),l}static fromEndpoint(a,s){t.Contracts.throwIfNull(a,"endpoint"),t.Contracts.throwIfNull(s,"subscriptionKey");const l=new o;return l.properties.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,a.href),l.properties.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),l}};ii.SpeechTranslationConfig=u;class o extends u{constructor(){super(),this.privSpeechProperties=new r.PropertyCollection,this.outputFormat=r.OutputFormat.Simple}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}set speechRecognitionLanguage(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,a)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return r.OutputFormat[this.privSpeechProperties.getProperty(i.OutputFormatPropertyName,void 0)]}set outputFormat(a){this.privSpeechProperties.setProperty(i.OutputFormatPropertyName,r.OutputFormat[a])}get endpointId(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,a)}addTargetLanguage(a){t.Contracts.throwIfNullOrWhitespace(a,"value");const s=this.targetLanguages;s.includes(a)||(s.push(a),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,s.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,a)}get region(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}setProxy(a,s,l,p){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],a),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],s),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],l),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],p)}getProperty(a,s){return this.privSpeechProperties.getProperty(a,s)}setProperty(a,s){this.privSpeechProperties.setProperty(a,s)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(a,s){const l=JSON.parse(this.privSpeechProperties.getProperty(i.ServicePropertiesPropertyName,"{}"));l[a]=s,this.privSpeechProperties.setProperty(i.ServicePropertiesPropertyName,JSON.stringify(l))}setProfanity(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[a])}enableAudioLogging(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(i.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,a)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,a)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(a){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[a])}}return ii.SpeechTranslationConfigImpl=o,ii}var Xo={},tS;function GR(){if(tS)return Xo;tS=1,Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.PropertyCollection=void 0;const i=U();let t=class JR{constructor(){this.privKeys=[],this.privValues=[]}getProperty(u,o){let c;typeof u=="string"?c=u:c=i.PropertyId[u];for(let a=0;a<this.privKeys.length;a++)if(this.privKeys[a]===c)return this.privValues[a];if(o!==void 0)return String(o)}setProperty(u,o){let c;typeof u=="string"?c=u:c=i.PropertyId[u];for(let a=0;a<this.privKeys.length;a++)if(this.privKeys[a]===c){this.privValues[a]=o;return}this.privKeys.push(c),this.privValues.push(o)}clone(){const u=new JR;for(let o=0;o<this.privKeys.length;o++)u.privKeys.push(this.privKeys[o]),u.privValues.push(this.privValues[o]);return u}mergeTo(u){this.privKeys.forEach(o=>{if(u.getProperty(o,void 0)===void 0){const c=this.getProperty(o);u.setProperty(o,c)}})}get keys(){return this.privKeys}};return Xo.PropertyCollection=t,Xo}var Zp={},rS;function rf(){return rS||(rS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.PropertyId=void 0,function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",t[t.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=16]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=25]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",t[t.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",t[t.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",t[t.Speech_SegmentationMaximumTimeMs=33]="Speech_SegmentationMaximumTimeMs",t[t.Speech_SegmentationStrategy=34]="Speech_SegmentationStrategy",t[t.SpeechServiceConnection_EnableAudioLogging=35]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceConnection_LanguageIdMode=36]="SpeechServiceConnection_LanguageIdMode",t[t.SpeechServiceConnection_RecognitionEndpointVersion=37]="SpeechServiceConnection_RecognitionEndpointVersion",t[t.SpeechServiceConnection_SpeakerIdMode=38]="SpeechServiceConnection_SpeakerIdMode",t[t.SpeechServiceResponse_ProfanityOption=39]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=40]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=41]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=42]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=43]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=44]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.SpeechServiceResponse_RequestWordBoundary=45]="SpeechServiceResponse_RequestWordBoundary",t[t.SpeechServiceResponse_RequestPunctuationBoundary=46]="SpeechServiceResponse_RequestPunctuationBoundary",t[t.SpeechServiceResponse_RequestSentenceBoundary=47]="SpeechServiceResponse_RequestSentenceBoundary",t[t.SpeechServiceResponse_DiarizeIntermediateResults=48]="SpeechServiceResponse_DiarizeIntermediateResults",t[t.Conversation_ApplicationId=49]="Conversation_ApplicationId",t[t.Conversation_DialogType=50]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=51]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=52]="Conversation_From_Id",t[t.Conversation_Conversation_Id=53]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=54]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=55]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=56]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=57]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=58]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=59]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=60]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=61]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=62]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=63]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=64]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=65]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=66]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=67]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=68]="PronunciationAssessment_Params",t[t.SpeakerRecognition_Api_Version=69]="SpeakerRecognition_Api_Version",t[t.WebWorkerLoadType=70]="WebWorkerLoadType",t[t.TalkingAvatarService_WebRTC_SDP=71]="TalkingAvatarService_WebRTC_SDP"}(i.PropertyId||(i.PropertyId={}))}(Zp)),Zp}var Zo={},nS;function sI(){if(nS)return Zo;nS=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.Recognizer=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class QR{constructor(a,s,l){this.audioConfig=a!==void 0?a:u.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=s.clone(),this.privConnectionFactory=l,this.implCommonRecognizerSetup()}close(a,s){r.Contracts.throwIfDisposed(this.privDisposed),t.marshalPromiseToCallbacks(this.dispose(!0),a,s)}get internalData(){return this.privReco}async dispose(a){this.privDisposed||(this.privDisposed=!0,a&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return i.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(a){i.ServiceRecognizerBase.telemetryDataEnabled=a}implCommonRecognizerSetup(){let a=typeof window<"u"?"Browser":"Node",s="unknown",l="unknown";typeof navigator<"u"&&(a=a+"/"+navigator.platform,s=navigator.userAgent,l=navigator.appVersion);const p=this.createRecognizerConfig(new i.SpeechServiceConfig(new i.Context(new i.OS(a,s,l))));this.privReco=this.createServiceRecognizer(QR.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,p)}async recognizeOnceAsyncImpl(a){r.Contracts.throwIfDisposed(this.privDisposed);const s=new t.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(a,s.resolve,s.reject);const l=await s.promise;return await this.implRecognizerStop(),l}async startContinuousRecognitionAsyncImpl(a){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(a,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuthFromProperties(a){const s=a.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0);return s&&s!==""?new i.CognitiveSubscriptionKeyAuthentication(s):new i.CognitiveTokenAuthentication(()=>{const p=a.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(p)},()=>{const p=a.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(p)})}};return Zo.Recognizer=o,Zo}var ea={},iS;function oI(){if(iS)return ea;iS=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.SpeechRecognizer=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class YR extends u.Recognizer{constructor(a,s){const l=a;r.Contracts.throwIfNull(l,"speechConfig"),r.Contracts.throwIfNullOrWhitespace(l.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage),u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),super(s,l.properties,new i.SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(a,s,l){const p=a;return s.properties.mergeTo(p.properties),new YR(a,l)}get endpointId(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.OutputFormatPropertyName,u.OutputFormat[u.OutputFormat.Simple])===u.OutputFormat[u.OutputFormat.Simple]?u.OutputFormat.Simple:u.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(a,s){t.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(i.RecognitionMode.Interactive),a,s)}startContinuousRecognitionAsync(a,s){t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),a,s)}stopContinuousRecognitionAsync(a,s){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,s)}startKeywordRecognitionAsync(a,s,l){r.Contracts.throwIfNull(a,"model"),l&&l("Not yet implemented.")}stopKeywordRecognitionAsync(a){a&&a()}close(a,s){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),a,s)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new i.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,s,l,p){const h=l;return new i.SpeechServiceRecognizer(a,s,h,p,this)}};return ea.SpeechRecognizer=o,ea}var ta={},sS;function aI(){if(sS)return ta;sS=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.IntentRecognizer=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class extends u.Recognizer{constructor(a,s){r.Contracts.throwIfNullOrUndefined(a,"speechConfig");const l=a;r.Contracts.throwIfNullOrUndefined(l,"speechConfig"),super(s,l.properties,new i.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=l.properties,r.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage),u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}recognizeOnceAsync(a,s){if(r.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const l=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",l.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(l.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}t.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(i.RecognitionMode.Interactive),a,s)}startContinuousRecognitionAsync(a,s){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const l=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",l.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(l.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),a,s)}stopContinuousRecognitionAsync(a,s){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,s)}startKeywordRecognitionAsync(a,s,l){r.Contracts.throwIfNull(a,"model"),l&&l("Not yet implemented.")}stopKeywordRecognitionAsync(a,s){if(a)try{a()}catch(l){s&&s(l)}}addIntent(a,s){r.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),r.Contracts.throwIfNullOrWhitespace(s,"intentId"),r.Contracts.throwIfNullOrWhitespace(a,"simplePhrase"),this.privAddedIntents.push([s,a])}addIntentWithLanguageModel(a,s,l){r.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),r.Contracts.throwIfNullOrWhitespace(a,"intentId"),r.Contracts.throwIfNull(s,"model");const p=s;r.Contracts.throwIfNullOrWhitespace(p.appId,"model.appId"),this.privAddedLmIntents[a]=new i.AddedLmIntent(p,l)}addAllIntents(a,s){r.Contracts.throwIfNull(a,"model");const l=a;r.Contracts.throwIfNullOrWhitespace(l.appId,"model.appId"),this.privUmbrellaIntent=new i.AddedLmIntent(l,s)}close(a,s){r.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),a,s)}createRecognizerConfig(a){return new i.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,s,l,p){const h=l;return new i.IntentServiceRecognizer(a,s,h,p,this)}async dispose(a){this.privDisposedIntentRecognizer||a&&(this.privDisposedIntentRecognizer=!0,await super.dispose(a))}buildSpeechContext(){let a,s,l;const p=[];this.privUmbrellaIntent!==void 0&&(a=this.privUmbrellaIntent.modelImpl.appId,s=this.privUmbrellaIntent.modelImpl.region,l=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const h of Object.keys(this.privAddedLmIntents)){const v=this.privAddedLmIntents[h];if(a===void 0)a=v.modelImpl.appId;else if(a!==v.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(s===void 0)s=v.modelImpl.region;else if(s!==v.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(l===void 0)l=v.modelImpl.subscriptionKey;else if(l!==v.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const g="luis/"+a+"-PRODUCTION#"+h;p.push(g)}return{Intent:{id:a,key:l===void 0?this.privProperties.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_Key]):l,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?p:["luis/"+a+"-PRODUCTION"]}}};return ta.IntentRecognizer=o,ta}var eh={},oS;function cI(){return oS||(oS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.VoiceProfileType=void 0,function(t){t[t.TextIndependentIdentification=0]="TextIndependentIdentification",t[t.TextDependentVerification=1]="TextDependentVerification",t[t.TextIndependentVerification=2]="TextIndependentVerification"}(i.VoiceProfileType||(i.VoiceProfileType={}))}(eh)),eh}var ra={},na={},si={},aS;function XR(){if(aS)return si;aS=1,Object.defineProperty(si,"__esModule",{value:!0}),si.ConnectionMessageImpl=si.ConnectionMessage=void 0;const i=Pt(),t=de(),r=GR(),u=rf();let o=class{};si.ConnectionMessage=o;class c{constructor(s){this.privConnectionMessage=s,this.privProperties=new r.PropertyCollection,this.privConnectionMessage.headers[i.HeaderNames.ConnectionId]&&this.privProperties.setProperty(u.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[i.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(l=>{this.privProperties.setProperty(l,this.privConnectionMessage.headers[l])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(s=>s.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===t.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===t.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return si.ConnectionMessageImpl=c,si}var cS;function ZR(){if(cS)return na;cS=1,Object.defineProperty(na,"__esModule",{value:!0}),na.Connection=void 0;const i=te(),t=de(),r=XR(),u=ge(),o=U();let c=class Fh{static fromRecognizer(s){const l=s.internalData,p=new Fh;return p.privInternalData=l,p.setupEvents(),p}static fromSynthesizer(s){const l=s.internalData,p=new Fh;return p.privInternalData=l,p.setupEvents(),p}openConnection(s,l){t.marshalPromiseToCallbacks(this.privInternalData.connect(),s,l)}closeConnection(s,l){if(this.privInternalData instanceof i.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");t.marshalPromiseToCallbacks(this.privInternalData.disconnect(),s,l)}setMessageProperty(s,l,p){if(u.Contracts.throwIfNullOrWhitespace(l,"propertyName"),this.privInternalData instanceof i.ServiceRecognizerBase){if(s.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(l,p)}else if(this.privInternalData instanceof i.SynthesisAdapterBase){if(s.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(l,p)}}sendMessageAsync(s,l,p,h){t.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(s,l),p,h)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(s=>{s.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new o.ConnectionEventArgs(s.connectionId)):s.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new o.ConnectionEventArgs(s.connectionId)):s.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new o.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(s.message))):s.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new o.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(s.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(s=>{this.receivedServiceMessage&&this.receivedServiceMessage(new o.ServiceEventArgs(s.jsonString,s.name))})}};return na.Connection=c,na}var uS;function uI(){if(uS)return ra;uS=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.TranslationRecognizer=void 0;const i=te(),t=de(),r=ZR(),u=ge(),o=U();let c=class eP extends o.Recognizer{constructor(s,l,p){const h=s;u.Contracts.throwIfNull(h,"speechConfig"),super(l,h.properties,p||new i.TranslationConnectionFactory),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice),o.PropertyId[o.PropertyId.SpeechServiceConnection_TranslationVoice]),u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages),o.PropertyId[o.PropertyId.SpeechServiceConnection_TranslationToLanguages]),u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage),o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(s,l,p){const h=s;return l.properties.mergeTo(h.properties),l.properties.getProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===i.AutoDetectSourceLanguagesOpenRangeOptionName&&h.properties.setProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new eP(s,p)}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,s)}recognizeOnceAsync(s,l){u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),t.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(i.RecognitionMode.Interactive),s,l)}startContinuousRecognitionAsync(s,l){t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),s,l)}stopContinuousRecognitionAsync(s,l){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),s,l)}removeTargetLanguage(s){if(u.Contracts.throwIfNullOrUndefined(s,"language to be removed"),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const l=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),p=l.indexOf(s);p>-1&&(l.splice(p,1),this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,l.join(",")),this.updateLanguages(l))}}addTargetLanguage(s){u.Contracts.throwIfNullOrUndefined(s,"language to be added");let l=[];this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(l=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),l.includes(s)||(l.push(s),this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,l.join(",")))):(this.properties.setProperty(o.PropertyId.SpeechServiceConnection_TranslationToLanguages,s),l=[s]),this.updateLanguages(l)}close(s,l){u.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),s,l)}onConnection(){}async dispose(s){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,s&&(await this.implRecognizerStop(),await super.dispose(s)))}createRecognizerConfig(s){return new i.RecognizerConfig(s,this.privProperties)}createServiceRecognizer(s,l,p,h){const v=p;return new i.TranslationServiceRecognizer(s,l,v,h,this)}updateLanguages(s){const l=r.Connection.fromRecognizer(this);l&&(l.setMessageProperty("speech.context","translationcontext",{to:s}),l.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:s})))}};return ra.TranslationRecognizer=c,ra}var ia={},lS;function lI(){if(lS)return ia;lS=1,Object.defineProperty(ia,"__esModule",{value:!0}),ia.Translations=void 0;const i=U();let t=class{constructor(){this.privMap=new i.PropertyCollection}get languages(){return this.privMap.keys}get(u,o){return this.privMap.getProperty(u,o)}set(u,o){this.privMap.setProperty(u,o)}};return ia.Translations=t,ia}var th={},dS;function dI(){return dS||(dS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.NoMatchReason=void 0,function(t){t[t.NotRecognized=0]="NotRecognized",t[t.InitialSilenceTimeout=1]="InitialSilenceTimeout",t[t.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(i.NoMatchReason||(i.NoMatchReason={}))}(th)),th}var sa={},pS;function pI(){if(pS)return sa;pS=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.NoMatchDetails=void 0;const i=te(),t=U();let r=class tP{constructor(o){this.privReason=o}static fromResult(o){const c=i.SimpleSpeechPhrase.fromJSON(o.json,0);let a=t.NoMatchReason.NotRecognized;switch(c.RecognitionStatus){case i.RecognitionStatus.BabbleTimeout:a=t.NoMatchReason.InitialBabbleTimeout;break;case i.RecognitionStatus.InitialSilenceTimeout:a=t.NoMatchReason.InitialSilenceTimeout;break;default:a=t.NoMatchReason.NotRecognized;break}return new tP(a)}get reason(){return this.privReason}};return sa.NoMatchDetails=r,sa}var oa={},hS;function hI(){if(hS)return oa;hS=1,Object.defineProperty(oa,"__esModule",{value:!0}),oa.TranslationRecognitionCanceledEventArgs=void 0;let i=class{constructor(r,u,o,c,a){this.privCancelReason=u,this.privErrorDetails=o,this.privResult=a,this.privSessionId=r,this.privErrorCode=c}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return oa.TranslationRecognitionCanceledEventArgs=i,oa}var aa={},fS;function fI(){if(fS)return aa;fS=1,Object.defineProperty(aa,"__esModule",{value:!0}),aa.IntentRecognitionCanceledEventArgs=void 0;const i=U();let t=class extends i.IntentRecognitionEventArgs{constructor(u,o,c,a,s,l){super(a,s,l),this.privReason=u,this.privErrorDetails=o,this.privErrorCode=c}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return aa.IntentRecognitionCanceledEventArgs=t,aa}var ca={},vS;function rP(){if(vS)return ca;vS=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.CancellationDetailsBase=void 0;let i=class{constructor(r,u,o){this.privReason=r,this.privErrorDetails=u,this.privErrorCode=o}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return ca.CancellationDetailsBase=i,ca}var ua={},gS;function vI(){if(gS)return ua;gS=1,Object.defineProperty(ua,"__esModule",{value:!0}),ua.CancellationDetails=void 0;const i=te(),t=rP(),r=U();let u=class nP extends t.CancellationDetailsBase{constructor(c,a,s){super(c,a,s)}static fromResult(c){let a=r.CancellationReason.Error,s=r.CancellationErrorCode.NoError;if(c instanceof r.RecognitionResult&&c.json){const l=i.SimpleSpeechPhrase.fromJSON(c.json,0);a=i.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus)}return c.properties&&(s=r.CancellationErrorCode[c.properties.getProperty(i.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new nP(a,c.errorDetails||i.EnumTranslation.implTranslateErrorDetails(s),s)}};return ua.CancellationDetails=u,ua}var rh={},mS;function gI(){return mS||(mS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.CancellationErrorCode=void 0,function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError",t[t.Forbidden=8]="Forbidden"}(i.CancellationErrorCode||(i.CancellationErrorCode={}))}(rh)),rh}var la={},yS;function mI(){if(yS)return la;yS=1,Object.defineProperty(la,"__esModule",{value:!0}),la.ConnectionEventArgs=void 0;const i=U();let t=class extends i.SessionEventArgs{};return la.ConnectionEventArgs=t,la}var da={},SS;function yI(){if(SS)return da;SS=1,Object.defineProperty(da,"__esModule",{value:!0}),da.ServiceEventArgs=void 0;const i=U();let t=class extends i.SessionEventArgs{constructor(u,o,c){super(c),this.privJsonResult=u,this.privEventName=o}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return da.ServiceEventArgs=t,da}var pa={},CS;function SI(){if(CS)return pa;CS=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.PhraseListGrammar=void 0;let i=class iP{constructor(r){this.privGrammerBuilder=r.dynamicGrammar}static fromRecognizer(r){const u=r.internalData;return new iP(u)}addPhrase(r){this.privGrammerBuilder.addPhrase(r)}addPhrases(r){this.privGrammerBuilder.addPhrase(r)}clear(){this.privGrammerBuilder.clearPhrases()}};return pa.PhraseListGrammar=i,pa}var oi={},wS;function nf(){if(wS)return oi;wS=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.DialogServiceConfigImpl=oi.DialogServiceConfig=void 0;const i=ge(),t=U();let r=class{constructor(){}set applicationId(c){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};oi.DialogServiceConfig=r;class u extends r{constructor(){super(),this.privSpeechConfig=new t.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(c){i.Contracts.throwIfNullOrWhitespace(c,"value"),this.privSpeechConfig.speechRecognitionLanguage=c}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(c){this.privSpeechConfig.outputFormat=c}setProperty(c,a){this.privSpeechConfig.setProperty(c,a)}getProperty(c,a){return this.privSpeechConfig.getProperty(c)}setProxy(c,a,s,l){this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName,c),this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPort,`${a}`),s&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName,s),l&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword,l)}setServiceProperty(c,a,s){this.privSpeechConfig.setServiceProperty(c,a)}close(){}}return oi.DialogServiceConfigImpl=u,oi}var ha={},RS;function CI(){if(RS)return ha;RS=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.BotFrameworkConfig=void 0;const i=ge(),t=nf(),r=U();let u=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(c,a,s){i.Contracts.throwIfNullOrWhitespace(c,"subscription"),i.Contracts.throwIfNullOrWhitespace(a,"region");const l=new t.DialogServiceConfigImpl;return l.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(r.PropertyId.SpeechServiceConnection_Key,c),l.setProperty(r.PropertyId.SpeechServiceConnection_Region,a),s&&l.setProperty(r.PropertyId.Conversation_ApplicationId,s),l}static fromAuthorizationToken(c,a,s){i.Contracts.throwIfNullOrWhitespace(c,"authorizationToken"),i.Contracts.throwIfNullOrWhitespace(a,"region");const l=new t.DialogServiceConfigImpl;return l.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),l.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,c),l.setProperty(r.PropertyId.SpeechServiceConnection_Region,a),s&&l.setProperty(r.PropertyId.Conversation_ApplicationId,s),l}static fromHost(c,a,s){i.Contracts.throwIfNullOrUndefined(c,"host");const l=c instanceof URL?c:new URL(`wss://${c}.convai.speech.azure.us`);i.Contracts.throwIfNullOrUndefined(l,"resolvedHost");const p=new t.DialogServiceConfigImpl;return p.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),p.setProperty(r.PropertyId.SpeechServiceConnection_Host,l.toString()),a!==void 0&&p.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),p}static fromEndpoint(c,a){i.Contracts.throwIfNull(c,"endpoint");const s=new t.DialogServiceConfigImpl;return s.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,c.toString()),a!==void 0&&s.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),s}};return ha.BotFrameworkConfig=u,ha}var fa={},PS;function wI(){if(PS)return fa;PS=1,Object.defineProperty(fa,"__esModule",{value:!0}),fa.CustomCommandsConfig=void 0;const i=ge(),t=nf(),r=U();let u=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(c,a,s){i.Contracts.throwIfNullOrWhitespace(c,"applicationId"),i.Contracts.throwIfNullOrWhitespace(a,"subscription"),i.Contracts.throwIfNullOrWhitespace(s,"region");const l=new t.DialogServiceConfigImpl;return l.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(r.PropertyId.Conversation_ApplicationId,c),l.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),l.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),l}static fromAuthorizationToken(c,a,s){i.Contracts.throwIfNullOrWhitespace(c,"applicationId"),i.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),i.Contracts.throwIfNullOrWhitespace(s,"region");const l=new t.DialogServiceConfigImpl;return l.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),l.setProperty(r.PropertyId.Conversation_ApplicationId,c),l.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a),l.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),l}set applicationId(c){i.Contracts.throwIfNullOrWhitespace(c,"value"),this.setProperty(r.PropertyId.Conversation_ApplicationId,c)}get applicationId(){return this.getProperty(r.PropertyId.Conversation_ApplicationId)}};return fa.CustomCommandsConfig=u,fa}var va={},ga={},ma={},ya={},_S;function kn(){if(_S)return ya;_S=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.QueryParameterNames=void 0;let i=class{};return ya.QueryParameterNames=i,i.BotId="botid",i.CustomSpeechDeploymentId="cid",i.CustomVoiceDeploymentId="deploymentId",i.EnableAudioLogging="storeAudio",i.EnableLanguageId="lidEnabled",i.EnableWordLevelTimestamps="wordLevelTimestamps",i.EndSilenceTimeoutMs="endSilenceTimeoutMs",i.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",i.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",i.SegmentationStrategy="segmentationStrategy",i.Format="format",i.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",i.Language="language",i.Profanity="profanity",i.RequestBotStatusMessages="enableBotMessageStatus",i.StableIntermediateThreshold="stableIntermediateThreshold",i.StableTranslation="stableTranslation",i.TestHooks="testhooks",i.Postprocessing="postprocessing",i.CtsMeetingId="meetingId",i.CtsDeviceId="deviceId",i.CtsIsParticipant="isParticipant",i.EnableAvatar="enableTalkingAvatar",ya}var ES;function vr(){if(ES)return ma;ES=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.ConnectionFactoryBase=void 0;const i=te(),t=U(),r=kn();let u=class{static getHostSuffix(c){if(c){if(c.toLowerCase().startsWith("china"))return".azure.cn";if(c.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(c,a,s){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,r.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,r.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,r.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,r.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,r.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,r.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,r.QueryParameterNames.EnableWordLevelTimestamps],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,r.QueryParameterNames.StableIntermediateThreshold]]).forEach((h,v)=>{this.setUrlParameter(v,h,c,a,s)});const p=JSON.parse(c.parameters.getProperty(i.ServicePropertiesPropertyName,"{}"));Object.keys(p).forEach(h=>{a[h]=p[h]})}setUrlParameter(c,a,s,l,p){const h=s.parameters.getProperty(c,void 0);h&&(!p||p.search(a)===-1)&&(l[a]=h.toLocaleLowerCase())}};return ma.ConnectionFactoryBase=u,ma}var TS;function RI(){if(TS)return ga;TS=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.DialogConnectionFactory=void 0;const i=lt(),t=te(),r=U(),u=vr(),o=te(),c=Pt(),a=kn();class s extends u.ConnectionFactoryBase{create(p,h,v){const g=p.parameters.getProperty(r.PropertyId.Conversation_ApplicationId,""),m=p.parameters.getProperty(r.PropertyId.Conversation_DialogType),w=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),C=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),R=p.parameters.getProperty(r.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),_={};_[c.HeaderNames.ConnectionId]=v,_[a.QueryParameterNames.Format]=p.parameters.getProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase(),_[a.QueryParameterNames.Language]=C,_[a.QueryParameterNames.RequestBotStatusMessages]=R,g&&(_[a.QueryParameterNames.BotId]=g,m===r.DialogServiceConfig.DialogTypes.CustomCommands&&(_[c.HeaderNames.CustomCommandsAppId]=g));const E=m===r.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",T=m===r.DialogServiceConfig.DialogTypes.CustomCommands?"v1":m===r.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",D={};h.token!=null&&h.token!==""&&(D[h.headerName]=h.token);let N=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,"");if(!N){const ie=u.ConnectionFactoryBase.getHostSuffix(w),Y=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,`wss://${w}.${s.BaseUrl}${ie}`);N=`${Y.endsWith("/")?Y:Y+"/"}${E}${s.ApiKey}/${T}`}this.setCommonUrlParams(p,_,N);const H=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(N,_,D,new o.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(p),H,v)}}return ga.DialogConnectionFactory=s,s.ApiKey="api",s.BaseUrl="convai.speech",ga}var IS;function PI(){if(IS)return va;IS=1,Object.defineProperty(va,"__esModule",{value:!0}),va.DialogServiceConnector=void 0;const i=RI(),t=te(),r=de(),u=ge(),o=U(),c=rf();let a=class extends o.Recognizer{constructor(l,p){const h=l;u.Contracts.throwIfNull(l,"dialogConfig"),super(p,h.properties,new i.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=h.properties.clone();const v=this.buildAgentConfig();this.privReco.agentConfig.set(v)}connect(l,p){r.marshalPromiseToCallbacks(this.privReco.connect(),l,p)}disconnect(l,p){r.marshalPromiseToCallbacks(this.privReco.disconnect(),l,p)}get authorizationToken(){return this.properties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(l){u.Contracts.throwIfNullOrWhitespace(l,"token"),this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,l)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(c.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(l){this.properties.setProperty(c.PropertyId.Conversation_Speech_Activity_Template,l)}listenOnceAsync(l,p){if(this.isTurnComplete){u.Contracts.throwIfDisposed(this.privIsDisposed);const v=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const g=new r.Deferred;await this.privReco.recognize(t.RecognitionMode.Conversation,g.resolve,g.reject);const m=await g.promise;return await this.implRecognizerStop(),m})();v.catch(()=>{this.dispose(!0).catch(()=>{})}),r.marshalPromiseToCallbacks(v.finally(()=>{this.isTurnComplete=!0}),l,p)}}sendActivityAsync(l,p,h){r.marshalPromiseToCallbacks(this.privReco.sendMessage(l),p,h)}close(l,p){u.Contracts.throwIfDisposed(this.privIsDisposed),r.marshalPromiseToCallbacks(this.dispose(!0),l,p)}async dispose(l){this.privIsDisposed||l&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(l))}createRecognizerConfig(l){return new t.RecognizerConfig(l,this.privProperties)}createServiceRecognizer(l,p,h,v){const g=h;return new t.DialogServiceAdapter(l,p,g,v,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(c.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(c.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(c.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(c.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return va.DialogServiceConnector=a,va}var Sa={},AS;function _I(){if(AS)return Sa;AS=1,Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.ActivityReceivedEventArgs=void 0;let i=class{constructor(r,u){this.privActivity=r,this.privAudioStream=u}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return Sa.ActivityReceivedEventArgs=i,Sa}var Ca={},wa={},bS;function EI(){if(bS)return wa;bS=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.TurnStatusResponsePayload=void 0;class i{constructor(r){this.privMessageStatusResponse=JSON.parse(r)}static fromJSON(r){return new i(r)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return wa.TurnStatusResponsePayload=i,wa}var kS;function TI(){if(kS)return Ca;kS=1,Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.TurnStatusReceivedEventArgs=void 0;const i=EI();let t=class{constructor(u){this.privTurnStatus=i.TurnStatusResponsePayload.fromJSON(u)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return Ca.TurnStatusReceivedEventArgs=t,Ca}var nh={},OS;function II(){return OS||(OS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ServicePropertyChannel=void 0,function(t){t[t.UriQueryParameter=0]="UriQueryParameter"}(i.ServicePropertyChannel||(i.ServicePropertyChannel={}))}(nh)),nh}var ih={},MS;function AI(){return MS||(MS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ProfanityOption=void 0,function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"}(i.ProfanityOption||(i.ProfanityOption={}))}(ih)),ih}var Ra={},xS;function bI(){if(xS)return Ra;xS=1,Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.BaseAudioPlayer=void 0;const i=Ir(),t=U(),r=Ti();let u=class{constructor(c){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,c===void 0&&(c=t.AudioStreamFormat.getDefaultInputFormat()),this.init(c)}playAudioSample(c,a,s){try{this.ensureInitializedContext();const l=this.formatAudioData(c),p=new Float32Array(this.samples.length+l.length);p.set(this.samples,0),p.set(l,this.samples.length),this.samples=p,a&&a()}catch(l){s&&s(l)}}stopAudio(c,a){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{c&&c()},s=>{a&&a(s)}),this.audioContext=null)}init(c){this.audioFormat=c,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const c=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},c)}}createAudioContext(){this.audioContext=r.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(c){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(c),128);case 16:return this.formatArrayBuffer(new Int16Array(c),32768);case 32:return this.formatArrayBuffer(new Int32Array(c),2147483648);default:throw new i.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(c,a){const s=new Float32Array(c.length);for(let l=0;l<c.length;l++)s[l]=c[l]/a;return s}updateAudioBuffer(){if(this.samples.length===0)return;const c=this.audioFormat.channels,a=this.audioContext.createBufferSource(),s=this.samples.length/c,l=this.audioContext.createBuffer(c,s,this.audioFormat.samplesPerSec);for(let p=0;p<c;p++){let h=p;const v=l.getChannelData(p);for(let g=0;g<this.samples.length;g++,h+=c)v[g]=this.samples[h]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),a.buffer=l,a.connect(this.gainNode),a.start(this.startTime),this.startTime+=l.duration,this.samples=new Float32Array}async playAudio(c){this.audioContext===null&&this.createAudioContext();const a=this.audioContext.createBufferSource(),s=this.audioContext.destination;await this.audioContext.decodeAudioData(c,l=>{a.buffer=l,a.connect(s),a.start(0)})}};return Ra.BaseAudioPlayer=u,Ra}var Pa={},DS;function kI(){if(DS)return Pa;DS=1,Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.ConnectionMessageEventArgs=void 0;let i=class{constructor(r){this.privConnectionMessage=r}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return Pa.ConnectionMessageEventArgs=i,Pa}var _a={},jS;function OI(){if(jS)return _a;jS=1,Object.defineProperty(_a,"__esModule",{value:!0}),_a.VoiceProfile=void 0;let i=class{constructor(r,u){this.privId=r,this.privProfileType=u}get profileId(){return this.privId}get profileType(){return this.privProfileType}};return _a.VoiceProfile=i,_a}var ai={},NS;function MI(){if(NS)return ai;NS=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.VoiceProfileEnrollmentCancellationDetails=ai.VoiceProfileEnrollmentResult=void 0;const i=te(),t=U();let r=class Uh{constructor(c,a,s){this.privReason=c,this.privProperties=new t.PropertyCollection,this.privReason!==t.ResultReason.Canceled?a&&(this.privDetails=JSON.parse(a),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=t.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=s,this.privProperties.setProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(c){const a=[];for(const s of c.value){const l=s.enrollmentStatus.toLowerCase()==="enrolling"?t.ResultReason.EnrollingVoiceProfile:s.enrollmentStatus.toLowerCase()==="enrolled"?t.ResultReason.EnrolledVoiceProfile:t.ResultReason.Canceled,p=new Uh(l,null,null);p.privDetails=this.getIdentificationDetails(s),a.push(p)}return a}static FromVerificationProfileList(c){const a=[];for(const s of c.value){const l=s.enrollmentStatus.toLowerCase()==="enrolling"?t.ResultReason.EnrollingVoiceProfile:s.enrollmentStatus.toLowerCase()==="enrolled"?t.ResultReason.EnrolledVoiceProfile:t.ResultReason.Canceled,p=new Uh(l,null,null);p.privDetails=this.getVerificationDetails(s),a.push(p)}return a}static getIdentificationDetails(c){return{audioLength:c.audioLength?parseFloat(c.audioLength):0,audioSpeechLength:c.audioSpeechLength?parseFloat(c.audioSpeechLength):0,enrollmentStatus:c.enrollmentStatus,enrollmentsCount:c.enrollmentsCount||0,enrollmentsLength:c.enrollmentsLength?parseFloat(c.enrollmentsLength):0,enrollmentsSpeechLength:c.enrollmentsSpeechLength?parseFloat(c.enrollmentsSpeechLength):0,profileId:c.profileId||c.identificationProfileId,remainingEnrollmentsSpeechLength:c.remainingEnrollmentsSpeechLength?parseFloat(c.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(c){return{audioLength:c.audioLength?parseFloat(c.audioLength):0,audioSpeechLength:c.audioSpeechLength?parseFloat(c.audioSpeechLength):0,enrollmentStatus:c.enrollmentStatus,enrollmentsCount:c.enrollmentsCount,enrollmentsLength:c.enrollmentsLength?parseFloat(c.enrollmentsLength):0,enrollmentsSpeechLength:c.enrollmentsSpeechLength?parseFloat(c.enrollmentsSpeechLength):0,profileId:c.profileId||c.verificationProfileId,remainingEnrollmentsCount:c.remainingEnrollments||c.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:c.remainingEnrollmentsSpeechLength?parseFloat(c.remainingEnrollmentsSpeechLength):0}}};ai.VoiceProfileEnrollmentResult=r;class u extends t.CancellationDetailsBase{constructor(c,a,s){super(c,a,s)}static fromResult(c){const a=t.CancellationReason.Error;let s=t.CancellationErrorCode.NoError;return c.properties&&(s=t.CancellationErrorCode[c.properties.getProperty(i.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.NoError])]),new u(a,c.errorDetails,s)}}return ai.VoiceProfileEnrollmentCancellationDetails=u,ai}var ci={},zS;function xI(){if(zS)return ci;zS=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.VoiceProfileCancellationDetails=ci.VoiceProfileResult=void 0;const i=te(),t=ge(),r=U();let u=class{constructor(a,s){this.privReason=a,this.privProperties=new r.PropertyCollection,a===r.ResultReason.Canceled&&(t.Contracts.throwIfNullOrUndefined(s,"statusText"),this.privErrorDetails=s,this.privProperties.setProperty(i.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};ci.VoiceProfileResult=u;class o extends r.CancellationDetailsBase{constructor(a,s,l){super(a,s,l)}static fromResult(a){const s=r.CancellationReason.Error;let l=r.CancellationErrorCode.NoError;return a.properties&&(l=r.CancellationErrorCode[a.properties.getProperty(i.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new o(s,a.errorDetails,l)}}return ci.VoiceProfileCancellationDetails=o,ci}var Ea={},LS;function DI(){if(LS)return Ea;LS=1,Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.VoiceProfilePhraseResult=void 0;const i=ge(),t=U();let r=class extends t.VoiceProfileResult{constructor(o,c,a,s){super(o,c),this.privPhrases=[],i.Contracts.throwIfNullOrUndefined(s,"phrase array"),this.privType=a,s&&s[0]&&(this.privPhrases=s)}get phrases(){return this.privPhrases}get type(){return this.privType}};return Ea.VoiceProfilePhraseResult=r,Ea}var Ta={},qS;function jI(){if(qS)return Ta;qS=1,Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.VoiceProfileClient=void 0;const i=te(),t=HR(),r=ge(),u=U();let o=class extends u.Recognizer{constructor(a){r.Contracts.throwIfNullOrUndefined(a,"speechConfig");const s=a;r.Contracts.throwIfNull(s,"speechConfig"),super(t.AudioConfig.fromStreamInput(u.AudioInputStream.createPushStream()),s.properties,new i.VoiceProfileConnectionFactory),this.privProperties=s.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,a)}async createProfileAsync(a,s){const l=await this.privVoiceAdapter.createProfile(a,s);return new u.VoiceProfile(l[0],a)}async retrieveEnrollmentResultAsync(a){return this.privVoiceAdapter.retrieveEnrollmentResult(a)}async getAllProfilesAsync(a){return this.privVoiceAdapter.getAllProfiles(a)}async getActivationPhrasesAsync(a,s){return this.privVoiceAdapter.getActivationPhrases(a,s)}async enrollProfileAsync(a,s){const l=s;return r.Contracts.throwIfNullOrUndefined(l,"audioConfig"),this.audioConfig=s,this.privVoiceAdapter.SpeakerAudioSource=l,this.privVoiceAdapter.enrollProfile(a)}async deleteProfileAsync(a){return this.privVoiceAdapter.deleteProfile(a)}async resetProfileAsync(a){return this.privVoiceAdapter.resetProfile(a)}async close(){await this.dispose(!0)}createServiceRecognizer(a,s,l,p){const h=l;return new i.VoiceServiceRecognizer(a,s,h,p,this)}async dispose(a){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,a&&await super.dispose(a))}createRecognizerConfig(a){return new i.RecognizerConfig(a,this.properties)}getResult(a,s){return new u.VoiceProfileResult(a.ok?s:u.ResultReason.Canceled,a.statusText)}};return Ta.VoiceProfileClient=o,Ta}var Ia={},BS;function NI(){if(BS)return Ia;BS=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.SpeakerRecognizer=void 0;const i=te(),t=ge(),r=U();let u=class extends r.Recognizer{constructor(c,a){t.Contracts.throwIfNullOrUndefined(c,"speechConfig");const s=c;t.Contracts.throwIfNullOrUndefined(s,"speechConfig"),super(a,s.properties,new i.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=a,t.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=s.properties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){t.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}async recognizeOnceAsync(c){return t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(c)}async close(){t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(c){t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();const a=await this.privReco.recognizeSpeaker(c);return await this.implRecognizerStop(),a}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(c){return new i.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,a,s,l){const p=s;return new i.SpeakerServiceRecognizer(c,a,p,l,this)}async dispose(c){this.privDisposedSpeakerRecognizer||c&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(c))}};return Ia.SpeakerRecognizer=u,Ia}var Aa={},FS;function zI(){if(FS)return Aa;FS=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.SpeakerIdentificationModel=void 0;const i=ge(),t=U();let r=class sP{constructor(o){if(this.privVoiceProfiles=[],this.privProfileIds=[],i.Contracts.throwIfNullOrUndefined(o,"VoiceProfiles"),o.length===0)throw new Error("Empty Voice Profiles array");for(const c of o){if(c.profileType!==t.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+c.profileId);this.privVoiceProfiles.push(c),this.privProfileIds.push(c.profileId)}}static fromProfiles(o){return new sP(o)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};return Aa.SpeakerIdentificationModel=r,Aa}var ba={},US;function LI(){if(US)return ba;US=1,Object.defineProperty(ba,"__esModule",{value:!0}),ba.SpeakerVerificationModel=void 0;const i=ge(),t=U();let r=class oP{constructor(o){if(i.Contracts.throwIfNullOrUndefined(o,"VoiceProfile"),o.profileType===t.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=o}static fromProfile(o){return new oP(o)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===t.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};return ba.SpeakerVerificationModel=r,ba}var ka={},sh={},$S;function aP(){return $S||($S=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.LanguageIdMode=void 0,function(t){t[t.AtStart=0]="AtStart",t[t.Continuous=1]="Continuous"}(i.LanguageIdMode||(i.LanguageIdMode={}))}(sh)),sh}var WS;function qI(){if(WS)return ka;WS=1,Object.defineProperty(ka,"__esModule",{value:!0}),ka.AutoDetectSourceLanguageConfig=void 0;const i=te(),t=ge(),r=U(),u=aP();let o=class Al{constructor(){this.privProperties=new r.PropertyCollection,this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=u.LanguageIdMode.AtStart}static fromOpenRange(){const a=new Al;return a.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,i.AutoDetectSourceLanguagesOpenRangeOptionName),a}static fromLanguages(a){t.Contracts.throwIfArrayEmptyOrWhitespace(a,"languages");const s=new Al;return s.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,a.join()),s}static fromSourceLanguageConfigs(a){if(a.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const s=new Al,l=[];return a.forEach(p=>{if(l.push(p.language),p.endpointId!==void 0&&p.endpointId!==""){const h=p.language+r.PropertyId.SpeechServiceConnection_EndpointId.toString();s.properties.setProperty(h,p.endpointId)}}),s.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,l.join()),s}get properties(){return this.privProperties}set mode(a){a===u.LanguageIdMode.Continuous?(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=a}};return ka.AutoDetectSourceLanguageConfig=o,ka}var Oa={},HS;function BI(){if(HS)return Oa;HS=1,Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.AutoDetectSourceLanguageResult=void 0;const i=ge();let t=class $h{constructor(u,o){i.Contracts.throwIfNullOrUndefined(u,"language"),i.Contracts.throwIfNullOrUndefined(o,"languageDetectionConfidence"),this.privLanguage=u,this.privLanguageDetectionConfidence=o}static fromResult(u){return new $h(u.language,u.languageDetectionConfidence)}static fromConversationTranscriptionResult(u){return new $h(u.language,u.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return Oa.AutoDetectSourceLanguageResult=t,Oa}var Ma={},VS;function FI(){if(VS)return Ma;VS=1,Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.SourceLanguageConfig=void 0;const i=ge();let t=class cP{constructor(u,o){i.Contracts.throwIfNullOrUndefined(u,"language"),this.privLanguage=u,this.privEndpointId=o}static fromLanguage(u,o){return new cP(u,o)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return Ma.SourceLanguageConfig=t,Ma}var oh={},KS;function UI(){return KS||(KS=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SpeakerRecognitionCancellationDetails=i.SpeakerRecognitionResult=i.SpeakerRecognitionResultType=void 0;const t=te(),r=U();var u;(function(a){a[a.Verify=0]="Verify",a[a.Identify=1]="Identify"})(u=i.SpeakerRecognitionResultType||(i.SpeakerRecognitionResultType={}));class o{constructor(s,l=r.ResultReason.RecognizedSpeaker,p=r.CancellationErrorCode.NoError,h=""){this.privProperties=new r.PropertyCollection;const v=s.scenario==="TextIndependentIdentification"?u.Identify:u.Verify;this.privReason=l,this.privReason!==r.ResultReason.Canceled?v===u.Identify?(this.privProfileId=s.identificationResult.identifiedProfile.profileId,this.privScore=s.identificationResult.identifiedProfile.score,this.privReason=r.ResultReason.RecognizedSpeakers):(this.privScore=s.verificationResult.score,s.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=r.ResultReason.NoMatch),s.verificationResult.profileId!==void 0&&s.verificationResult.profileId!==""&&(this.privProfileId=s.verificationResult.profileId)):(this.privErrorDetails=h,this.privProperties.setProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[p])),this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(s))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}i.SpeakerRecognitionResult=o;class c extends r.CancellationDetailsBase{constructor(s,l,p){super(s,l,p)}static fromResult(s){const l=r.CancellationReason.Error;let p=r.CancellationErrorCode.NoError;return s.properties&&(p=r.CancellationErrorCode[s.properties.getProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new c(l,s.errorDetails,p)}}i.SpeakerRecognitionCancellationDetails=c}(oh)),oh}var ah={},ui={},JS;function uP(){if(JS)return ui;JS=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.ConversationImpl=ui.Conversation=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class{constructor(){}static createConversationAsync(s,l,p,h){r.Contracts.throwIfNullOrUndefined(s,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(s.region,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!s.subscriptionKey&&!s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(s.subscriptionKey,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let v,g,m;return typeof l=="string"?(v=new c(s,l),t.marshalPromiseToCallbacks((async()=>{})(),p,h)):(v=new c(s),g=l,m=p,v.createConversationAsync(()=>{g&&g()},w=>{m&&m(w)})),v}};ui.Conversation=o;class c extends o{constructor(s,l){if(super(),this.privErrors=i.ConversationConnectionConfig.restErrors,this.onConnected=v=>{var g;this.privIsConnected=!0;try{(g=this.privConversationTranslator)!=null&&g.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,v)}catch{}},this.onDisconnected=v=>{var g;try{(g=this.privConversationTranslator)!=null&&g.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,v)}catch{}finally{this.close(!1)}},this.onCanceled=(v,g)=>{var m;try{(m=this.privConversationTranslator)!=null&&m.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,g)}catch{}},this.onParticipantUpdateCommandReceived=(v,g)=>{try{const m=this.privParticipants.getParticipant(g.id);if(m!==void 0){switch(g.key){case i.ConversationTranslatorCommandTypes.changeNickname:m.displayName=g.value;break;case i.ConversationTranslatorCommandTypes.setUseTTS:m.isUsingTts=g.value;break;case i.ConversationTranslatorCommandTypes.setProfanityFiltering:m.profanity=g.value;break;case i.ConversationTranslatorCommandTypes.setMute:m.isMuted=g.value;break;case i.ConversationTranslatorCommandTypes.setTranslateToLanguages:m.translateToLanguages=g.value;break}this.privParticipants.addOrUpdateParticipant(m),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(m)],g.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(v,g)=>{try{this.privParticipants.participants.forEach(m=>m.isMuted=m.isHost?!1:g.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),g.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(v,g)=>{try{const m=this.privParticipants.addOrUpdateParticipant(g.participant);m!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(m)],g.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(v,g)=>{try{const m=this.privParticipants.getParticipant(g.participant.id);m!==void 0&&(this.privParticipants.deleteParticipant(g.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(m)],g.sessionId)))}catch{}},this.onTranslationReceived=(v,g)=>{try{switch(g.command){case i.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case i.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case i.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break}}catch{}},this.onParticipantsListReceived=(v,g)=>{var m;try{if(g.sessionToken!==void 0&&g.sessionToken!==null&&(this.privRoom.token=g.sessionToken),this.privParticipants.participants=[...g.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),g.sessionId)),this.me.isHost){const w=(m=this.privConversationTranslator)==null?void 0:m.properties.getProperty(u.PropertyId.ConversationTranslator_Name);w!==void 0&&w.length>0&&w!==this.me.displayName&&this.changeNicknameAsync(w)}}catch{}},this.onConversationExpiration=(v,g)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,g)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new i.ConversationManager,s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||s.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],i.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),l)this.privConversationId=l;else{s.targetLanguages.length===0&&s.addTargetLanguage(this.privLanguage),s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceResponse_ProfanityOption])||s.setProfanity(u.ProfanityOption.Masked);let g=s.getProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name]);g==null&&(g="Host"),r.Contracts.throwIfNullOrTooLong(g,"nickname",50),r.Contracts.throwIfNullOrTooShort(g,"nickname",2),s.setProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name],g)}this.privConfig=s;const h=s;r.Contracts.throwIfNull(h,"speechConfig"),this.privProperties=h.properties.clone(),this.privIsConnected=!1,this.privParticipants=new i.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var s,l;return(s=this.privParticipants.me)!=null&&s.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const s=this.conversationId,l=this.participants.map(v=>({id:v.id,preferredLanguage:v.preferredLanguage,voice:v.voice})),p={};for(const v of i.ConversationConnectionConfig.transcriptionEventKeys){const g=this.properties.getProperty(v,"");g!==""&&(p[v]=g)}return{id:s,participants:l,conversationProperties:p}}get canSend(){var s;return this.privIsConnected&&!((s=this.privParticipants.me)!=null&&s.isMuted)}get canSendAsHost(){var s;return this.privIsConnected&&((s=this.privParticipants.me)==null?void 0:s.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(s){r.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),this.privToken=s}set conversationTranslator(s){this.privConversationTranslator=s}onToken(s){this.privConversationTranslator.onToken(s)}createConversationAsync(s,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,p=>{p||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=p,this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}startConversationAsync(s,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=i.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}addParticipantAsync(s,l,p){r.Contracts.throwIfNullOrUndefined(s,"Participant"),t.marshalPromiseToCallbacks(this.addParticipantImplAsync(s),l,p)}joinConversationAsync(s,l,p,h,v){try{r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,s,g=>{r.Contracts.throwIfNullOrUndefined(g,this.privErrors.permissionDeniedConnect),this.privRoom=g,this.privConfig.authorizationToken=g.cognitiveSpeechAuthToken,h&&h(g.cognitiveSpeechAuthToken)},g=>{this.handleError(g,v)})}catch(g){this.handleError(g,v)}}deleteConversationAsync(s,l){t.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),s,l)}async deleteConversationImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(s,l){t.marshalPromiseToCallbacks(this.endConversationImplAsync(),s,l)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}muteAllParticipantsAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}muteParticipantAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),!this.me.isHost&&this.me.id!==s&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),p),this.privParticipants.getParticipantIndex(s)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(s,!0),()=>{this.handleCallback(l,p)},v=>{this.handleError(v,p)})}catch(h){this.handleError(h,p)}}removeParticipantAsync(s,l,p){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&s.hasOwnProperty("id"))t.marshalPromiseToCallbacks(this.removeParticipantImplAsync(s),l,p);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),p);let h="";typeof s=="string"?h=s:s.hasOwnProperty("id")?h=s.id:s.hasOwnProperty("userId")&&(h=s.userId),r.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(g=>g.id===h)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(h),()=>{this.handleCallback(l,p)},g=>{this.handleError(g,p)})}}catch(h){this.handleError(h,p)}}unlockConversationAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}unmuteAllParticipantsAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}unmuteParticipantAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),!this.me.isHost&&this.me.id!==s&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),p),this.privParticipants.getParticipantIndex(s)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(s,!1),()=>{this.handleCallback(l,p)},v=>{this.handleError(v,p)})}catch(h){this.handleError(h,p)}}sendTextMessageAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),s.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(s),()=>{this.handleCallback(l,p)},h=>{this.handleError(h,p)})}catch(h){this.handleError(h,p)}}setTranslatedLanguagesAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(s),()=>{this.handleCallback(l,p)},h=>{this.handleError(h,p)})}catch(h){this.handleError(h,p)}}changeNicknameAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(s),()=>{this.handleCallback(l,p)},h=>{this.handleError(h,p)})}catch(h){this.handleError(h,p)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(s){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await s.enforceAudioGating(),this.privTranscriberRecognizer=s,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const s=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:s,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(s){if(this.privParticipants.addOrUpdateParticipant(s)!==void 0&&this.privTranscriberRecognizer){const p=this.conversationInfo;return p.participants=[s],this.privTranscriberRecognizer.pushConversationEvent(p,"join")}}removeParticipantImplAsync(s){this.privParticipants.deleteParticipant(s.id);const l=this.conversationInfo;return l.participants=[s],this.privTranscriberRecognizer.pushConversationEvent(l,"leave")}async close(s){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(p){throw p}s&&this.dispose()}handleCallback(s,l){if(s){try{s()}catch(p){l&&l(p)}s=void 0}}handleError(s,l){if(l)if(s instanceof Error){const p=s;l(p.name+": "+p.message)}else l(s)}toParticipants(s){const l=this.privParticipants.participants.map(p=>this.toParticipant(p));return s?l:l.filter(p=>p.isHost===!1)}toParticipant(s){return new u.Participant(s.id,s.avatar,s.displayName,s.isHost,s.isMuted,s.isUsingTts,s.preferredLanguage,s.voice)}getMuteAllCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getMuteCommand(s,l){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(s,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setMute,participantId:s,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getEjectCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(s,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.ejectParticipant,participantId:s,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getChangeNicknameCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(s,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.changeNickname,nickname:s,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getMessageCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(s,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:s,type:i.ConversationTranslatorMessageTypes.instantMessage})}}return ui.ConversationImpl=c,ui}var xa={},GS;function $I(){if(GS)return xa;GS=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.ConversationCommon=void 0;let i=class{constructor(r){this.privAudioConfig=r}handleCallback(r,u){if(r){try{r()}catch(o){u&&u(o)}r=void 0}}handleError(r,u){if(u)if(r instanceof Error){const o=r;u(o.name+": "+o.message)}else u(r)}};return xa.ConversationCommon=i,xa}var Da={},QS;function WI(){if(QS)return Da;QS=1,Object.defineProperty(Da,"__esModule",{value:!0}),Da.ConversationExpirationEventArgs=void 0;const i=U();let t=class extends i.SessionEventArgs{constructor(u,o){super(o),this.privExpirationTime=u}get expirationTime(){return this.privExpirationTime}};return Da.ConversationExpirationEventArgs=t,Da}var ja={},YS;function HI(){if(YS)return ja;YS=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.ConversationParticipantsChangedEventArgs=void 0;const i=U();let t=class extends i.SessionEventArgs{constructor(u,o,c){super(c),this.privReason=u,this.privParticipant=o}get reason(){return this.privReason}get participants(){return this.privParticipant}};return ja.ConversationParticipantsChangedEventArgs=t,ja}var Na={},XS;function VI(){if(XS)return Na;XS=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.ConversationTranslationCanceledEventArgs=void 0;const i=vu();let t=class extends i.CancellationEventArgsBase{};return Na.ConversationTranslationCanceledEventArgs=t,Na}var za={},ZS;function KI(){if(ZS)return za;ZS=1,Object.defineProperty(za,"__esModule",{value:!0}),za.ConversationTranslationEventArgs=void 0;const i=U();let t=class extends i.RecognitionEventArgs{constructor(u,o,c){super(o,c),this.privResult=u}get result(){return this.privResult}};return za.ConversationTranslationEventArgs=t,za}var La={},eC;function JI(){if(eC)return La;eC=1,Object.defineProperty(La,"__esModule",{value:!0}),La.ConversationTranslationResult=void 0;const i=KR();let t=class extends i.TranslationRecognitionResult{constructor(u,o,c,a,s,l,p,h,v,g,m){super(o,a,s,l,p,h,void 0,void 0,v,g,m),this.privId=u,this.privOrigLang=c}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return La.ConversationTranslationResult=t,La}var ch={},qa={},Ba={},tC;function lP(){if(tC)return Ba;tC=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.StringUtils=void 0;let i=class{static formatString(r,u){if(!r)return"";if(!u)return r;let o="",c="";const a=p=>{o+=p},s=p=>{c+=p};let l=a;for(let p=0;p<r.length;p++){const h=r[p],v=p+1<r.length?r[p+1]:"";switch(h){case"{":v==="{"?(l("{"),p++):l=s;break;case"}":v==="}"?(l("}"),p++):(u.hasOwnProperty(c)&&(o+=u[c]),l=a,c="");break;default:l(h);break}}return o}};return Ba.StringUtils=i,Ba}var rC;function GI(){if(rC)return qa;rC=1,Object.defineProperty(qa,"__esModule",{value:!0}),qa.ConversationTranslatorConnectionFactory=void 0;const i=lt(),t=lP(),r=ge(),u=U(),o=Pt(),c=kn(),a=vr(),s=te();let l=class dP extends a.ConnectionFactoryBase{constructor(h){super(),r.Contracts.throwIfNullOrUndefined(h,"convGetter"),this.privConvGetter=h}create(h,v,g){const m=h.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",w=this.privConvGetter().room,C=w.cognitiveSpeechRegion||h.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Region,""),R={hostSuffix:a.ConnectionFactoryBase.getHostSuffix(C),path:dP.CTS_VIRT_MIC_PATH,region:encodeURIComponent(C)};R[c.QueryParameterNames.Language]=encodeURIComponent(h.parameters.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage,"")),R[c.QueryParameterNames.CtsMeetingId]=encodeURIComponent(w.roomId),R[c.QueryParameterNames.CtsDeviceId]=encodeURIComponent(w.participantId),R[c.QueryParameterNames.CtsIsParticipant]=w.isHost?"":"&"+c.QueryParameterNames.CtsIsParticipant;let _="";const E={},T={};if(m){_=h.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Endpoint),_||(_="wss://"+h.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),_=t.StringUtils.formatString(_,R);const N=new URL(_);N.searchParams.forEach((ie,Y)=>{E[Y]=ie}),new s.TranscriberConnectionFactory().setQueryParams(E,h,_),E[c.QueryParameterNames.CtsMeetingId]=R[c.QueryParameterNames.CtsMeetingId],E[c.QueryParameterNames.CtsDeviceId]=R[c.QueryParameterNames.CtsDeviceId],w.isHost||(E[c.QueryParameterNames.CtsIsParticipant]=""),c.QueryParameterNames.Format in E||(E[c.QueryParameterNames.Format]="simple"),N.searchParams.forEach((ie,Y)=>{N.searchParams.set(Y,E[Y]),delete E[Y]}),_=N.toString()}else{const N=new s.TranslationConnectionFactory;_=N.getEndpointUrl(h,!0),_=t.StringUtils.formatString(_,R),N.setQueryParams(E,h,_)}T[o.HeaderNames.ConnectionId]=g,T[i.RestConfigBase.configParams.token]=w.token,v.token&&(T[v.headerName]=v.token);const D=h.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return new i.WebsocketConnection(_,E,T,new s.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(h),D,g)}};return qa.ConversationTranslatorConnectionFactory=l,l.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",qa}var nC;function QI(){return nC||(nC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ConversationTranslator=i.SpeechState=void 0;const t=te(),r=GI(),u=de(),o=ge(),c=U(),a=uP(),s=sf();var l;(function(v){v[v.Inactive=0]="Inactive",v[v.Connecting=1]="Connecting",v[v.Connected=2]="Connected"})(l=i.SpeechState||(i.SpeechState={}));class p extends c.TranslationRecognizer{constructor(g,m,w,C){super(g,m,new r.ConversationTranslatorConnectionFactory(C)),this.privSpeechState=l.Inactive,w&&(this.privTranslator=w,this.sessionStarted=()=>{this.privSpeechState=l.Connected},this.sessionStopped=()=>{this.privSpeechState=l.Inactive},this.recognizing=(R,_)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,_)},this.recognized=async(R,_)=>{var E;(E=_.result)!=null&&E.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(_.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,_)},this.canceled=async()=>{if(this.privSpeechState!==l.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=l.Inactive}})}get state(){return this.privSpeechState}set state(g){this.privSpeechState=g}set authentication(g){this.privReco.authentication=g}onConnection(){this.privSpeechState=l.Connected}async onCancelSpeech(){this.privSpeechState=l.Inactive,await this.cancelSpeech()}fireCancelEvent(g){try{if(this.privTranslator.canceled){const m=new s.ConversationTranslationCanceledEventArgs(c.CancellationReason.Error,g,c.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,m)}}catch{}}async cancelSpeech(){var g;try{this.stopContinuousRecognitionAsync(),await((g=this.privReco)==null?void 0:g.disconnect()),this.privSpeechState=l.Inactive}catch{}}}class h extends s.ConversationCommon{constructor(g){super(g),this.privErrors=t.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new c.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var g;return(g=this.privConversation)==null?void 0:g.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===l.Connected||this.privCTRecognizer.state===l.Connecting||this.privConversation.isMutedByHost)}onToken(g){this.privCTRecognizer.authentication=g}setServiceProperty(g,m){const w=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));w[g]=m,this.privProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(w))}joinConversationAsync(g,m,w,C,R){try{if(typeof g=="string"){o.Contracts.throwIfNullOrUndefined(g,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.Contracts.throwIfNullOrWhitespace(m,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),R);let _=w;(_==null||_==="")&&(_=t.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=c.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(c.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(_),this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage],_),this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.ConversationTranslator_Name],m);const E=[c.PropertyId.SpeechServiceConnection_Host,c.PropertyId.ConversationTranslator_Host,c.PropertyId.SpeechServiceConnection_Endpoint,c.PropertyId.SpeechServiceConnection_ProxyHostName,c.PropertyId.SpeechServiceConnection_ProxyPassword,c.PropertyId.SpeechServiceConnection_ProxyPort,c.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const D of E){const N=this.privProperties.getProperty(D);if(N){const H=typeof D=="string"?D:c.PropertyId[D];this.privSpeechTranslationConfig.setProperty(H,N)}}const T=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));for(const D of Object.keys(T))this.privSpeechTranslationConfig.setServiceProperty(D,T[D],c.ServicePropertyChannel.UriQueryParameter);this.privConversation=new a.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(g,m,_,D=>{D||this.handleError(new Error(this.privErrors.permissionDeniedConnect),R),this.privSpeechTranslationConfig.authorizationToken=D,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(C,R)},N=>{this.handleError(N,R)})},D=>{this.handleError(D,R)})}else typeof g=="object"?(o.Contracts.throwIfNullOrUndefined(g,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.Contracts.throwIfNullOrWhitespace(m,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(c.PropertyId.ConversationTranslator_Name,m),this.privConversation=g,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),o.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=g.config,this.handleCallback(w,C)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),C)}catch(_){this.handleError(_,typeof w=="string"?R:C)}}leaveConversationAsync(g,m){u.marshalPromiseToCallbacks((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),g,m)}sendTextMessageAsync(g,m,w){try{o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.Contracts.throwIfNullOrWhitespace(g,this.privErrors.invalidArgs.replace("{arg}",g)),this.privConversation.sendTextMessageAsync(g,m,w)}catch(C){this.handleError(C,w)}}startTranscribingAsync(g,m){u.marshalPromiseToCallbacks((async()=>{try{o.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),o.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),m),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(w){throw this.privIsSpeaking=!1,await this.cancelSpeech(),w}})(),g,m)}stopTranscribingAsync(g,m){u.marshalPromiseToCallbacks((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((w,C)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(w,C)})}catch{await this.cancelSpeech()}})(),g,m)}isDisposed(){return this.privIsDisposed}dispose(g,m,w){u.marshalPromiseToCallbacks((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),m,w)}async cancelSpeech(){var g;try{this.privIsSpeaking=!1,await((g=this.privCTRecognizer)==null?void 0:g.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=c.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key],"");const g=()=>this.privConversation;this.privCTRecognizer=new p(this.privSpeechTranslationConfig,this.privAudioConfig,this,g)}catch(g){throw await this.cancelSpeech(),g}}startContinuousRecognition(){return new Promise((g,m)=>{this.privCTRecognizer.startContinuousRecognitionAsync(g,m)})}}i.ConversationTranslator=h}(ch)),ch}var Fa={},iC;function YI(){if(iC)return Fa;iC=1,Object.defineProperty(Fa,"__esModule",{value:!0}),Fa.ConversationTranscriber=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class pP extends u.Recognizer{constructor(a,s){const l=a;r.Contracts.throwIfNull(l,"speechConfig"),r.Contracts.throwIfNullOrWhitespace(l.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage),u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),super(s,l.properties,new i.ConversationTranscriberConnectionFactory),this.privProperties.setProperty(u.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(a,s,l){const p=a;return s.properties.mergeTo(p.properties),new pP(a,l)}get endpointId(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,a)}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.OutputFormatPropertyName,u.OutputFormat[u.OutputFormat.Simple])===u.OutputFormat[u.OutputFormat.Simple]?u.OutputFormat.Simple:u.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(a,s){t.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),a,s)}stopTranscribingAsync(a,s){t.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,s)}close(a,s){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),a,s)}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new i.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,s,l,p){const h=l;return p.isSpeakerDiarizationEnabled=!0,new i.ConversationTranscriptionServiceRecognizer(a,s,h,p,this)}};return Fa.ConversationTranscriber=o,Fa}var li={},sC;function XI(){if(sC)return li;sC=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Participant=li.User=void 0;const i=U();class t{constructor(o){this.privUserId=o}get userId(){return this.privUserId}}li.User=t;class r{constructor(o,c,a,s,l,p,h,v){this.privId=o,this.privAvatar=c,this.privDisplayName=a,this.privIsHost=s,this.privIsMuted=l,this.privIsUsingTts=p,this.privPreferredLanguage=h,this.privVoice=v,this.privProperties=new i.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(o,c,a){return new r(o,"",o,!1,!1,!1,c,a)}}return li.Participant=r,li}var uh={},oC;function ZI(){return oC||(oC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ParticipantChangedReason=void 0,function(t){t[t.JoinedConversation=0]="JoinedConversation",t[t.LeftConversation=1]="LeftConversation",t[t.Updated=2]="Updated"}(i.ParticipantChangedReason||(i.ParticipantChangedReason={}))}(uh)),uh}var di={},aC;function eA(){if(aC)return di;aC=1,Object.defineProperty(di,"__esModule",{value:!0}),di.MeetingImpl=di.Meeting=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class{constructor(){}static createMeetingAsync(s,l,p,h){if(r.Contracts.throwIfNullOrUndefined(s,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(s.region,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),r.Contracts.throwIfNull(l,"meetingId"),l.length===0)throw new Error("meetingId cannot be empty");!s.subscriptionKey&&!s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(s.subscriptionKey,i.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const v=new c(s,l);return t.marshalPromiseToCallbacks((async()=>{})(),p,h),v}};di.Meeting=o;class c extends o{constructor(s,l){super(),this.privErrors=i.ConversationConnectionConfig.restErrors,this.onConnected=v=>{var g;this.privIsConnected=!0;try{(g=this.privConversationTranslator)!=null&&g.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,v)}catch{}},this.onDisconnected=v=>{var g;try{(g=this.privConversationTranslator)!=null&&g.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,v)}catch{}finally{this.close(!1)}},this.onCanceled=(v,g)=>{var m;try{(m=this.privConversationTranslator)!=null&&m.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,g)}catch{}},this.onParticipantUpdateCommandReceived=(v,g)=>{try{const m=this.privParticipants.getParticipant(g.id);if(m!==void 0){switch(g.key){case i.ConversationTranslatorCommandTypes.changeNickname:m.displayName=g.value;break;case i.ConversationTranslatorCommandTypes.setUseTTS:m.isUsingTts=g.value;break;case i.ConversationTranslatorCommandTypes.setProfanityFiltering:m.profanity=g.value;break;case i.ConversationTranslatorCommandTypes.setMute:m.isMuted=g.value;break;case i.ConversationTranslatorCommandTypes.setTranslateToLanguages:m.translateToLanguages=g.value;break}this.privParticipants.addOrUpdateParticipant(m),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(m)],g.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(v,g)=>{try{this.privParticipants.participants.forEach(m=>m.isMuted=m.isHost?!1:g.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),g.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(v,g)=>{try{const m=this.privParticipants.addOrUpdateParticipant(g.participant);m!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(m)],g.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(v,g)=>{try{const m=this.privParticipants.getParticipant(g.participant.id);m!==void 0&&(this.privParticipants.deleteParticipant(g.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(m)],g.sessionId)))}catch{}},this.onTranslationReceived=(v,g)=>{try{switch(g.command){case i.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case i.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break;case i.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(g.payload,void 0,g.sessionId));break}}catch{}},this.onParticipantsListReceived=(v,g)=>{var m;try{if(g.sessionToken!==void 0&&g.sessionToken!==null&&(this.privRoom.token=g.sessionToken),this.privParticipants.participants=[...g.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),g.sessionId)),this.me.isHost){const w=(m=this.privConversationTranslator)==null?void 0:m.properties.getProperty(u.PropertyId.ConversationTranslator_Name);w!==void 0&&w.length>0&&w!==this.me.displayName&&this.changeNicknameAsync(w)}}catch{}},this.onConversationExpiration=(v,g)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,g)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new i.ConversationManager,s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||s.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],i.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=s.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=l,this.privConfig=s;const h=s;r.Contracts.throwIfNull(h,"speechConfig"),this.privProperties=h.properties.clone(),this.privIsConnected=!1,this.privParticipants=new i.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var s,l;return(s=this.privParticipants.me)!=null&&s.isHost?!1:(l=this.privParticipants.me)==null?void 0:l.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const s=this.meetingId,l=this.participants.map(v=>({id:v.id,preferredLanguage:v.preferredLanguage,voice:v.voice})),p={};for(const v of i.ConversationConnectionConfig.transcriptionEventKeys){const g=this.properties.getProperty(v,"");g!==""&&(p[v]=g)}return{id:s,participants:l,meetingProperties:p}}get canSend(){var s;return this.privIsConnected&&!((s=this.privParticipants.me)!=null&&s.isMuted)}get canSendAsHost(){var s;return this.privIsConnected&&((s=this.privParticipants.me)==null?void 0:s.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(s){r.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),this.privToken=s}createMeetingAsync(s,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),this.privManager.createOrJoin(this.privProperties,void 0,p=>{p||this.handleError(new Error(this.privErrors.permissionDeniedConnect),l),this.privRoom=p,this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}startMeetingAsync(s,l){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),l),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}addParticipantAsync(s,l,p){r.Contracts.throwIfNullOrUndefined(s,"Participant"),t.marshalPromiseToCallbacks(this.addParticipantImplAsync(s),l,p)}joinMeetingAsync(s,l,p,h,v){try{r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,s,g=>{r.Contracts.throwIfNullOrUndefined(g,this.privErrors.permissionDeniedConnect),this.privRoom=g,this.privConfig.authorizationToken=g.cognitiveSpeechAuthToken,h&&h(g.cognitiveSpeechAuthToken)},g=>{this.handleError(g,v)})}catch(g){this.handleError(g,v)}}deleteMeetingAsync(s,l){t.marshalPromiseToCallbacks(this.deleteMeetingImplAsync(),s,l)}async deleteMeetingImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(s,l){t.marshalPromiseToCallbacks(this.endMeetingImplAsync(),s,l)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}muteAllParticipantsAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}muteParticipantAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),!this.me.isHost&&this.me.id!==s&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),p),this.privParticipants.getParticipantIndex(s)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(s,!0),()=>{this.handleCallback(l,p)},v=>{this.handleError(v,p)})}catch(h){this.handleError(h,p)}}removeParticipantAsync(s,l,p){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&s.hasOwnProperty("id"))t.marshalPromiseToCallbacks(this.removeParticipantImplAsync(s),l,p);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),p);let h="";typeof s=="string"?h=s:s.hasOwnProperty("id")?h=s.id:s.hasOwnProperty("userId")&&(h=s.userId),r.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(g=>g.id===h)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(h),()=>{this.handleCallback(l,p)},g=>{this.handleError(g,p)})}}catch(h){this.handleError(h,p)}}unlockMeetingAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}unmuteAllParticipantsAsync(s,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),l),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(s,l)},p=>{this.handleError(p,l)})}catch(p){this.handleError(p,l)}}unmuteParticipantAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),!this.me.isHost&&this.me.id!==s&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),p),this.privParticipants.getParticipantIndex(s)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(s,!1),()=>{this.handleCallback(l,p)},v=>{this.handleError(v,p)})}catch(h){this.handleError(h,p)}}sendTextMessageAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),s.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(s),()=>{this.handleCallback(l,p)},h=>{this.handleError(h,p)})}catch(h){this.handleError(h,p)}}setTranslatedLanguagesAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(s),()=>{this.handleCallback(l,p)},h=>{this.handleError(h,p)})}catch(h){this.handleError(h,p)}}changeNicknameAsync(s,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),p),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(s),()=>{this.handleCallback(l,p)},h=>{this.handleError(h,p)})}catch(h){this.handleError(h,p)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(s){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await s.enforceAudioGating(),this.privTranscriberRecognizer=s,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const s=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:s,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(s){if(this.privParticipants.addOrUpdateParticipant(s)!==void 0&&this.privTranscriberRecognizer){const p=this.meetingInfo;return p.participants=[s],this.privTranscriberRecognizer.pushMeetingEvent(p,"join")}}removeParticipantImplAsync(s){this.privParticipants.deleteParticipant(s.id);const l=this.meetingInfo;return l.participants=[s],this.privTranscriberRecognizer.pushMeetingEvent(l,"leave")}async close(s){var l;try{this.privIsConnected=!1,await((l=this.privConversationRecognizer)==null?void 0:l.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(p){throw p}s&&this.dispose()}handleCallback(s,l){if(s){try{s()}catch(p){l&&l(p)}s=void 0}}handleError(s,l){if(l)if(s instanceof Error){const p=s;l(p.name+": "+p.message)}else l(s)}toParticipants(s){const l=this.privParticipants.participants.map(p=>this.toParticipant(p));return s?l:l.filter(p=>p.isHost===!1)}toParticipant(s){return new u.Participant(s.id,s.avatar,s.displayName,s.isHost,s.isMuted,s.isUsingTts,s.preferredLanguage,s.voice)}getMuteAllCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getMuteCommand(s,l){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(s,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setMute,participantId:s,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:l})}getLockCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getEjectCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(s,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.ejectParticipant,participantId:s,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getChangeNicknameCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(s,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:i.ConversationTranslatorCommandTypes.changeNickname,nickname:s,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:i.ConversationTranslatorMessageTypes.participantCommand,value:s})}getMessageCommand(s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(s,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:s,type:i.ConversationTranslatorMessageTypes.instantMessage})}}return di.MeetingImpl=c,di}var Ua={},cC;function tA(){if(cC)return Ua;cC=1,Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.MeetingTranscriptionCanceledEventArgs=void 0;const i=vu();class t extends i.CancellationEventArgsBase{}return Ua.MeetingTranscriptionCanceledEventArgs=t,Ua}var $a={},uC;function rA(){if(uC)return $a;uC=1,Object.defineProperty($a,"__esModule",{value:!0}),$a.MeetingTranscriber=void 0;const i=te(),t=de(),r=ge(),u=U(),o=sf();let c=class{constructor(s){this.privAudioConfig=s,this.privProperties=new u.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return u.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){r.Contracts.throwIfNullOrWhitespace(s,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,s)}joinMeetingAsync(s,l,p){const h=s;r.Contracts.throwIfNullOrUndefined(o.MeetingImpl,"Meeting"),this.privRecognizer=new i.TranscriberRecognizer(s.config,this.privAudioConfig),r.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),t.marshalPromiseToCallbacks(h.connectTranscriberRecognizer(this.privRecognizer),l,p)}startTranscribingAsync(s,l){this.privRecognizer.startContinuousRecognitionAsync(s,l)}stopTranscribingAsync(s,l){this.privRecognizer.stopContinuousRecognitionAsync(s,l)}leaveMeetingAsync(s,l){this.privRecognizer.disconnectCallbacks(),t.marshalPromiseToCallbacks((async()=>{})(),s,l)}close(s,l){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),t.marshalPromiseToCallbacks(this.dispose(!0),s,l)}async dispose(s){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),s&&(this.privDisposedRecognizer=!0))}};return $a.MeetingTranscriber=c,$a}var Wa={},lC;function nA(){if(lC)return Wa;lC=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.ConversationTranscriptionResult=void 0;const i=U();let t=class extends i.RecognitionResult{constructor(u,o,c,a,s,l,p,h,v,g,m){super(u,o,c,a,s,l,p,v,g,m),this.privSpeakerId=h}get speakerId(){return this.privSpeakerId}};return Wa.ConversationTranscriptionResult=t,Wa}var dC;function sf(){return dC||(dC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=uP();Object.defineProperty(i,"Conversation",{enumerable:!0,get:function(){return t.Conversation}}),Object.defineProperty(i,"ConversationImpl",{enumerable:!0,get:function(){return t.ConversationImpl}});var r=$I();Object.defineProperty(i,"ConversationCommon",{enumerable:!0,get:function(){return r.ConversationCommon}});var u=WI();Object.defineProperty(i,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return u.ConversationExpirationEventArgs}});var o=HI();Object.defineProperty(i,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return o.ConversationParticipantsChangedEventArgs}});var c=VI();Object.defineProperty(i,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return c.ConversationTranslationCanceledEventArgs}});var a=KI();Object.defineProperty(i,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return a.ConversationTranslationEventArgs}});var s=JI();Object.defineProperty(i,"ConversationTranslationResult",{enumerable:!0,get:function(){return s.ConversationTranslationResult}});var l=QI();Object.defineProperty(i,"ConversationTranslator",{enumerable:!0,get:function(){return l.ConversationTranslator}});var p=YI();Object.defineProperty(i,"ConversationTranscriber",{enumerable:!0,get:function(){return p.ConversationTranscriber}});var h=XI();Object.defineProperty(i,"Participant",{enumerable:!0,get:function(){return h.Participant}}),Object.defineProperty(i,"User",{enumerable:!0,get:function(){return h.User}});var v=ZI();Object.defineProperty(i,"ParticipantChangedReason",{enumerable:!0,get:function(){return v.ParticipantChangedReason}});var g=eA();Object.defineProperty(i,"Meeting",{enumerable:!0,get:function(){return g.Meeting}}),Object.defineProperty(i,"MeetingImpl",{enumerable:!0,get:function(){return g.MeetingImpl}});var m=tA();Object.defineProperty(i,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return m.MeetingTranscriptionCanceledEventArgs}});var w=rA();Object.defineProperty(i,"MeetingTranscriber",{enumerable:!0,get:function(){return w.MeetingTranscriber}});var C=nA();Object.defineProperty(i,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return C.ConversationTranscriptionResult}})}(ah)),ah}var pi={},pC;function of(){if(pC)return pi;pC=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.SynthesisRequest=pi.Synthesizer=void 0;const i=te(),t=de(),r=ge(),u=U();let o=class hP{constructor(s){const l=s;r.Contracts.throwIfNull(l,"speechConfig"),this.privProperties=l.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new t.Queue}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){r.Contracts.throwIfNullOrWhitespace(s,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,s)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(u.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===i.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(s){const l={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let p=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),h=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthVoice,""),v=hP.XMLEncode(s);return this.autoDetectSourceLanguage?p="en-US":h=h||l[p],h&&(v=`<voice name='${h}'>${v}</voice>`),v=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${p}'>${v}</speak>`,v}async dispose(s){this.privDisposed||(s&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const s=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(s.text,s.isSSML,s.requestId,s.cb,s.err,s.dataStream)}}createSynthesizerConfig(s){return new i.SynthesizerConfig(s,this.privProperties)}implCommonSynthesizeSetup(){let s=typeof window<"u"?"Browser":"Node",l="unknown",p="unknown";typeof navigator<"u"&&(s=s+"/"+navigator.platform,l=navigator.userAgent,p=navigator.appVersion);const h=this.createSynthesizerConfig(new i.SpeechServiceConfig(new i.Context(new i.OS(s,l,p)))),v=this.privProperties.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0),g=v&&v!==""?new i.CognitiveSubscriptionKeyAuthentication(v):new i.CognitiveTokenAuthentication(()=>{const m=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(m)},()=>{const m=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(m)});this.privAdapter=this.createSynthesisAdapter(g,this.privConnectionFactory,h),this.privRestAdapter=this.createRestSynthesisAdapter(g,h)}static XMLEncode(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};pi.Synthesizer=o;class c{constructor(s,l,p,h,v,g){this.requestId=s,this.text=l,this.isSSML=p,this.cb=h,this.err=v,this.dataStream=g}}return pi.SynthesisRequest=c,pi}var Ha={},hC;function iA(){if(hC)return Ha;hC=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.SpeechSynthesizer=void 0;const i=te(),t=de(),r=FR(),u=fu(),o=vs(),c=ge(),a=U(),s=of();let l=class fP extends a.Synthesizer{constructor(h,v){super(h),v!==null&&(v===void 0?this.audioConfig=typeof window>"u"?void 0:a.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=v),this.privConnectionFactory=new i.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(h,v,g){const m=h;return v.properties.mergeTo(m.properties),new fP(h,g)}speakTextAsync(h,v,g,m){this.speakImpl(h,!1,v,g,m)}speakSsmlAsync(h,v,g,m){this.speakImpl(h,!0,v,g,m)}async getVoicesAsync(h=""){return this.getVoices(h)}close(h,v){c.Contracts.throwIfDisposed(this.privDisposed),t.marshalPromiseToCallbacks(this.dispose(!0),h,v)}get internalData(){return this.privAdapter}createSynthesisAdapter(h,v,g){return new i.SpeechSynthesisAdapter(h,v,g,this,this.audioConfig)}createRestSynthesisAdapter(h,v){return new i.SynthesisRestAdapter(v,h)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(a.SpeechSynthesisOutputFormat[this.properties.getProperty(a.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(h,v,g,m,w){try{c.Contracts.throwIfDisposed(this.privDisposed);const C=t.createNoDashGuid();let R;w instanceof a.PushAudioOutputStreamCallback?R=new o.PushAudioOutputStreamImpl(w):w instanceof a.PullAudioOutputStream?R=w:w!==void 0?R=new r.AudioFileWriter(w):R=void 0,this.synthesisRequestQueue.enqueue(new s.SynthesisRequest(C,h,v,_=>{if(this.privSynthesizing=!1,g)try{g(_)}catch(E){m&&m(E)}g=void 0,this.adapterSpeak().catch(()=>{})},_=>{m&&m(_)},R)),this.adapterSpeak().catch(()=>{})}catch(C){if(m)if(C instanceof Error){const R=C;m(R.name+": "+R.message)}else m(C);this.dispose(!0).catch(()=>{})}}async getVoices(h){const v=t.createNoDashGuid(),g=await this.privRestAdapter.getVoicesList(v);if(g.ok&&Array.isArray(g.json)){let m=g.json;return h&&h.length>0&&(m=m.filter(w=>!!w.Locale&&w.Locale.toLowerCase()===h.toLowerCase())),new a.SynthesisVoicesResult(v,m,void 0)}else return new a.SynthesisVoicesResult(v,void 0,`Error: ${g.status}: ${g.statusText}`)}};return Ha.SpeechSynthesizer=l,Ha}var Va={},fC;function sA(){if(fC)return Va;fC=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.SynthesisResult=void 0;let i=class{constructor(r,u,o,c){this.privResultId=r,this.privReason=u,this.privErrorDetails=o,this.privProperties=c}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return Va.SynthesisResult=i,Va}var Ka={},vC;function oA(){if(vC)return Ka;vC=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.SpeechSynthesisResult=void 0;const i=U();let t=class extends i.SynthesisResult{constructor(u,o,c,a,s,l){super(u,o,a,s),this.privAudioData=c,this.privAudioDuration=l}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Ka.SpeechSynthesisResult=t,Ka}var Ja={},gC;function aA(){if(gC)return Ja;gC=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.SpeechSynthesisEventArgs=void 0;let i=class{constructor(r){this.privResult=r}get result(){return this.privResult}};return Ja.SpeechSynthesisEventArgs=i,Ja}var Ga={},mC;function cA(){if(mC)return Ga;mC=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.SpeechSynthesisWordBoundaryEventArgs=void 0;let i=class{constructor(r,u,o,c,a,s){this.privAudioOffset=r,this.privDuration=u,this.privText=o,this.privWordLength=c,this.privTextOffset=a,this.privBoundaryType=s}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return Ga.SpeechSynthesisWordBoundaryEventArgs=i,Ga}var Qa={},yC;function uA(){if(yC)return Qa;yC=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.SpeechSynthesisBookmarkEventArgs=void 0;let i=class{constructor(r,u){this.privAudioOffset=r,this.privText=u}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return Qa.SpeechSynthesisBookmarkEventArgs=i,Qa}var Ya={},SC;function lA(){if(SC)return Ya;SC=1,Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.SpeechSynthesisVisemeEventArgs=void 0;let i=class{constructor(r,u,o){this.privAudioOffset=r,this.privVisemeId=u,this.privAnimation=o}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return Ya.SpeechSynthesisVisemeEventArgs=i,Ya}var lh={},CC;function dA(){return CC||(CC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SpeechSynthesisBoundaryType=void 0,function(t){t.Word="WordBoundary",t.Punctuation="PunctuationBoundary",t.Sentence="SentenceBoundary"}(i.SpeechSynthesisBoundaryType||(i.SpeechSynthesisBoundaryType={}))}(lh)),lh}var Xa={},wC;function pA(){if(wC)return Xa;wC=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.SynthesisVoicesResult=void 0;const i=U();let t=class extends i.SynthesisResult{constructor(u,o,c){if(Array.isArray(o)){super(u,i.ResultReason.VoicesListRetrieved,void 0,new i.PropertyCollection),this.privVoices=[];for(const a of o)this.privVoices.push(new i.VoiceInfo(a))}else super(u,i.ResultReason.Canceled,c||"Error information unavailable",new i.PropertyCollection)}get voices(){return this.privVoices}};return Xa.SynthesisVoicesResult=t,Xa}var dh={},RC;function hA(){return RC||(RC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.VoiceInfo=i.SynthesisVoiceType=i.SynthesisVoiceGender=void 0;var t;(function(a){a[a.Unknown=0]="Unknown",a[a.Female=1]="Female",a[a.Male=2]="Male",a[a.Neutral=3]="Neutral"})(t=i.SynthesisVoiceGender||(i.SynthesisVoiceGender={}));var r;(function(a){a[a.Unknown=0]="Unknown",a[a.OnlineNeural=1]="OnlineNeural",a[a.OnlineStandard=2]="OnlineStandard",a[a.OfflineNeural=3]="OfflineNeural",a[a.OfflineStandard=4]="OfflineStandard",a[a.OnlineNeuralHD=5]="OnlineNeuralHD"})(r=i.SynthesisVoiceType||(i.SynthesisVoiceType={}));const u={[t[t.Neutral]]:t.Neutral,[t[t.Male]]:t.Male,[t[t.Female]]:t.Female},o={Neural:r.OnlineNeural,NeuralHD:r.OnlineNeuralHD};class c{constructor(s){if(this.privStyleList=[],s){if(this.privName=s.Name,this.privLocale=s.Locale,this.privShortName=s.ShortName,this.privLocaleName=s.LocaleName,this.privDisplayName=s.DisplayName,this.privLocalName=s.LocalName,this.privVoiceType=o[s.VoiceType]||r.Unknown,this.privGender=u[s.Gender]||t.Unknown,s.StyleList&&Array.isArray(s.StyleList))for(const l of s.StyleList)this.privStyleList.push(l);this.privSampleRateHertz=s.SampleRateHertz,this.privStatus=s.Status,s.ExtendedPropertyMap&&(this.privExtendedPropertyMap=s.ExtendedPropertyMap),this.privWordsPerMinute=s.WordsPerMinute,Array.isArray(s.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...s.SecondaryLocaleList]),Array.isArray(s.RolePlayList)&&(this.privRolePlayList=[...s.RolePlayList]),s.VoiceTag&&(this.privVoiceTag=s.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}i.VoiceInfo=c}(dh)),dh}var Za={},PC;function fA(){if(PC)return Za;PC=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.SpeakerAudioDestination=void 0;const i=de(),t=vs(),r=Ti(),u=60*30,o={[r.AudioFormatTag.PCM]:"audio/wav",[r.AudioFormatTag.MuLaw]:"audio/x-wav",[r.AudioFormatTag.MP3]:"audio/mpeg",[r.AudioFormatTag.OGG_OPUS]:"audio/ogg",[r.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[r.AudioFormatTag.ALaw]:"audio/x-wav",[r.AudioFormatTag.FLAC]:"audio/flac",[r.AudioFormatTag.AMR_WB]:"audio/amr-wb",[r.AudioFormatTag.G722]:"audio/G722"};let c=class{constructor(s){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=s||i.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(s,l,p){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(s),this.updateSourceBuffer().then(()=>{l&&l()},h=>{p&&p(h)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(s),this.privBytesReceived+=s.byteLength)}close(s,l){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{s&&s()},p=>{l&&l(p)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===r.AudioFormatTag.PCM||this.privFormat.formatTag===r.AudioFormatTag.MuLaw||this.privFormat.formatTag===r.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let p=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(p).then(()=>{p=this.privFormat.addHeader(p);const h=new Blob([p],{type:o[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(h),this.notifyPlayback().then(()=>{s&&s()},v=>{l&&l(v)})},h=>{l&&l(h)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(s){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=s;const l=o[this.privFormat.formatTag];l===void 0?console.warn(`Unknown mimeType for format ${r.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(l)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=u,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(l),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(p=>{i.Events.instance.onEvent(new i.BackgroundEvent(p))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(p=>{i.Events.instance.onEvent(new i.BackgroundEvent(p))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(p=>{i.Events.instance.onEvent(new i.BackgroundEvent(p))})):(console.warn(`Format ${r.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var s;return((s=this.privAudio)==null?void 0:s.volume)??-1}set volume(s){this.privAudio&&(this.privAudio.volume=s)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(s,l){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{s&&s()},p=>{l&&l(p)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const s=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(s)}catch{this.privAudioBuffer.unshift(s),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return Za.SpeakerAudioDestination=c,Za}var ec={},_C;function vA(){if(_C)return ec;_C=1,Object.defineProperty(ec,"__esModule",{value:!0}),ec.ConversationTranscriptionCanceledEventArgs=void 0;const i=vu();let t=class extends i.CancellationEventArgsBase{};return ec.ConversationTranscriptionCanceledEventArgs=t,ec}var tc={},EC;function gA(){if(EC)return tc;EC=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.MeetingTranscriptionCanceledEventArgs=void 0;const i=vu();let t=class extends i.CancellationEventArgsBase{};return tc.MeetingTranscriptionCanceledEventArgs=t,tc}var ph={},TC;function mA(){return TC||(TC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.PronunciationAssessmentGradingSystem=void 0,function(t){t[t.FivePoint=1]="FivePoint",t[t.HundredMark=2]="HundredMark"}(i.PronunciationAssessmentGradingSystem||(i.PronunciationAssessmentGradingSystem={}))}(ph)),ph}var hh={},IC;function yA(){return IC||(IC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.PronunciationAssessmentGranularity=void 0,function(t){t[t.Phoneme=1]="Phoneme",t[t.Word=2]="Word",t[t.FullText=3]="FullText"}(i.PronunciationAssessmentGranularity||(i.PronunciationAssessmentGranularity={}))}(hh)),hh}var rc={},AC;function SA(){if(AC)return rc;AC=1,Object.defineProperty(rc,"__esModule",{value:!0}),rc.PronunciationAssessmentConfig=void 0;const i=ge(),t=U();let r=class vP{constructor(o,c=t.PronunciationAssessmentGradingSystem.FivePoint,a=t.PronunciationAssessmentGranularity.Phoneme,s=!1){i.Contracts.throwIfNullOrUndefined(o,"referenceText"),this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,o),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_GradingSystem,t.PronunciationAssessmentGradingSystem[c]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Granularity,t.PronunciationAssessmentGranularity[a]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,String(s))}static fromJSON(o){i.Contracts.throwIfNullOrUndefined(o,"json");const c=new vP("");return c.privProperties=new t.PropertyCollection,c.properties.setProperty(t.PropertyId.PronunciationAssessment_Json,o),c}toJSON(){return this.updateJson(),this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Params)}applyTo(o){this.updateJson();const c=o.internalData;c.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,c.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(t.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,c.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(o){i.Contracts.throwIfNullOrWhitespace(o,"referenceText"),this.properties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,o)}set phonemeAlphabet(o){i.Contracts.throwIfNullOrWhitespace(o,"phonemeAlphabet"),this.privPhonemeAlphabet=o}set enableMiscue(o){const c=o?"true":"false";this.properties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,c)}get enableMiscue(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(o){this.privNBestPhonemeCount=o}set enableProsodyAssessment(o){this.privEnableProsodyAssessment=o}enableContentAssessmentWithTopic(o){this.privContentAssessmentTopic=o}get properties(){return this.privProperties}updateJson(){const o=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Json,"{}"),c=JSON.parse(o),a=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText);a&&(c.referenceText=a);const s=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_GradingSystem);s&&(c.gradingSystem=s);const l=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Granularity);l&&(c.granularity=l),this.privPhonemeAlphabet&&(c.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(c.nbestPhonemeCount=this.privNBestPhonemeCount),c.enableProsodyAssessment=this.privEnableProsodyAssessment,c.dimension="Comprehensive",this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue)&&(c.enableMiscue=this.enableMiscue),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Params,JSON.stringify(c))}};return rc.PronunciationAssessmentConfig=r,rc}var hi={},bC;function CA(){if(bC)return hi;bC=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.PronunciationAssessmentResult=hi.ContentAssessmentResult=void 0;const i=ge(),t=U();class r{constructor(c){this.privPronJson=c}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}hi.ContentAssessmentResult=r;let u=class gP{constructor(c){const a=JSON.parse(c);i.Contracts.throwIfNullOrUndefined(a.NBest[0],"NBest"),this.privPronJson=a.NBest[0]}static fromResult(c){i.Contracts.throwIfNullOrUndefined(c,"result");const a=c.properties.getProperty(t.PropertyId.SpeechServiceResponse_JsonResult);return i.Contracts.throwIfNullOrUndefined(a,"json"),new gP(a)}get detailResult(){return this.privPronJson}get accuracyScore(){var c;return(c=this.detailResult.PronunciationAssessment)==null?void 0:c.AccuracyScore}get pronunciationScore(){var c;return(c=this.detailResult.PronunciationAssessment)==null?void 0:c.PronScore}get completenessScore(){var c;return(c=this.detailResult.PronunciationAssessment)==null?void 0:c.CompletenessScore}get fluencyScore(){var c;return(c=this.detailResult.PronunciationAssessment)==null?void 0:c.FluencyScore}get prosodyScore(){var c;return(c=this.detailResult.PronunciationAssessment)==null?void 0:c.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new r(this.detailResult)}};return hi.PronunciationAssessmentResult=u,hi}var nc={},kC;function wA(){if(kC)return nc;kC=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.AvatarConfig=void 0;const i=ge(),t=U();let r=class{constructor(o,c,a){this.privCustomized=!1,this.privUseBuiltInVoice=!1,i.Contracts.throwIfNullOrWhitespace(o,"character"),this.character=o,this.style=c,a===void 0&&(a=new t.AvatarVideoFormat),this.videoFormat=a}get customized(){return this.privCustomized}set customized(o){this.privCustomized=o}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(o){this.privUseBuiltInVoice=o}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(o){this.privBackgroundColor=o}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(o){this.privBackgroundImage=o}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(o){this.privRemoteIceServers=o}};return nc.AvatarConfig=r,nc}var fh={},OC;function RA(){return OC||(OC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.AvatarEventArgs=i.AvatarEventTypes=void 0,function(r){r.SwitchedToSpeaking="SwitchedToSpeaking",r.SwitchedToIdle="SwitchedToIdle",r.SessionClosed="SessionClosed"}(i.AvatarEventTypes||(i.AvatarEventTypes={}));class t{constructor(u,o){this.privOffset=u,this.privDescription=o}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}i.AvatarEventArgs=t}(fh)),fh}var ic={},sc={},MC;function mP(){if(MC)return sc;MC=1,Object.defineProperty(sc,"__esModule",{value:!0}),sc.SpeechSynthesisConnectionFactory=void 0;const i=lt(),t=U(),r=vr(),u=te(),o=Pt(),c=kn();let a=class{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(l,p,h){let v=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),m=r.ConnectionFactoryBase.getHostSuffix(g),w=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),C=w===void 0?"tts":"voice",R=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+g+"."+C+".speech"+m),_={},E={};p.token!==void 0&&p.token!==""&&(E[p.headerName]=p.token),E[o.HeaderNames.ConnectionId]=h,w!==void 0&&w!==""&&(!v||v.search(c.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(_[c.QueryParameterNames.CustomVoiceDeploymentId]=w),l.avatarEnabled&&(!v||v.search(c.QueryParameterNames.EnableAvatar)===-1)&&(_[c.QueryParameterNames.EnableAvatar]="true"),v||(v=R+this.synthesisUri),l.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,v);const T=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(v,_,E,new u.WebsocketMessageFormatter,i.ProxyInfo.fromParameters(l.parameters),T,h)}};return sc.SpeechSynthesisConnectionFactory=a,sc}var xC;function PA(){if(xC)return ic;xC=1,Object.defineProperty(ic,"__esModule",{value:!0}),ic.AvatarSynthesizer=void 0;const i=mP(),t=te(),r=de(),u=fu(),o=U(),c=ge(),a=of();let s=class extends o.Synthesizer{constructor(p,h){super(p),c.Contracts.throwIfNullOrUndefined(h,"avatarConfig"),this.privConnectionFactory=new i.SpeechSynthesisConnectionFactory,this.privAvatarConfig=h,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(o.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(p){c.Contracts.throwIfNullOrUndefined(p,"peerConnection"),this.privIceServers=p.getConfiguration().iceServers,c.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const h=new r.Deferred;p.onicegatheringstatechange=()=>{r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering state: "+p.iceGatheringState,r.EventType.Debug)),p.iceGatheringState==="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering complete.",r.EventType.Info)),h.resolve())},p.onicecandidate=C=>{C.candidate?r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: "+C.candidate.candidate,r.EventType.Debug)):(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: complete",r.EventType.Debug)),h.resolve())},setTimeout(()=>{p.iceGatheringState!=="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering timeout.",r.EventType.Warning)),h.resolve())},2e3);const v=await p.createOffer();await p.setLocalDescription(v),await h.promise,r.Events.instance.onEvent(new r.PlatformEvent("peer connection: got local SDP.",r.EventType.Info)),this.privProperties.setProperty(o.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(p.localDescription));const g=await this.speak("",!1);if(g.reason!==o.ResultReason.SynthesizingAudioCompleted)return new o.SynthesisResult(g.resultId,g.reason,g.errorDetails,g.properties);const m=atob(g.properties.getProperty(o.PropertyId.TalkingAvatarService_WebRTC_SDP)),w=new RTCSessionDescription(JSON.parse(m));return await p.setRemoteDescription(w),new o.SynthesisResult(g.resultId,g.reason,void 0,g.properties)}async speakTextAsync(p){const h=await this.speak(p,!1);return new o.SynthesisResult(h.resultId,h.reason,h.errorDetails,h.properties)}async speakSsmlAsync(p){const h=await this.speak(p,!0);return new o.SynthesisResult(h.resultId,h.reason,h.errorDetails,h.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return c.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(p,h,v){return new t.AvatarSynthesisAdapter(p,h,v,this,this.privAvatarConfig)}createRestSynthesisAdapter(p,h){}createSynthesizerConfig(p){const h=super.createSynthesizerConfig(p);return h.avatarEnabled=!0,h}async speak(p,h){const v=r.createNoDashGuid(),g=new r.Deferred;return this.synthesisRequestQueue.enqueue(new a.SynthesisRequest(v,p,h,m=>{g.resolve(m),this.privSynthesizing=!1,this.adapterSpeak()},m=>{g.reject(m),this.privSynthesizing=!1})),this.adapterSpeak(),g.promise}};return ic.AvatarSynthesizer=s,ic}var fi={},DC;function _A(){if(DC)return fi;DC=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.AvatarVideoFormat=fi.Coordinate=void 0;class i{constructor(u,o){this.x=u,this.y=o}}fi.Coordinate=i;let t=class{constructor(u="H264",o=2e6,c=1920,a=1080){this.codec=u,this.bitrate=o,this.width=c,this.height=a}setCropRange(u,o){this.cropRange={bottomRight:o,topLeft:u}}};return fi.AvatarVideoFormat=t,fi}var oc={},jC;function EA(){if(jC)return oc;jC=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.AvatarWebRTCConnectionResult=void 0;const i=U();let t=class extends i.SynthesisResult{constructor(u,o,c,a,s){super(o,c,a,s),this.privSDPAnswer=u}get SDPAnswer(){return this.privSDPAnswer}};return oc.AvatarWebRTCConnectionResult=t,oc}var ac={},NC;function TA(){if(NC)return ac;NC=1,Object.defineProperty(ac,"__esModule",{value:!0}),ac.Diagnostics=void 0;const i=lt(),t=de();let r=class{static SetLoggingLevel(o){this.privListener=new i.ConsoleLoggingListener(o),t.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(o){if(typeof window>"u")this.privListener&&(this.privListener.logPath=o);else throw new Error("File system logging not available in browser.")}static set onLogOutput(o){this.privListener&&(this.privListener.logCallback=o)}};return ac.Diagnostics=r,r.privListener=void 0,ac}var zC;function U(){return zC||(zC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=HR();Object.defineProperty(i,"AudioConfig",{enumerable:!0,get:function(){return t.AudioConfig}});var r=Ti();Object.defineProperty(i,"AudioStreamFormat",{enumerable:!0,get:function(){return r.AudioStreamFormat}}),Object.defineProperty(i,"AudioFormatTag",{enumerable:!0,get:function(){return r.AudioFormatTag}});var u=UR();Object.defineProperty(i,"AudioInputStream",{enumerable:!0,get:function(){return u.AudioInputStream}}),Object.defineProperty(i,"PullAudioInputStream",{enumerable:!0,get:function(){return u.PullAudioInputStream}}),Object.defineProperty(i,"PushAudioInputStream",{enumerable:!0,get:function(){return u.PushAudioInputStream}});var o=vs();Object.defineProperty(i,"AudioOutputStream",{enumerable:!0,get:function(){return o.AudioOutputStream}}),Object.defineProperty(i,"PullAudioOutputStream",{enumerable:!0,get:function(){return o.PullAudioOutputStream}}),Object.defineProperty(i,"PushAudioOutputStream",{enumerable:!0,get:function(){return o.PushAudioOutputStream}});var c=q1();Object.defineProperty(i,"CancellationReason",{enumerable:!0,get:function(){return c.CancellationReason}});var a=B1();Object.defineProperty(i,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return a.PullAudioInputStreamCallback}});var s=F1();Object.defineProperty(i,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return s.PushAudioOutputStreamCallback}});var l=U1();Object.defineProperty(i,"KeywordRecognitionModel",{enumerable:!0,get:function(){return l.KeywordRecognitionModel}});var p=$1();Object.defineProperty(i,"SessionEventArgs",{enumerable:!0,get:function(){return p.SessionEventArgs}});var h=W1();Object.defineProperty(i,"RecognitionEventArgs",{enumerable:!0,get:function(){return h.RecognitionEventArgs}});var v=H1();Object.defineProperty(i,"OutputFormat",{enumerable:!0,get:function(){return v.OutputFormat}});var g=V1();Object.defineProperty(i,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return g.IntentRecognitionEventArgs}});var m=K1();Object.defineProperty(i,"RecognitionResult",{enumerable:!0,get:function(){return m.RecognitionResult}});var w=J1();Object.defineProperty(i,"SpeechRecognitionResult",{enumerable:!0,get:function(){return w.SpeechRecognitionResult}});var C=G1();Object.defineProperty(i,"IntentRecognitionResult",{enumerable:!0,get:function(){return C.IntentRecognitionResult}});var R=Q1();Object.defineProperty(i,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return R.LanguageUnderstandingModel}});var _=Y1();Object.defineProperty(i,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return _.SpeechRecognitionEventArgs}}),Object.defineProperty(i,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return _.ConversationTranscriptionEventArgs}}),Object.defineProperty(i,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return _.MeetingTranscriptionEventArgs}});var E=X1();Object.defineProperty(i,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return E.SpeechRecognitionCanceledEventArgs}});var T=Z1();Object.defineProperty(i,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return T.TranslationRecognitionEventArgs}});var D=eI();Object.defineProperty(i,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return D.TranslationSynthesisEventArgs}});var N=KR();Object.defineProperty(i,"TranslationRecognitionResult",{enumerable:!0,get:function(){return N.TranslationRecognitionResult}});var H=tI();Object.defineProperty(i,"TranslationSynthesisResult",{enumerable:!0,get:function(){return H.TranslationSynthesisResult}});var ie=rI();Object.defineProperty(i,"ResultReason",{enumerable:!0,get:function(){return ie.ResultReason}});var Y=nI();Object.defineProperty(i,"SpeechConfig",{enumerable:!0,get:function(){return Y.SpeechConfig}}),Object.defineProperty(i,"SpeechConfigImpl",{enumerable:!0,get:function(){return Y.SpeechConfigImpl}});var Ie=iI();Object.defineProperty(i,"SpeechTranslationConfig",{enumerable:!0,get:function(){return Ie.SpeechTranslationConfig}}),Object.defineProperty(i,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return Ie.SpeechTranslationConfigImpl}});var De=GR();Object.defineProperty(i,"PropertyCollection",{enumerable:!0,get:function(){return De.PropertyCollection}});var Xe=rf();Object.defineProperty(i,"PropertyId",{enumerable:!0,get:function(){return Xe.PropertyId}});var Be=sI();Object.defineProperty(i,"Recognizer",{enumerable:!0,get:function(){return Be.Recognizer}});var Ee=oI();Object.defineProperty(i,"SpeechRecognizer",{enumerable:!0,get:function(){return Ee.SpeechRecognizer}});var pe=aI();Object.defineProperty(i,"IntentRecognizer",{enumerable:!0,get:function(){return pe.IntentRecognizer}});var Ce=cI();Object.defineProperty(i,"VoiceProfileType",{enumerable:!0,get:function(){return Ce.VoiceProfileType}});var ae=uI();Object.defineProperty(i,"TranslationRecognizer",{enumerable:!0,get:function(){return ae.TranslationRecognizer}});var se=lI();Object.defineProperty(i,"Translations",{enumerable:!0,get:function(){return se.Translations}});var $=dI();Object.defineProperty(i,"NoMatchReason",{enumerable:!0,get:function(){return $.NoMatchReason}});var ee=pI();Object.defineProperty(i,"NoMatchDetails",{enumerable:!0,get:function(){return ee.NoMatchDetails}});var V=hI();Object.defineProperty(i,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return V.TranslationRecognitionCanceledEventArgs}});var O=fI();Object.defineProperty(i,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return O.IntentRecognitionCanceledEventArgs}});var L=rP();Object.defineProperty(i,"CancellationDetailsBase",{enumerable:!0,get:function(){return L.CancellationDetailsBase}});var ce=vI();Object.defineProperty(i,"CancellationDetails",{enumerable:!0,get:function(){return ce.CancellationDetails}});var fe=gI();Object.defineProperty(i,"CancellationErrorCode",{enumerable:!0,get:function(){return fe.CancellationErrorCode}});var Se=mI();Object.defineProperty(i,"ConnectionEventArgs",{enumerable:!0,get:function(){return Se.ConnectionEventArgs}});var me=yI();Object.defineProperty(i,"ServiceEventArgs",{enumerable:!0,get:function(){return me.ServiceEventArgs}});var ke=ZR();Object.defineProperty(i,"Connection",{enumerable:!0,get:function(){return ke.Connection}});var _e=SI();Object.defineProperty(i,"PhraseListGrammar",{enumerable:!0,get:function(){return _e.PhraseListGrammar}});var Oe=nf();Object.defineProperty(i,"DialogServiceConfig",{enumerable:!0,get:function(){return Oe.DialogServiceConfig}});var dt=CI();Object.defineProperty(i,"BotFrameworkConfig",{enumerable:!0,get:function(){return dt.BotFrameworkConfig}});var Ar=wI();Object.defineProperty(i,"CustomCommandsConfig",{enumerable:!0,get:function(){return Ar.CustomCommandsConfig}});var Ii=PI();Object.defineProperty(i,"DialogServiceConnector",{enumerable:!0,get:function(){return Ii.DialogServiceConnector}});var gr=_I();Object.defineProperty(i,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return gr.ActivityReceivedEventArgs}});var Gr=TI();Object.defineProperty(i,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return Gr.TurnStatusReceivedEventArgs}});var Ai=II();Object.defineProperty(i,"ServicePropertyChannel",{enumerable:!0,get:function(){return Ai.ServicePropertyChannel}});var Zt=AI();Object.defineProperty(i,"ProfanityOption",{enumerable:!0,get:function(){return Zt.ProfanityOption}});var _t=bI();Object.defineProperty(i,"BaseAudioPlayer",{enumerable:!0,get:function(){return _t.BaseAudioPlayer}});var bi=kI();Object.defineProperty(i,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return bi.ConnectionMessageEventArgs}});var Qr=XR();Object.defineProperty(i,"ConnectionMessage",{enumerable:!0,get:function(){return Qr.ConnectionMessage}});var br=OI();Object.defineProperty(i,"VoiceProfile",{enumerable:!0,get:function(){return br.VoiceProfile}});var Vt=MI();Object.defineProperty(i,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return Vt.VoiceProfileEnrollmentResult}}),Object.defineProperty(i,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return Vt.VoiceProfileEnrollmentCancellationDetails}});var Yr=xI();Object.defineProperty(i,"VoiceProfileResult",{enumerable:!0,get:function(){return Yr.VoiceProfileResult}}),Object.defineProperty(i,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return Yr.VoiceProfileCancellationDetails}});var On=DI();Object.defineProperty(i,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return On.VoiceProfilePhraseResult}});var ki=jI();Object.defineProperty(i,"VoiceProfileClient",{enumerable:!0,get:function(){return ki.VoiceProfileClient}});var Dt=NI();Object.defineProperty(i,"SpeakerRecognizer",{enumerable:!0,get:function(){return Dt.SpeakerRecognizer}});var Mn=zI();Object.defineProperty(i,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return Mn.SpeakerIdentificationModel}});var kr=LI();Object.defineProperty(i,"SpeakerVerificationModel",{enumerable:!0,get:function(){return kr.SpeakerVerificationModel}});var er=qI();Object.defineProperty(i,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return er.AutoDetectSourceLanguageConfig}});var Or=BI();Object.defineProperty(i,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Or.AutoDetectSourceLanguageResult}});var Mr=FI();Object.defineProperty(i,"SourceLanguageConfig",{enumerable:!0,get:function(){return Mr.SourceLanguageConfig}});var jt=UI();Object.defineProperty(i,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return jt.SpeakerRecognitionResult}}),Object.defineProperty(i,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return jt.SpeakerRecognitionResultType}}),Object.defineProperty(i,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return jt.SpeakerRecognitionCancellationDetails}});var nt=sf();Object.defineProperty(i,"Conversation",{enumerable:!0,get:function(){return nt.Conversation}}),Object.defineProperty(i,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return nt.ConversationExpirationEventArgs}}),Object.defineProperty(i,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return nt.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(i,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return nt.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(i,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return nt.ConversationTranslationEventArgs}}),Object.defineProperty(i,"ConversationTranslationResult",{enumerable:!0,get:function(){return nt.ConversationTranslationResult}}),Object.defineProperty(i,"ConversationTranslator",{enumerable:!0,get:function(){return nt.ConversationTranslator}}),Object.defineProperty(i,"ConversationTranscriber",{enumerable:!0,get:function(){return nt.ConversationTranscriber}}),Object.defineProperty(i,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return nt.ConversationTranscriptionResult}}),Object.defineProperty(i,"Meeting",{enumerable:!0,get:function(){return nt.Meeting}}),Object.defineProperty(i,"MeetingTranscriber",{enumerable:!0,get:function(){return nt.MeetingTranscriber}}),Object.defineProperty(i,"Participant",{enumerable:!0,get:function(){return nt.Participant}}),Object.defineProperty(i,"ParticipantChangedReason",{enumerable:!0,get:function(){return nt.ParticipantChangedReason}}),Object.defineProperty(i,"User",{enumerable:!0,get:function(){return nt.User}});var xn=of();Object.defineProperty(i,"Synthesizer",{enumerable:!0,get:function(){return xn.Synthesizer}});var Xr=$R();Object.defineProperty(i,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Xr.SpeechSynthesisOutputFormat}});var ms=iA();Object.defineProperty(i,"SpeechSynthesizer",{enumerable:!0,get:function(){return ms.SpeechSynthesizer}});var Zr=sA();Object.defineProperty(i,"SynthesisResult",{enumerable:!0,get:function(){return Zr.SynthesisResult}});var en=oA();Object.defineProperty(i,"SpeechSynthesisResult",{enumerable:!0,get:function(){return en.SpeechSynthesisResult}});var tn=aA();Object.defineProperty(i,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return tn.SpeechSynthesisEventArgs}});var mr=cA();Object.defineProperty(i,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return mr.SpeechSynthesisWordBoundaryEventArgs}});var xr=uA();Object.defineProperty(i,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return xr.SpeechSynthesisBookmarkEventArgs}});var tr=lA();Object.defineProperty(i,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return tr.SpeechSynthesisVisemeEventArgs}});var rr=dA();Object.defineProperty(i,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return rr.SpeechSynthesisBoundaryType}});var Dn=pA();Object.defineProperty(i,"SynthesisVoicesResult",{enumerable:!0,get:function(){return Dn.SynthesisVoicesResult}});var Dr=hA();Object.defineProperty(i,"SynthesisVoiceGender",{enumerable:!0,get:function(){return Dr.SynthesisVoiceGender}}),Object.defineProperty(i,"SynthesisVoiceType",{enumerable:!0,get:function(){return Dr.SynthesisVoiceType}}),Object.defineProperty(i,"VoiceInfo",{enumerable:!0,get:function(){return Dr.VoiceInfo}});var Oi=fA();Object.defineProperty(i,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Oi.SpeakerAudioDestination}});var Mi=vA();Object.defineProperty(i,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Mi.ConversationTranscriptionCanceledEventArgs}});var z=gA();Object.defineProperty(i,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return z.MeetingTranscriptionCanceledEventArgs}});var G=mA();Object.defineProperty(i,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return G.PronunciationAssessmentGradingSystem}});var K=yA();Object.defineProperty(i,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return K.PronunciationAssessmentGranularity}});var J=SA();Object.defineProperty(i,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return J.PronunciationAssessmentConfig}});var ve=CA();Object.defineProperty(i,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return ve.PronunciationAssessmentResult}});var xe=aP();Object.defineProperty(i,"LanguageIdMode",{enumerable:!0,get:function(){return xe.LanguageIdMode}});var yr=wA();Object.defineProperty(i,"AvatarConfig",{enumerable:!0,get:function(){return yr.AvatarConfig}});var Nt=RA();Object.defineProperty(i,"AvatarEventArgs",{enumerable:!0,get:function(){return Nt.AvatarEventArgs}});var Et=PA();Object.defineProperty(i,"AvatarSynthesizer",{enumerable:!0,get:function(){return Et.AvatarSynthesizer}});var zt=_A();Object.defineProperty(i,"AvatarVideoFormat",{enumerable:!0,get:function(){return zt.AvatarVideoFormat}}),Object.defineProperty(i,"Coordinate",{enumerable:!0,get:function(){return zt.Coordinate}});var nr=EA();Object.defineProperty(i,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return nr.AvatarWebRTCConnectionResult}});var it=TA();Object.defineProperty(i,"Diagnostics",{enumerable:!0,get:function(){return it.Diagnostics}});var Ke=qR();Object.defineProperty(i,"LogLevel",{enumerable:!0,get:function(){return Ke.LogLevel}})}(Jp)),Jp}var LC;function IA(){if(LC)return jo;LC=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.ProxyInfo=void 0;const i=U();let t=class yP{constructor(u,o,c,a){this.privProxyHostName=u,this.privProxyPort=o,this.privProxyUserName=c,this.privProxyPassword=a}static fromParameters(u){return new yP(u.getProperty(i.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(u.getProperty(i.PropertyId.SpeechServiceConnection_ProxyPort),10),u.getProperty(i.PropertyId.SpeechServiceConnection_ProxyUserName),u.getProperty(i.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(u){return this.fromParameters(u.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return jo.ProxyInfo=t,jo}var cc={},vh,qC;function AA(){if(qC)return vh;qC=1;const i=new Set(["json","buffer","string"]);return vh=t=>(...r)=>{const u=new Set;let o,c,a,s="";return r.forEach(l=>{if(typeof l=="string")if(l.toUpperCase()===l)if(o){const p=`Can't set method to ${l}, already set to ${o}.`;throw new Error(p)}else o=l;else if(l.startsWith("http:")||l.startsWith("https:"))s=l;else if(i.has(l))c=l;else throw new Error(`Unknown encoding, ${l}`);else if(typeof l=="number")u.add(l);else if(typeof l=="object")if(Array.isArray(l)||l instanceof Set)l.forEach(p=>u.add(p));else{if(a)throw new Error("Cannot set headers twice.");a=l}else throw new Error(`Unknown type: ${typeof l}`)}),o||(o="GET"),u.size===0&&u.add(200),t(u,o,c,a,s)},vh}var gh,BC;function bA(){if(BC)return gh;BC=1;const i=AA();class t extends Error{constructor(o,...c){super(...c),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.name="StatusError",this.message=o.statusMessage,this.statusCode=o.status,this.res=o,this.json=o.json.bind(o),this.text=o.text.bind(o),this.arrayBuffer=o.arrayBuffer.bind(o);let a;Object.defineProperty(this,"responseBody",{get:()=>(a||(a=this.arrayBuffer()),a)}),this.headers={};for(const[l,p]of o.headers.entries())this.headers[l.toLowerCase()]=p}}return gh=i((u,o,c,a,s)=>async(l,p,h={})=>{l=s+(l||"");let v=new URL(l);if(a||(a={}),v.username&&(a.Authorization="Basic "+btoa(v.username+":"+v.password),v=new URL(v.protocol+"//"+v.host+v.pathname+v.search)),v.protocol!=="https:"&&v.protocol!=="http:")throw new Error(`Unknown protocol, ${v.protocol}`);if(p&&!(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="string"))if(typeof p=="object")p=JSON.stringify(p),a["Content-Type"]="application/json";else throw new Error("Unknown body type.");h=new Headers({...a||{},...h});const g=await fetch(v,{method:o,headers:h,body:p});if(g.statusCode=g.status,!u.has(g.status))throw new t(g);return c==="json"?g.json():c==="buffer"?g.arrayBuffer():c==="string"?g.text():g}),gh}var FC;function kA(){return FC||(FC=1,function(i){var t=cc&&cc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(i,"__esModule",{value:!0}),i.RestMessageAdapter=i.RestRequestType=void 0;const r=t(bA()),u=de();var o;(function(a){a.Get="GET",a.Post="POST",a.Delete="DELETE",a.File="file"})(o=i.RestRequestType||(i.RestRequestType={}));let c=class{constructor(s){if(!s)throw new u.ArgumentNullError("configParams");this.privHeaders=s.headers,this.privIgnoreCache=s.ignoreCache}static extractHeaderValue(s,l){let p="";try{const h=l.trim().split(/[\r\n]+/),v={};h.forEach(g=>{const m=g.split(": "),w=m.shift().toLowerCase(),C=m.join(": ");v[w]=C}),p=v[s.toLowerCase()]}catch{}return p}set options(s){this.privHeaders=s.headers,this.privIgnoreCache=s.ignoreCache}setHeaders(s,l){this.privHeaders[s]=l}request(s,l,p={},h=null){const v=new u.Deferred,g=s===o.File?"POST":s,m=(C,R={})=>{const _=C;return{data:JSON.stringify(R),headers:JSON.stringify(C.headers),json:R,ok:C.statusCode>=200&&C.statusCode<300,status:C.statusCode,statusText:R.error?R.error.message:_.statusText?_.statusText:_.statusMessage}},w=C=>{const R=r.default(l,g,this.privHeaders,200,201,202,204,400,401,402,403,404),_=this.queryParams(p)===""?"":`?${this.queryParams(p)}`;R(_,C).then(async E=>{if(s===o.Delete||E.statusCode===204)v.resolve(m(E));else try{const T=await E.json();v.resolve(m(E,T))}catch{v.resolve(m(E))}}).catch(E=>{v.reject(E)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),s===o.Post&&h&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),w(h),v.promise}queryParams(s={}){return Object.keys(s).map(l=>encodeURIComponent(l)+"="+encodeURIComponent(s[l])).join("&")}};i.RestMessageAdapter=c}(cc)),cc}var uc={},UC;function SP(){if(UC)return uc;UC=1,Object.defineProperty(uc,"__esModule",{value:!0}),uc.RestConfigBase=void 0;let i=class bl{static get requestOptions(){return bl.privDefaultRequestOptions}static get configParams(){return bl.privDefaultParams}static get restErrors(){return bl.privRestErrors}};return uc.RestConfigBase=i,i.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},i.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},i.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},uc}var $C;function lt(){return $C||($C=1,function(i){var t=ti&&ti.__createBinding||(Object.create?function(u,o,c,a){a===void 0&&(a=c),Object.defineProperty(u,a,{enumerable:!0,get:function(){return o[c]}})}:function(u,o,c,a){a===void 0&&(a=c),u[a]=o[c]}),r=ti&&ti.__exportStar||function(u,o){for(var c in u)c!=="default"&&!o.hasOwnProperty(c)&&t(o,u,c)};Object.defineProperty(i,"__esModule",{value:!0}),r(M1(),i),r(x1(),i),r(D1(),i),r(j1(),i),r(N1(),i),r(z1(),i),r(BR(),i),r(L1(),i),r(IA(),i),r(kA(),i),r(SP(),i)}(ti)),ti}var WC;function OA(){if(WC)return bo;WC=1,Object.defineProperty(bo,"__esModule",{value:!0}),bo.IntentConnectionFactory=void 0;const i=lt(),t=U(),r=vr(),u=te(),o=Pt();let c=class extends r.ConnectionFactoryBase{create(s,l,p){let h=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint);if(!h){const w=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_IntentRegion),C=r.ConnectionFactoryBase.getHostSuffix(w);h=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+w+".sr.speech"+C)+"/speech/recognition/interactive/cognitiveservices/v1"}const v={format:"simple",language:s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(s,v,h);const g={};l.token!==void 0&&l.token!==""&&(g[l.headerName]=l.token),g[o.HeaderNames.ConnectionId]=p,s.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,h);const m=s.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(h,v,g,new u.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(s),m,p)}getSpeechRegionFromIntentRegion(s){switch(s){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return s}}};return bo.IntentConnectionFactory=c,bo}var vi={},HC;function MA(){if(HC)return vi;HC=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.VoiceProfileConnectionFactory=vi.SpeakerRecognitionConnectionFactory=void 0;const i=lt(),t=U(),r=vr(),u=te(),o=Pt();class c extends r.ConnectionFactoryBase{create(p,h,v,g){let m=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint);if(!m){const _=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),E=r.ConnectionFactoryBase.getHostSuffix(_),T=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`wss://${_}.spr-frontend.speech${E}`),D=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");m=`${T}/speaker/ws/${this.scenarioToPath(D)}/${v}`}const w={format:"simple",language:p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(p,w,m);const C={};h.token!==void 0&&h.token!==""&&(C[h.headerName]=h.token),C[o.HeaderNames.ConnectionId]=g,C[o.HeaderNames.SpIDAuthKey]=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Key),p.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,m);const R=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(m,w,C,new u.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(p),R,g)}scenarioToPath(p){switch(p){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}let a=class extends c{create(p,h,v){return super.create(p,h,"recognition",v)}};vi.SpeakerRecognitionConnectionFactory=a;class s extends c{create(p,h,v){return super.create(p,h,"profile",v)}}return vi.VoiceProfileConnectionFactory=s,vi}var mh={},VC;function af(){return VC||(VC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.RecognitionEndedEvent=i.RecognitionCompletionStatus=i.RecognitionStartedEvent=i.ConnectingToServiceEvent=i.ListeningStartedEvent=i.RecognitionTriggeredEvent=i.SpeechRecognitionEvent=void 0;const t=de();class r extends t.PlatformEvent{constructor(h,v,g,m=t.EventType.Info){super(h,m),this.privRequestId=v,this.privSessionId=g}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}i.SpeechRecognitionEvent=r;class u extends r{constructor(h,v,g,m){super("RecognitionTriggeredEvent",h,v),this.privAudioSourceId=g,this.privAudioNodeId=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}i.RecognitionTriggeredEvent=u;class o extends r{constructor(h,v,g,m){super("ListeningStartedEvent",h,v),this.privAudioSourceId=g,this.privAudioNodeId=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}i.ListeningStartedEvent=o;class c extends r{constructor(h,v,g){super("ConnectingToServiceEvent",h,g),this.privAuthFetchEventid=v}get authFetchEventid(){return this.privAuthFetchEventid}}i.ConnectingToServiceEvent=c;class a extends r{constructor(h,v,g,m,w){super("RecognitionStartedEvent",h,w),this.privAudioSourceId=v,this.privAudioNodeId=g,this.privAuthFetchEventId=m}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}i.RecognitionStartedEvent=a;var s;(function(p){p[p.Success=0]="Success",p[p.AudioSourceError=1]="AudioSourceError",p[p.AudioSourceTimeout=2]="AudioSourceTimeout",p[p.AuthTokenFetchError=3]="AuthTokenFetchError",p[p.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",p[p.UnAuthorized=5]="UnAuthorized",p[p.ConnectTimeout=6]="ConnectTimeout",p[p.ConnectError=7]="ConnectError",p[p.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",p[p.UnknownError=9]="UnknownError"})(s=i.RecognitionCompletionStatus||(i.RecognitionCompletionStatus={}));class l extends r{constructor(h,v,g,m,w,C,R,_){super("RecognitionEndedEvent",h,w,R===s.Success?t.EventType.Info:t.EventType.Error),this.privAudioSourceId=v,this.privAudioNodeId=g,this.privAuthFetchEventId=m,this.privStatus=R,this.privError=_,this.privServiceTag=C}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}i.RecognitionEndedEvent=l}(mh)),mh}var lc={},dc={},KC;function gs(){if(KC)return dc;KC=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.SpeechConnectionMessage=void 0;const i=de(),t=Pt();class r extends i.ConnectionMessage{constructor(o,c,a,s,l,p,h,v){if(!c)throw new i.ArgumentNullError("path");if(!a)throw new i.ArgumentNullError("requestId");const g={};if(g[t.HeaderNames.Path]=c,g[t.HeaderNames.RequestId]=a,g[t.HeaderNames.RequestTimestamp]=new Date().toISOString(),s&&(g[t.HeaderNames.ContentType]=s),p&&(g[t.HeaderNames.RequestStreamId]=p),h)for(const m in h)m&&(g[m]=h[m]);v?super(o,l,g,v):super(o,l,g),this.privPath=c,this.privRequestId=a,this.privContentType=s,this.privStreamId=p,this.privAdditionalHeaders=h}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(o){let c=null,a=null,s=null,l=null;const p={};if(o.headers)for(const h in o.headers)h&&(h.toLowerCase()===t.HeaderNames.Path.toLowerCase()?c=o.headers[h]:h.toLowerCase()===t.HeaderNames.RequestId.toLowerCase()?a=o.headers[h]:h.toLowerCase()===t.HeaderNames.ContentType.toLowerCase()?s=o.headers[h]:h.toLowerCase()===t.HeaderNames.RequestStreamId.toLowerCase()?l=o.headers[h]:p[h]=o.headers[h]);return new r(o.messageType,c,a,s,o.body,l,p,o.id)}}return dc.SpeechConnectionMessage=r,dc}var JC;function xA(){if(JC)return lc;JC=1,Object.defineProperty(lc,"__esModule",{value:!0}),lc.ServiceRecognizerBase=void 0;const i=lt(),t=de(),r=U(),u=te(),o=gs();let c=class au{constructor(s,l,p,h,v){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!s)throw new t.ArgumentNullError("authentication");if(!l)throw new t.ArgumentNullError("connectionFactory");if(!p)throw new t.ArgumentNullError("audioSource");if(!h)throw new t.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=h.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=s,this.privConnectionFactory=l,this.privAudioSource=p,this.privRecognizerConfig=h,this.privIsDisposed=!1,this.privRecognizer=v,this.privRequestSession=new u.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new t.EventSource,this.privServiceEvents=new t.EventSource,this.privDynamicGrammar=new u.DynamicGrammarBuilder,this.privSpeechContext=new u.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new u.AgentConfig,this.privRecognizerConfig.parameters.getProperty(r.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=t.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(m=>{if(m.name==="ConnectionClosedEvent"){const w=m;(w.statusCode===1003||w.statusCode===1007||w.statusCode===1002||w.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(r.CancellationReason.Error,w.statusCode===1007?r.CancellationErrorCode.BadRequestParameters:r.CancellationErrorCode.ConnectionFailure,`${w.reason} websocket error code: ${w.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=t.createNoDashGuid()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){const s=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(s!==void 0){const l=s.split(","),p=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),h=p!==void 0?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:h},output:{interimResults:{mode:"Always"}},targetLanguages:l}),p!==void 0){const v={};for(const g of l)v[g]=p;this.privSpeechContext.setSection("synthesis",{defaultVoices:v})}}}setSpeechSegmentationTimeoutJson(){const s=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),l=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),p=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationStrategy,void 0),h={segmentation:{mode:""}};let v=!1;if(p!==void 0){v=!0;let g="";switch(p.toLowerCase()){case"default":break;case"time":g="Custom";break;case"semantic":g="Semantic";break}h.segmentation.mode=g}if(s!==void 0){v=!0;const g=parseInt(s,10);h.segmentation.mode="Custom",h.segmentation.segmentationSilenceTimeoutMs=g}if(l!==void 0){v=!0;const g=parseInt(l,10);h.segmentation.mode="Custom",h.segmentation.segmentationForcedTimeoutMs=g}if(v){const g=this.recognitionMode===u.RecognitionMode.Conversation?"CONVERSATION":this.recognitionMode===u.RecognitionMode.Dictation?"DICTATION":"INTERACTIVE",m=this.privSpeechContext.getSection("phraseDetection");m.mode=g,m[g]=h,this.privSpeechContext.setSection("phraseDetection",m)}}setLanguageIdJson(){const s=this.privSpeechContext.getSection("phraseDetection");if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const p=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");let h;this.privRecognizerConfig.languageIdMode==="Continuous"?h="DetectContinuous":h="DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:p,mode:h,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const v=this.privRecognizerConfig.sourceLanguageModels;v!==void 0&&(s.customModels=v,s.onInterim={action:"None"},s.onSuccess={action:"None"})}this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&(s.onInterim={action:"Translate"},s.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",s)}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(u.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()===r.OutputFormat[r.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(s){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.ConversationTranslator_Token,s)}set voiceProfileType(s){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.SpeechServiceConnection_SpeakerIdMode,s)}set authentication(s){this.privAuthentication=s}isDisposed(){return this.privIsDisposed}async dispose(s){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise!==void 0)try{await(await this.privConnectionConfigurationPromise).dispose(s)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(s,l,p){if(this.recognizeOverride!==void 0){await this.recognizeOverride(s,l,p);return}this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=s,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=l,this.privErrorCallback=p,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const h=this.connectImpl();let v;try{const w=await this.audioSource.attach(this.privRequestSession.audioNodeId),C=await this.audioSource.format,R=await this.audioSource.deviceInfo;this.privIsLiveAudio=R.type&&R.type===u.type.Microphones,v=new i.ReplayableAudioNode(w,C.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(v,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:R}}catch(w){throw await this.privRequestSession.onStopRecognizing(),w}try{await h}catch(w){await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,w);return}const g=new r.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,g),this.receiveMessage(),this.sendAudio(v).catch(async w=>{await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,w)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(s,l){this.connectImpl().then(()=>{try{s&&s()}catch(p){l&&l(p)}},p=>{try{l&&l(p)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(s){}async sendNetworkMessage(s,l){const p=typeof l=="string"?t.MessageType.Text:t.MessageType.Binary,h=typeof l=="string"?"application/json":"";return(await this.fetchConnection()).send(new o.SpeechConnectionMessage(p,s,this.privRequestSession.requestId,h,l))}set activityTemplate(s){this.privActivityTemplate=s}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(s){this.privExpectContentAssessmentResponse=s}async sendTelemetryData(){const s=this.privRequestSession.getTelemetry();if(au.telemetryDataEnabled!==!0||this.privIsDisposed||s===null)return;if(au.telemetryData)try{au.telemetryData(s)}catch{}await(await this.fetchConnection()).send(new o.SpeechConnectionMessage(t.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",s))}async cancelRecognitionLocal(s,l,p){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s,l,p))}async receiveMessage(){try{if(this.privIsDisposed)return;let s=await this.fetchConnection();const l=await s.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!l)return this.receiveMessage();this.privServiceHasSentMessage=!0;const p=o.SpeechConnectionMessage.fromConnectionMessage(l);if(p.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(p.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const h=u.SpeechDetected.fromJSON(p.textBody,this.privRequestSession.currentTurnAudioOffset),v=new r.RecognitionEventArgs(h.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,v);break;case"speech.enddetected":let g;p.textBody.length>0?g=p.textBody:g="{ Offset: 0 }";const m=u.SpeechDetected.fromJSON(g,this.privRequestSession.currentTurnAudioOffset),w=new r.RecognitionEventArgs(m.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,w);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(r.CancellationReason.EndOfStream,r.CancellationErrorCode.NoError,void 0));const C=new r.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,C);return}else s=await this.fetchConnection(),await this.sendPrePayloadJSON(s);break;default:await this.processTypeSpecificMessages(p)||this.privServiceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(p.path.toLowerCase(),p.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const s=this.privRequestSession.recognitionBytesSent,l=this.privAverageBytesPerMs!==0?s/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(l)}sendSpeechContext(s,l){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const p=this.speechContext.toJSON();if(l&&this.privRequestSession.onSpeechContext(),p)return s.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",p))}noOp(){}async sendPrePayloadJSON(s,l=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(s);await this.sendSpeechContext(s,l),await this.sendWaveHeader(s)}async sendWaveHeader(s){const l=await this.audioSource.format;return s.send(new o.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",l.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(s=>s.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(s,l,p){if(l.onSpeechContext(),au.telemetryDataEnabled!==!0){const v={context:{system:JSON.parse(p).context.system}};p=JSON.stringify(v)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const h=JSON.parse(p);h.context.DisableReferenceChannel="True",h.context.MicSpec="1_0_0",p=JSON.stringify(h)}if(p)return s.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speech.config",l.requestId,"application/json",p))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(s=>s.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(s){const l=await this.audioSource.format;this.privAverageBytesPerMs=l.avgBytesPerSec/1e3;let p=Date.now();const h=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),v=l.avgBytesPerSec/1e3*parseInt(h,10),g=this.privRequestSession.recogNumber,m=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===g){const w=await this.fetchConnection(),C=await s.read();if(this.privRequestSession.isSpeechEnded)return;let R,_;if(!C||C.isEnd?(R=null,_=0):(R=C.buffer,this.privRequestSession.onAudioSent(R.byteLength),v>=this.privRequestSession.bytesSent?_=0:_=Math.max(0,p-Date.now())),_!==0&&await this.delay(_),R!==null&&(p=Date.now()+R.byteLength*1e3/(l.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===g)if(w.send(new o.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,R)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),C!=null&&C.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return m()}};return m()}async retryableConnect(){let s=!1;this.privAuthFetchEventId=t.createNoDashGuid();const l=this.privRequestSession.sessionId;this.privConnectionId=l!==void 0?l:t.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let p=0,h="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const g=await(s?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const m=this.privConnectionFactory.create(this.privRecognizerConfig,g,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(m.events),m.events.attach(C=>{this.connectionEvents.onEvent(C)});const w=await m.open();if(w.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(w.statusCode),Promise.resolve(m);w.statusCode===1006&&(s=!0),p=w.statusCode,h=w.reason,this.privRequestSession.onRetryConnection()}return await this.privRequestSession.onConnectionEstablishCompleted(p,h),Promise.reject(`Unable to contact server. StatusCode: ${p}, ${this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${h}`)}delay(s){return new Promise(l=>this.privSetTimeout(l,s))}writeBufferToConsole(s){let l="Buffer Size: ";if(s===null)l+="null";else{const p=new Uint8Array(s);l+=`${s.byteLength}\r
`;for(let h=0;h<s.byteLength;h++)l+=p[h].toString(16).padStart(2,"0")+" ",(h+1)%16===0&&(console.info(l),l="")}console.info(l)}async sendFinalAudio(){await(await this.fetchConnection()).send(new o.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const s=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(s):(await this.sendSpeechServiceConfig(s,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(s,!1),s)}};return lc.ServiceRecognizerBase=c,c.telemetryDataEnabled=!0,lc}var pc={},GC;function DA(){if(GC)return pc;GC=1,Object.defineProperty(pc,"__esModule",{value:!0}),pc.ConversationServiceRecognizer=void 0;const i=U(),t=te();let r=class extends t.ServiceRecognizerBase{constructor(o,c,a,s,l){super(o,c,a,s,l),this.handleSpeechPhraseMessage=async p=>this.handleSpeechPhrase(p),this.handleSpeechHypothesisMessage=p=>this.handleSpeechHypothesis(p)}processTypeSpecificMessages(o){}handleRecognizedCallback(o,c,a){}handleRecognizingCallback(o,c,a){}async processSpeechMessages(o){let c=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(o.textBody),c=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(o.textBody),c=!0;break}return c}cancelRecognition(o,c,a,s,l){}async handleSpeechPhrase(o){const c=t.SimpleSpeechPhrase.fromJSON(o,this.privRequestSession.currentTurnAudioOffset),a=t.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus);let s;const l=new i.PropertyCollection;if(l.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,o),this.privRequestSession.onPhraseRecognized(c.Offset+c.Duration),i.ResultReason.Canceled===a){const p=t.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),h=t.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);await this.cancelRecognitionLocal(p,h,t.EnumTranslation.implTranslateErrorDetails(h))}else if(c.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===i.OutputFormat[i.OutputFormat.Simple])s=new i.SpeechRecognitionResult(this.privRequestSession.requestId,a,c.DisplayText,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),l);else{const p=t.DetailedSpeechPhrase.fromJSON(o,this.privRequestSession.currentTurnAudioOffset);s=new i.SpeechRecognitionResult(this.privRequestSession.requestId,a,p.Text,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,p.SpeakerId,void 0,p.asJson(),l)}this.handleRecognizedCallback(s,s.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(o){const c=t.SpeechHypothesis.fromJSON(o,this.privRequestSession.currentTurnAudioOffset),a=new i.PropertyCollection;a.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,o);const s=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),a);this.privRequestSession.onHypothesis(c.Offset),this.handleRecognizingCallback(s,c.Duration,this.privRequestSession.sessionId)}};return pc.ConversationServiceRecognizer=r,pc}var yh={},QC;function jA(){return QC||(QC=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.RecognizerConfig=i.SpeechResultFormat=i.RecognitionMode=void 0;const t=U(),r=te();var u;(function(c){c[c.Interactive=0]="Interactive",c[c.Conversation=1]="Conversation",c[c.Dictation=2]="Dictation"})(u=i.RecognitionMode||(i.RecognitionMode={})),function(c){c[c.Simple=0]="Simple",c[c.Detailed=1]="Detailed"}(i.SpeechResultFormat||(i.SpeechResultFormat={}));class o{constructor(a,s){this.privSpeechServiceConfig=a||new r.SpeechServiceConfig(new r.Context(null)),this.privParameters=s,this.privMaxRetryCount=parseInt(s.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=s.getProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(a){this.privRecognitionMode=a,this.privRecognitionActivityTimeout=a===u.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=u[a]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==u.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const a=[];let s=!1;if(this.autoDetectSourceLanguages!==void 0)for(const l of this.autoDetectSourceLanguages.split(",")){const p=l+t.PropertyId.SpeechServiceConnection_EndpointId.toString(),h=this.parameters.getProperty(p,void 0);h!==void 0?(a.push({language:l,endpoint:h}),s=!0):a.push({language:l,endpoint:""})}return s?a:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(a){this.privEnableSpeakerId=a}}i.RecognizerConfig=o}(yh)),yh}var Sh={},YC;function NA(){return YC||(YC=1,Object.defineProperty(Sh,"__esModule",{value:!0})),Sh}var hc={},XC;function zA(){if(XC)return hc;XC=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.WebsocketMessageFormatter=void 0;const i=de(),t=`\r
`;let r=class{toConnectionMessage(o){const c=new i.Deferred;try{if(o.messageType===i.MessageType.Text){const a=o.textContent;let s={},l=null;if(a){const p=a.split(`\r
\r
`);p&&p.length>0&&(s=this.parseHeaders(p[0]),p.length>1&&(l=p[1]))}c.resolve(new i.ConnectionMessage(o.messageType,l,s,o.id))}else if(o.messageType===i.MessageType.Binary){const a=o.binaryContent;let s={},l=null;if(!a||a.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const p=new DataView(a),h=p.getInt16(0);if(a.byteLength<h+2)throw new Error("Invalid binary message format. Header content missing.");let v="";for(let g=0;g<h;g++)v+=String.fromCharCode(p.getInt8(g+2));s=this.parseHeaders(v),a.byteLength>h+2&&(l=a.slice(2+h)),c.resolve(new i.ConnectionMessage(o.messageType,l,s,o.id))}}catch(a){c.reject(`Error formatting the message. Error: ${a}`)}return c.promise}fromConnectionMessage(o){const c=new i.Deferred;try{if(o.messageType===i.MessageType.Text){const a=`${this.makeHeaders(o)}${t}${o.textBody?o.textBody:""}`;c.resolve(new i.RawWebsocketMessage(i.MessageType.Text,a,o.id))}else if(o.messageType===i.MessageType.Binary){const a=this.makeHeaders(o),s=o.binaryBody,l=this.stringToArrayBuffer(a),p=new Int8Array(l),h=p.byteLength,v=new Int8Array(2+h+(s?s.byteLength:0));if(v[0]=h>>8&255,v[1]=h&255,v.set(p,2),s){const m=new Int8Array(s);v.set(m,2+h)}const g=v.buffer;c.resolve(new i.RawWebsocketMessage(i.MessageType.Binary,g,o.id))}}catch(a){c.reject(`Error formatting the message. ${a}`)}return c.promise}makeHeaders(o){let c="";if(o.headers)for(const a in o.headers)a&&(c+=`${a}: ${o.headers[a]}${t}`);return c}parseHeaders(o){const c={};if(o){const a=o.match(/[^\r\n]+/g);if(c){for(const s of a)if(s){const l=s.indexOf(":"),p=l>0?s.substr(0,l).trim().toLowerCase():s,h=l>0&&s.length>l+1?s.substr(l+1).trim():"";c[p]=h}}}return c}stringToArrayBuffer(o){const c=new ArrayBuffer(o.length),a=new DataView(c);for(let s=0;s<o.length;s++)a.setUint8(s,o.charCodeAt(s));return c}};return hc.WebsocketMessageFormatter=r,hc}var fc={},ZC;function LA(){if(ZC)return fc;ZC=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.SpeechConnectionFactory=void 0;const i=lt(),t=te(),r=U(),u=vr(),o=te(),c=Pt(),a=kn();let s=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(p,h,v){let g=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const m=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),w=u.ConnectionFactoryBase.getHostSuffix(m),C=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+m+".stt.speech"+w),R={},_=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),E=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(_?(!g||g.search(a.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(R[a.QueryParameterNames.CustomSpeechDeploymentId]=_):E&&(!g||g.search(a.QueryParameterNames.Language)===-1)&&(R[a.QueryParameterNames.Language]=E),(!g||g.search(a.QueryParameterNames.Format)===-1)&&(R[a.QueryParameterNames.Format]=p.parameters.getProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()),p.autoDetectSourceLanguages!==void 0&&(R[a.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(p,R,g),!g)switch(p.recognitionMode){case o.RecognitionMode.Conversation:p.parameters.getProperty(t.ForceDictationPropertyName,"false")==="true"?g=C+this.dictationRelativeUri:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?g=`${C}${this.universalUri}${p.recognitionEndpointVersion}`:g=C+this.conversationRelativeUri;break;case o.RecognitionMode.Dictation:g=C+this.dictationRelativeUri;break;default:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?g=`${C}${this.universalUri}${p.recognitionEndpointVersion}`:g=C+this.interactiveRelativeUri;break}const T={};h.token!==void 0&&h.token!==""&&(T[h.headerName]=h.token),T[c.HeaderNames.ConnectionId]=v;const D=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",N=new i.WebsocketConnection(g,R,T,new o.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(p),D,v),H=N.uri;return p.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,H),N}};return fc.SpeechConnectionFactory=s,fc}var vc={},ew;function qA(){if(ew)return vc;ew=1,Object.defineProperty(vc,"__esModule",{value:!0}),vc.ConversationTranscriberConnectionFactory=void 0;const i=lt(),t=U(),r=te(),u=vr(),o=te(),c=Pt(),a=kn();let s=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(p,h,v){let g=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const m=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),w=u.ConnectionFactoryBase.getHostSuffix(m),C=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+m+".stt.speech"+w),R={},_=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),E=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);_?(!g||g.search(a.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(R[a.QueryParameterNames.CustomSpeechDeploymentId]=_):E&&(!g||g.search(a.QueryParameterNames.Language)===-1)&&(R[a.QueryParameterNames.Language]=E),p.autoDetectSourceLanguages!==void 0&&(R[a.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(p,R,g),g||(g=`${C}${this.universalUri}`);const T={};h.token!==void 0&&h.token!==""&&(T[h.headerName]=h.token),T[c.HeaderNames.ConnectionId]=v;const D=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",N=new i.WebsocketConnection(g,R,T,new o.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(p),D,v),H=N.uri;return p.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,H),N}setV2UrlParams(p,h,v){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,a.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,a.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,a.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,a.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,a.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,a.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,a.QueryParameterNames.StableIntermediateThreshold]]).forEach((w,C)=>{this.setUrlParameter(C,w,p,h,v)});const m=JSON.parse(p.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(m).forEach(w=>{h[w]=m[w]})}};return vc.ConversationTranscriberConnectionFactory=s,vc}var gc={},tw;function BA(){if(tw)return gc;tw=1,Object.defineProperty(gc,"__esModule",{value:!0}),gc.TranscriberConnectionFactory=void 0;const i=lt(),t=U(),r=vr(),u=te(),o=Pt(),c=kn();let a=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(l,p,h){let v=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"centralus"),m=r.ConnectionFactoryBase.getHostSuffix(g),w="wss://transcribe."+g+".cts.speech"+m+this.multiaudioRelativeUri,C=l.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,w),R={};this.setQueryParams(R,l,v),v||(v=C);const _={};p.token!==void 0&&p.token!==""&&(_[p.headerName]=p.token),_[o.HeaderNames.ConnectionId]=h,l.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,v);const E=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(v,R,_,new u.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(l),E,h)}setQueryParams(l,p,h){const v=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),g=p.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);v&&!(c.QueryParameterNames.CustomSpeechDeploymentId in l)&&(l[c.QueryParameterNames.CustomSpeechDeploymentId]=v),g&&!(c.QueryParameterNames.Language in l)&&(l[c.QueryParameterNames.Language]=g);const m=p.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",w=p.parameters.getProperty(u.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple])!==t.OutputFormat[t.OutputFormat.Simple];(m||w)&&(l[c.QueryParameterNames.Format]=t.OutputFormat[t.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(p,l,h)}};return gc.TranscriberConnectionFactory=a,gc}var mc={},rw;function FA(){if(rw)return mc;rw=1,Object.defineProperty(mc,"__esModule",{value:!0}),mc.TranslationConnectionFactory=void 0;const i=lt(),t=lP(),r=U(),u=vr(),o=te(),c=Pt(),a=kn();let s=class extends u.ConnectionFactoryBase{create(p,h,v){const g=this.getEndpointUrl(p),m={};p.autoDetectSourceLanguages!==void 0&&(m[a.QueryParameterNames.EnableLanguageId]="true"),this.setQueryParams(m,p,g);const w={};h.token!==void 0&&h.token!==""&&(w[h.headerName]=h.token),w[c.HeaderNames.ConnectionId]=v,p.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,g);const C=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(g,m,w,new o.WebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(p),C,v)}getEndpointUrl(p,h){const v=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),g=u.ConnectionFactoryBase.getHostSuffix(v);let m=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);return m||(p.autoDetectSourceLanguages!==void 0?m=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+g)+"/speech/universal/v2":m=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+g)+"/speech/translation/cognitiveservices/v1"),h===!0?m:t.StringUtils.formatString(m,{region:v})}setQueryParams(p,h,v){p.from=h.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage),p.to=h.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages),p.scenario=h.recognitionMode===o.RecognitionMode.Interactive?"interactive":h.recognitionMode===o.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(h,p,v),this.setUrlParameter(r.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,a.QueryParameterNames.StableTranslation,h,p,v);const g=h.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);g!==void 0&&(p.voice=g,p.features="texttospeech")}};return mc.TranslationConnectionFactory=s,mc}var yc={},nw;function UA(){if(nw)return yc;nw=1,Object.defineProperty(yc,"__esModule",{value:!0}),yc.EnumTranslation=void 0;const i=U(),t=te();let r=class{static implTranslateRecognitionResult(o,c=!1){let a=i.ResultReason.Canceled;switch(o){case t.RecognitionStatus.Success:a=i.ResultReason.RecognizedSpeech;break;case t.RecognitionStatus.EndOfDictation:a=c?i.ResultReason.RecognizedSpeech:i.ResultReason.NoMatch;break;case t.RecognitionStatus.NoMatch:case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:a=i.ResultReason.NoMatch;break;case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:a=i.ResultReason.Canceled;break}return a}static implTranslateCancelResult(o){let c=i.CancellationReason.EndOfStream;switch(o){case t.RecognitionStatus.Success:case t.RecognitionStatus.EndOfDictation:case t.RecognitionStatus.NoMatch:c=i.CancellationReason.EndOfStream;break;case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:c=i.CancellationReason.Error;break}return c}static implTranslateCancelErrorCode(o){let c=i.CancellationErrorCode.NoError;switch(o){case t.RecognitionStatus.Error:c=i.CancellationErrorCode.ServiceError;break;case t.RecognitionStatus.TooManyRequests:c=i.CancellationErrorCode.TooManyRequests;break;case t.RecognitionStatus.BadRequest:c=i.CancellationErrorCode.BadRequestParameters;break;case t.RecognitionStatus.Forbidden:c=i.CancellationErrorCode.Forbidden;break;default:c=i.CancellationErrorCode.NoError;break}return c}static implTranslateErrorDetails(o){let c="The speech service encountered an internal error and could not continue.";switch(o){case i.CancellationErrorCode.Forbidden:c="The recognizer is using a free subscription that ran out of quota.";break;case i.CancellationErrorCode.BadRequestParameters:c="Invalid parameter or unsupported audio format in the request.";break;case i.CancellationErrorCode.TooManyRequests:c="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return c}};return yc.EnumTranslation=r,yc}var Ch={},iw;function $A(){return iw||(iw=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.RecognitionStatus=i.SynthesisStatus=void 0,function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"}(i.SynthesisStatus||(i.SynthesisStatus={})),function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests",t[t.BadRequest=7]="BadRequest",t[t.Forbidden=8]="Forbidden"}(i.RecognitionStatus||(i.RecognitionStatus={}))}(Ch)),Ch}var Sc={},sw;function WA(){if(sw)return Sc;sw=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.TranslationSynthesisEnd=void 0;const i=te();let t=class CP{constructor(u){this.privSynthesisEnd=JSON.parse(u),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=i.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=i.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(u){return new CP(u)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Sc.TranslationSynthesisEnd=t,Sc}var Cc={},ow;function HA(){if(ow)return Cc;ow=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.TranslationHypothesis=void 0;const i=ge(),t=ef();let r=class Wh{constructor(o,c){this.privTranslationHypothesis=o,this.privTranslationHypothesis.Offset+=c,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(o,c){return new Wh(JSON.parse(o),c)}static fromTranslationResponse(o,c){i.Contracts.throwIfNullOrUndefined(o,"translationHypothesis");const a=o.SpeechHypothesis;return o.SpeechHypothesis=void 0,a.Translation=o,new Wh(a,c)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var o;return(o=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:o.Language}asJson(){const o={...this.privTranslationHypothesis};return o.Translation!==void 0?JSON.stringify({...o,TranslationStatus:t.TranslationStatus[o.Translation.TranslationStatus]}):JSON.stringify(o)}mapTranslationStatus(o){if(typeof o=="string")return t.TranslationStatus[o];if(typeof o=="number")return o}};return Cc.TranslationHypothesis=r,Cc}var wc={},aw;function VA(){if(aw)return wc;aw=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.TranslationPhrase=void 0;const i=ge(),t=te(),r=ef();let u=class Hh{constructor(c,a){this.privTranslationPhrase=c,this.privTranslationPhrase.Offset+=a,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(c,a){return new Hh(JSON.parse(c),a)}static fromTranslationResponse(c,a){i.Contracts.throwIfNullOrUndefined(c,"translationResponse");const s=c.SpeechPhrase;return c.SpeechPhrase=void 0,s.Translation=c,s.Text=s.DisplayText,new Hh(s,a)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var c;return(c=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:c.Language}get Confidence(){var c;return(c=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:c.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const c={...this.privTranslationPhrase},a={...c,RecognitionStatus:t.RecognitionStatus[c.RecognitionStatus]};return c.Translation&&(a.Translation={...c.Translation,TranslationStatus:r.TranslationStatus[c.Translation.TranslationStatus]}),JSON.stringify(a)}mapRecognitionStatus(c){if(typeof c=="string")return t.RecognitionStatus[c];if(typeof c=="number")return c}mapTranslationStatus(c){if(typeof c=="string")return r.TranslationStatus[c];if(typeof c=="number")return c}};return wc.TranslationPhrase=u,wc}var Rc={},cw;function KA(){if(cw)return Rc;cw=1,Object.defineProperty(Rc,"__esModule",{value:!0}),Rc.TranslationServiceRecognizer=void 0;const i=de(),t=U(),r=te();let u=class extends r.ConversationServiceRecognizer{constructor(c,a,s,l,p){super(c,a,s,l,p),this.privTranslationRecognizer=p,this.connectionEvents.attach(h=>{h.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(c){const a=new t.PropertyCollection;let s=await this.processSpeechMessages(c);if(s)return!0;const l=async h=>{if(a.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,h.asJson()),this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),h.RecognitionStatus===r.RecognitionStatus.Success){const v=this.fireEventForResult(h,a);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,v)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(v.result)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const v=r.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),g=new t.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,v,h.Text,h.Duration,h.Offset,h.Language,h.Confidence,void 0,h.asJson(),a);if(v===t.ResultReason.Canceled){const m=r.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),w=r.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(m,w,r.EnumTranslation.implTranslateErrorDetails(w))}else if(h.RecognitionStatus!==r.RecognitionStatus.EndOfDictation){const m=new t.TranslationRecognitionEventArgs(g,g.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,m)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(g)}catch(w){this.privErrorCallback&&this.privErrorCallback(w)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}s=!0}},p=h=>{a.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,h.asJson());const v=this.fireEventForResult(h,a);if(this.privRequestSession.onHypothesis(v.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,v)}catch{}s=!0};switch(c.messageType===i.MessageType.Text&&a.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,c.textBody),c.path.toLowerCase()){case"translation.hypothesis":p(r.TranslationHypothesis.fromJSON(c.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const h=JSON.parse(c.textBody);if(h.SpeechPhrase)await l(r.TranslationPhrase.fromTranslationResponse(h,this.privRequestSession.currentTurnAudioOffset));else{const g=JSON.parse(c.textBody);g.SpeechHypothesis&&p(r.TranslationHypothesis.fromTranslationResponse(g,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await l(r.TranslationPhrase.fromJSON(c.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":this.sendSynthesisAudio(c.binaryBody,this.privRequestSession.sessionId),s=!0;break;case"audio.end":case"translation.synthesis.end":const v=r.TranslationSynthesisEnd.fromJSON(c.textBody);switch(v.SynthesisStatus){case r.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const g=new t.TranslationSynthesisResult(t.ResultReason.Canceled,void 0),m=new t.TranslationSynthesisEventArgs(g,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,m)}catch{}}if(this.privTranslationRecognizer.canceled){const g=new t.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,t.CancellationReason.Error,v.FailureReason,t.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,g)}catch{}}break;case r.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}s=!0;break}return s}cancelRecognition(c,a,s,l,p){const h=new t.PropertyCollection;if(h.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[l]),this.privTranslationRecognizer.canceled){const v=new t.TranslationRecognitionCanceledEventArgs(c,s,p,l,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,v)}catch{}}if(this.privSuccessCallback){const v=new t.TranslationRecognitionResult(void 0,a,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,p,void 0,h);try{this.privSuccessCallback(v),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(c,a,s){try{const l=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(c),a,s);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,l)}catch{}}handleRecognizedCallback(c,a,s){try{const l=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(c),a,s);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}}fireEventForResult(c,a){let s;if(c.Translation.Translations!==void 0){s=new t.Translations;for(const m of c.Translation.Translations)s.set(m.Language,m.Text||m.DisplayText)}let l,p;c instanceof r.TranslationPhrase?(c.Translation&&c.Translation.TranslationStatus===i.TranslationStatus.Success?l=t.ResultReason.TranslatedSpeech:l=t.ResultReason.RecognizedSpeech,p=c.Confidence):l=t.ResultReason.TranslatingSpeech;const h=c.Language,v=new t.TranslationRecognitionResult(s,this.privRequestSession.requestId,l,c.Text,c.Duration,c.Offset,h,p,c.Translation.FailureReason,c.asJson(),a);return new t.TranslationRecognitionEventArgs(v,c.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(c,a){const s=c===void 0?t.ResultReason.SynthesizingAudioCompleted:t.ResultReason.SynthesizingAudio,l=new t.TranslationSynthesisResult(s,c),p=new t.TranslationSynthesisEventArgs(l,a);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,p)}catch{}}};return Rc.TranslationServiceRecognizer=u,Rc}var Pc={},uw;function JA(){if(uw)return Pc;uw=1,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.SpeechDetected=void 0;let i=class wP{constructor(r,u){this.privSpeechStartDetected=JSON.parse(r),this.privSpeechStartDetected.Offset+=u}static fromJSON(r,u){return new wP(r,u)}get Offset(){return this.privSpeechStartDetected.Offset}};return Pc.SpeechDetected=i,Pc}var _c={},lw;function GA(){if(lw)return _c;lw=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.SpeechHypothesis=void 0;let i=class RP{constructor(r,u){this.privSpeechHypothesis=JSON.parse(r),this.updateOffset(u)}static fromJSON(r,u){return new RP(r,u)}updateOffset(r){this.privSpeechHypothesis.Offset+=r}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return _c.SpeechHypothesis=i,_c}var Ec={},dw;function QA(){if(dw)return Ec;dw=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.SpeechKeyword=void 0;let i=class PP{constructor(r,u){this.privSpeechKeyword=JSON.parse(r),this.privSpeechKeyword.Offset+=u}static fromJSON(r,u){return new PP(r,u)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return Ec.SpeechKeyword=i,Ec}var Tc={},pw;function YA(){if(pw)return Tc;pw=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.SpeechServiceRecognizer=void 0;const i=U(),t=te();let r=class extends t.ServiceRecognizerBase{constructor(o,c,a,s,l){super(o,c,a,s,l),this.privSpeechRecognizer=l}async processTypeSpecificMessages(o){let c;const a=new i.PropertyCollection;let s=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const l=t.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),c=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,l.Text,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),a),this.privRequestSession.onHypothesis(l.Offset);const p=new i.SpeechRecognitionEventArgs(c,l.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,p)}catch{}s=!0;break;case"speech.phrase":const h=t.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,h.asJson());const v=t.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),i.ResultReason.Canceled===v){const g=t.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),m=t.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(g,m,t.EnumTranslation.implTranslateErrorDetails(m))}else{if(h.RecognitionStatus===t.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===i.OutputFormat[i.OutputFormat.Simple])c=new i.SpeechRecognitionResult(this.privRequestSession.requestId,v,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),a);else{const m=t.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);a.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,m.asJson()),c=new i.SpeechRecognitionResult(this.privRequestSession.requestId,v,m.RecognitionStatus===t.RecognitionStatus.Success?m.NBest[0].Display:"",m.Duration,m.Offset,m.Language,m.LanguageDetectionConfidence,void 0,void 0,m.asJson(),a)}const g=new i.SpeechRecognitionEventArgs(c,c.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,g)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(c)}catch(m){this.privErrorCallback&&this.privErrorCallback(m)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}s=!0;break}return s}cancelRecognition(o,c,a,s,l){const p=new i.PropertyCollection;if(p.setProperty(t.CancellationErrorCodePropertyName,i.CancellationErrorCode[s]),this.privSpeechRecognizer.canceled){const h=new i.SpeechRecognitionCanceledEventArgs(a,l,s,void 0,o);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new i.SpeechRecognitionResult(c,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,l,void 0,p);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}};return Tc.SpeechServiceRecognizer=r,Tc}var Ic={},hw;function XA(){if(hw)return Ic;hw=1,Object.defineProperty(Ic,"__esModule",{value:!0}),Ic.ConversationTranscriptionServiceRecognizer=void 0;const i=U(),t=te();let r=class extends t.ServiceRecognizerBase{constructor(o,c,a,s,l){super(o,c,a,s,l),this.privConversationTranscriber=l,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const o=this.privSpeechContext.getSection("phraseDetection");o.mode="Conversation";const c={};c.mode="Anonymous",c.audioSessionId=this.privDiarizationSessionId,c.audioOffsetMs=0,c.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",o.speakerDiarization=c,this.privSpeechContext.setSection("phraseDetection",o)}}async processTypeSpecificMessages(o){let c;const a=new i.PropertyCollection;a.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,o.textBody);let s=!1;switch(o.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const l=t.SpeechHypothesis.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);c=new i.ConversationTranscriptionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,l.Text,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,l.SpeakerId,void 0,l.asJson(),a),this.privRequestSession.onHypothesis(l.Offset);const p=new i.ConversationTranscriptionEventArgs(c,l.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,p)}catch{}s=!0;break;case"speech.phrase":const h=t.SimpleSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset),v=t.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),i.ResultReason.Canceled===v){const g=t.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),m=t.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(g,m,t.EnumTranslation.implTranslateErrorDetails(m))}else if(!(this.privRequestSession.isSpeechEnded&&v===i.ResultReason.NoMatch&&h.RecognitionStatus!==t.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===i.OutputFormat[i.OutputFormat.Simple])c=new i.ConversationTranscriptionResult(this.privRequestSession.requestId,v,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,h.asJson(),a);else{const m=t.DetailedSpeechPhrase.fromJSON(o.textBody,this.privRequestSession.currentTurnAudioOffset);c=new i.ConversationTranscriptionResult(this.privRequestSession.requestId,v,m.RecognitionStatus===t.RecognitionStatus.Success?m.NBest[0].Display:void 0,m.Duration,m.Offset,m.Language,m.LanguageDetectionConfidence,h.SpeakerId,void 0,m.asJson(),a)}const g=new i.ConversationTranscriptionEventArgs(c,c.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,g)}catch{}}s=!0;break}return s}cancelRecognition(o,c,a,s,l){if(new i.PropertyCollection().setProperty(t.CancellationErrorCodePropertyName,i.CancellationErrorCode[s]),this.privConversationTranscriber.canceled){const h=new i.ConversationTranscriptionCanceledEventArgs(a,l,s,void 0,o);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,h)}catch{}}}};return Ic.ConversationTranscriptionServiceRecognizer=r,Ic}var Ac={},fw;function ZA(){if(fw)return Ac;fw=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.TranscriptionServiceRecognizer=void 0;const i=de(),t=U(),r=te(),u=gs();let o=class extends r.ConversationServiceRecognizer{constructor(a,s,l,p,h){super(a,s,l,p,h),this.privTranscriberRecognizer=h,this.sendPrePayloadJSONOverride=v=>this.sendTranscriptionStartJSON(v),this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(a,s){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createSpeechEventPayload(a,s))}}async sendMeetingSpeechEventAsync(a,s){if(this.privRequestSession.isRecognizing){const l=await this.fetchConnection();await this.sendSpeechEvent(l,this.createMeetingSpeechEventPayload(a,s))}}processTypeSpecificMessages(a){return this.processSpeechMessages(a)}handleRecognizedCallback(a,s,l){try{const p=new t.SpeechRecognitionEventArgs(a,s,l);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,p),this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(a,s,l){try{const p=new t.SpeechRecognitionEventArgs(a,s,l);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,p)}catch{}}cancelRecognition(a,s,l,p,h){const v=new t.PropertyCollection;if(v.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[p]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const g=new t.MeetingTranscriptionCanceledEventArgs(l,h,p,void 0,a);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,g)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const g=new t.ConversationTranscriptionCanceledEventArgs(l,h,p,void 0,a);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,g)}catch{}}if(this.privSuccessCallback){const g=new t.SpeechRecognitionResult(s,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,h,void 0,v);try{this.privSuccessCallback(g),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(a){if(await this.sendSpeechContext(a,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const s=this.privTranscriberRecognizer.getMeetingInfo(),l=this.createMeetingSpeechEventPayload(s,"start");await this.sendSpeechEvent(a,l)}else{const s=this.privTranscriberRecognizer.getConversationInfo(),l=this.createSpeechEventPayload(s,"start");await this.sendSpeechEvent(a,l)}await this.sendWaveHeader(a)}sendSpeechEvent(a,s){const l=JSON.stringify(s);if(l)return a.send(new u.SpeechConnectionMessage(i.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",l))}createSpeechEventPayload(a,s){const l={id:"meeting",name:s,meeting:a.conversationProperties};return l.meeting.id=a.id,l.meeting.attendees=a.participants,l}createMeetingSpeechEventPayload(a,s){const l={id:"meeting",name:s,meeting:a.meetingProperties};return l.meeting.id=a.id,l.meeting.attendees=a.participants,l}};return Ac.TranscriptionServiceRecognizer=o,Ac}var bc={},vw;function eb(){if(vw)return bc;vw=1,Object.defineProperty(bc,"__esModule",{value:!0}),bc.DetailedSpeechPhrase=void 0;const i=te();let t=class _P{constructor(u,o){this.privDetailedSpeechPhrase=JSON.parse(u),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(o)}static fromJSON(u,o){return new _P(u,o)}updateOffsets(u){if(this.privDetailedSpeechPhrase.Offset+=u,this.privDetailedSpeechPhrase.NBest)for(const o of this.privDetailedSpeechPhrase.NBest){if(o.Words)for(const c of o.Words)c.Offset+=u;if(o.DisplayWords)for(const c of o.DisplayWords)c.Offset+=u}}asJson(){const u={...this.privDetailedSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:i.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return i.RecognitionStatus[u];if(typeof u=="number")return u}};return bc.DetailedSpeechPhrase=t,bc}var kc={},gw;function tb(){if(gw)return kc;gw=1,Object.defineProperty(kc,"__esModule",{value:!0}),kc.SimpleSpeechPhrase=void 0;const i=te();let t=class EP{constructor(u,o=0){this.privSimpleSpeechPhrase=JSON.parse(u),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(o)}static fromJSON(u,o){return new EP(u,o)}updateOffset(u){this.privSimpleSpeechPhrase.Offset+=u}asJson(){const u={...this.privSimpleSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:i.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return i.RecognitionStatus[u];if(typeof u=="number")return u}};return kc.SimpleSpeechPhrase=t,kc}var Oc={},mw;function rb(){if(mw)return Oc;mw=1,Object.defineProperty(Oc,"__esModule",{value:!0}),Oc.AddedLmIntent=void 0;let i=class{constructor(r,u){this.modelImpl=r,this.intentName=u}};return Oc.AddedLmIntent=i,Oc}var Mc={},yw;function nb(){if(yw)return Mc;yw=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.IntentServiceRecognizer=void 0;const i=de(),t=U(),r=te();let u=class extends r.ServiceRecognizerBase{constructor(c,a,s,l,p){super(c,a,s,l,p),this.privIntentRecognizer=p,this.privIntentDataSent=!1}setIntents(c,a){this.privAddedLmIntents=c,this.privUmbrellaIntent=a,this.privIntentDataSent=!0}processTypeSpecificMessages(c){let a,s,l=!1;const p=new t.PropertyCollection;switch(c.messageType===i.MessageType.Text&&p.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,c.textBody),c.path.toLowerCase()){case"speech.hypothesis":const v=r.SpeechHypothesis.fromJSON(c.textBody,this.privRequestSession.currentTurnAudioOffset);if(a=new t.IntentRecognitionResult(void 0,this.privRequestSession.requestId,t.ResultReason.RecognizingIntent,v.Text,v.Duration,v.Offset,v.Language,v.LanguageDetectionConfidence,void 0,v.asJson(),p),this.privRequestSession.onHypothesis(a.offset),s=new t.IntentRecognitionEventArgs(a,v.Offset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,s)}catch{}l=!0;break;case"speech.phrase":const g=r.SimpleSpeechPhrase.fromJSON(c.textBody,this.privRequestSession.currentTurnAudioOffset);a=new t.IntentRecognitionResult(void 0,this.privRequestSession.requestId,r.EnumTranslation.implTranslateRecognitionResult(g.RecognitionStatus),g.DisplayText,g.Duration,g.Offset,g.Language,g.LanguageDetectionConfidence,void 0,g.asJson(),p),s=new t.IntentRecognitionEventArgs(a,a.offset,this.privRequestSession.sessionId);const m=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,s)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(C){this.privErrorCallback&&this.privErrorCallback(C)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||t.ResultReason.NoMatch===s.result.reason?(this.privRequestSession.onPhraseRecognized(s.offset+s.result.duration),m()):this.privPendingIntentArgs=s,l=!0;break;case"response":if(s=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,s===void 0){if(c.textBody==="")return;s=new t.IntentRecognitionEventArgs(new t.IntentRecognitionResult,0,this.privRequestSession.sessionId)}const w=r.IntentResponse.fromJSON(c.textBody);if(w!==null&&w.topScoringIntent&&w.topScoringIntent.intent){let C=this.privAddedLmIntents[w.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(C=this.privUmbrellaIntent),C){const R=C===void 0||C.intentName===void 0?w.topScoringIntent.intent:C.intentName;let _=s.result.reason;R!==void 0&&(_=t.ResultReason.RecognizedIntent);const E=s.result.properties!==void 0?s.result.properties:new t.PropertyCollection;E.setProperty(t.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,c.textBody),s=new t.IntentRecognitionEventArgs(new t.IntentRecognitionResult(R,s.result.resultId,_,s.result.text,s.result.duration,s.result.offset,void 0,void 0,s.result.errorDetails,s.result.json,E),s.offset,s.sessionId)}}if(this.privRequestSession.onPhraseRecognized(s.offset+s.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,s)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s.result)}catch(C){this.privErrorCallback&&this.privErrorCallback(C)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}l=!0;break}const h=new i.Deferred;return h.resolve(l),h.promise}cancelRecognition(c,a,s,l,p){const h=new t.PropertyCollection;if(h.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[l]),this.privIntentRecognizer.canceled){const v=new t.IntentRecognitionCanceledEventArgs(s,p,l,void 0,void 0,c);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,v)}catch{}}if(this.privSuccessCallback){const v=new t.IntentRecognitionResult(void 0,a,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,p,void 0,h);try{this.privSuccessCallback(v),this.privSuccessCallback=void 0}catch{}}}};return Mc.IntentServiceRecognizer=u,Mc}var xc={},Sw;function ib(){if(Sw)return xc;Sw=1,Object.defineProperty(xc,"__esModule",{value:!0}),xc.IntentResponse=void 0;let i=class TP{constructor(r){r===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(r)}static fromJSON(r){return new TP(r)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};return xc.IntentResponse=i,xc}var wh={},Cw;function sb(){return Cw||(Cw=1,Object.defineProperty(wh,"__esModule",{value:!0})),wh}var Dc={},jc={},ww;function ob(){if(ww)return jc;ww=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.ServiceTelemetryListener=void 0;const i=de(),t=af();class r{constructor(o,c,a){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=o,this.privAudioSourceId=c,this.privAudioNodeId=a,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(o){o>0&&this.privPhraseLatencies.push(Date.now()-o)}hypothesisReceived(o){o>0&&this.privHypothesisLatencies.push(Date.now()-o)}onEvent(o){this.privIsDisposed||(o instanceof t.RecognitionTriggeredEvent&&o.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:o.eventTime,Name:"ListeningTrigger",Start:o.eventTime}),o instanceof i.AudioStreamNodeAttachingEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=o.eventTime),o instanceof i.AudioStreamNodeAttachedEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=o.eventTime),o instanceof i.AudioSourceErrorEvent&&o.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:o.eventTime,Error:o.error,Name:"Microphone",Start:this.privMicStartTime})),o instanceof i.AudioStreamNodeErrorEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:o.eventTime,Error:o.error,Name:"Microphone",Start:this.privMicStartTime})),o instanceof i.AudioStreamNodeDetachedEvent&&o.audioSourceId===this.privAudioSourceId&&o.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:o.eventTime,Name:"Microphone",Start:this.privMicStartTime})),o instanceof t.ConnectingToServiceEvent&&o.requestId===this.privRequestId&&(this.privConnectionId=o.sessionId),o instanceof i.ConnectionStartEvent&&o.connectionId===this.privConnectionId&&(this.privConnectionStartTime=o.eventTime),o instanceof i.ConnectionEstablishedEvent&&o.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:o.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),o instanceof i.ConnectionEstablishErrorEvent&&o.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:o.eventTime,Error:this.getConnectionError(o.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),o instanceof i.ConnectionMessageReceivedEvent&&o.connectionId===this.privConnectionId&&o.message&&o.message.headers&&o.message.headers.path&&(this.privReceivedMessages[o.message.headers.path]||(this.privReceivedMessages[o.message.headers.path]=new Array),this.privReceivedMessages[o.message.headers.path].length<50&&this.privReceivedMessages[o.message.headers.path].push(o.networkReceivedTime)))}getTelemetry(){const o=new Array;this.privListeningTriggerMetric&&o.push(this.privListeningTriggerMetric),this.privMicMetric&&o.push(this.privMicMetric),this.privConnectionEstablishMetric&&o.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&o.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&o.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const c={Metrics:o,ReceivedMessages:this.privReceivedMessages},a=JSON.stringify(c);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],a}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(o){switch(o){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+o.toString()}}}return jc.ServiceTelemetryListener=r,jc}var Rw;function ab(){if(Rw)return Dc;Rw=1,Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.RequestSession=void 0;const i=de(),t=af(),r=ob();let u=class{constructor(c){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=c,this.privRequestId=i.createNoDashGuid(),this.privAudioNodeId=i.createNoDashGuid(),this.privTurnDeferral=new i.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(c){this.privServiceTelemetryListener&&this.privDetachables.push(c.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new r.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new t.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(c,a){this.privAudioNode=c,this.privIsAudioNodeDetached=!1,a?await this.onComplete():this.onEvent(new t.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(c,a){this.privAuthFetchEventId=c,this.privSessionId=a,this.onEvent(new t.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(c){c&&await this.onComplete()}async onConnectionEstablishCompleted(c,a){if(c===200){this.onEvent(new t.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else c===403&&await this.onComplete()}async onServiceTurnEndResponse(c){this.privTurnDeferral.resolve(),!c||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=i.createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new i.Deferred}onHypothesis(c){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(c)))}onPhraseRecognized(c){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(c)),this.onServiceRecognized(c)}onServiceRecognized(c){this.privLastRecoOffset=c,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(c),this.privConnectionAttempts=0}onAudioSent(c){this.privBytesSent+=c,this.privRecognitionBytesSent+=c}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const c of this.privDetachables)await c.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(c){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(c),i.Events.instance.onEvent(c)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return Dc.RequestSession=u,Dc}var Nc={},Pw;function cb(){if(Pw)return Nc;Pw=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.SpeechContext=void 0;let i=class{constructor(r){this.privContext={},this.privDynamicGrammar=r}getSection(r){return this.privContext[r]||{}}setSection(r,u){this.privContext[r]=u}setPronunciationAssessmentParams(r,u,o=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(r),o&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("SNR")===-1&&this.privContext.phraseOutput.detailed.options.push("SNR"),u&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:u},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(r){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=r}toJSON(){const r=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",r),JSON.stringify(this.privContext)}};return Nc.SpeechContext=i,Nc}var zc={},_w;function ub(){if(_w)return zc;_w=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.DynamicGrammarBuilder=void 0;let i=class{addPhrase(r){this.privPhrases||(this.privPhrases=[]),r instanceof Array?this.privPhrases=this.privPhrases.concat(r):this.privPhrases.push(r)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(r){this.privGrammars||(this.privGrammars=[]),r instanceof Array?this.privGrammars=this.privGrammars.concat(r):this.privGrammars.push(r)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const r={};if(r.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const u=[];this.privPhrases.forEach(o=>{u.push({Text:o})}),r.Groups=[{Type:"Generic",Items:u}]}return r}};return zc.DynamicGrammarBuilder=i,zc}var Rh={},Ew;function lb(){return Ew||(Ew=1,Object.defineProperty(Rh,"__esModule",{value:!0})),Rh}var Lc={},qc={},Bc={},Ph={},Tw;function IP(){return Tw||(Tw=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.MessageDataStreamType=i.ActivityPayloadResponse=void 0;class t{constructor(u){this.privActivityResponse=JSON.parse(u)}static fromJSON(u){return new t(u)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}i.ActivityPayloadResponse=t,function(r){r[r.None=0]="None",r[r.TextToSpeechAudio=1]="TextToSpeechAudio"}(i.MessageDataStreamType||(i.MessageDataStreamType={}))}(Ph)),Ph}var Iw;function db(){if(Iw)return Bc;Iw=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.DialogServiceTurnState=void 0;const i=fu(),t=vs(),r=IP();let u=class{constructor(c,a){this.privRequestId=a,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=c,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(c,a){return c.messageDataStreamType===r.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=t.AudioOutputStream.createPullStream(),this.privAudioStream.format=a!==void 0?a:i.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return Bc.DialogServiceTurnState=u,Bc}var Aw;function pb(){if(Aw)return qc;Aw=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.DialogServiceTurnStateManager=void 0;const i=Ir(),t=db();let r=class{constructor(){this.privTurnMap=new Map}StartTurn(o){if(this.privTurnMap.has(o))throw new i.InvalidOperationError("Service error: There is already a turn with id:"+o);const c=new t.DialogServiceTurnState(this,o);return this.privTurnMap.set(o,c),this.privTurnMap.get(o)}GetTurn(o){return this.privTurnMap.get(o)}CompleteTurn(o){if(!this.privTurnMap.has(o))throw new i.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+o);const c=this.privTurnMap.get(o);return c.complete(),this.privTurnMap.delete(o),c}};return qc.DialogServiceTurnStateManager=r,qc}var bw;function hb(){if(bw)return Lc;bw=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.DialogServiceAdapter=void 0;const i=lt(),t=DR(),r=de(),u=fu(),o=U(),c=pb(),a=te(),s=IP(),l=gs();let p=class extends a.ServiceRecognizerBase{constructor(v,g,m,w,C){super(v,g,m,w,C),this.privEvents=new r.EventSource,this.privDialogServiceConnector=C,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new c.DialogServiceTurnStateManager,this.recognizeOverride=(R,_,E)=>this.listenOnce(R,_,E),this.postConnectImplOverride=R=>this.dialogConnectImpl(R),this.configConnectionOverride=R=>this.configConnection(R),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=m,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(R=>{R.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(v){const g=r.createGuid(),m=r.createNoDashGuid(),w={context:{interactionId:g},messagePayload:JSON.parse(v),version:.5},C=JSON.stringify(w);await(await this.fetchConnection()).send(new l.SpeechConnectionMessage(r.MessageType.Text,"agent",m,"application/json",C))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(v){const g=new o.PropertyCollection;v.messageType===r.MessageType.Text&&g.setProperty(o.PropertyId.SpeechServiceResponse_JsonResult,v.textBody);let m,w;switch(v.path.toLowerCase()){case"speech.phrase":const R=a.SimpleSpeechPhrase.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(R.Offset+R.Duration),R.RecognitionStatus!==a.RecognitionStatus.TooManyRequests&&R.RecognitionStatus!==a.RecognitionStatus.Error){const N=this.fireEventForResult(R,g);if(this.privLastResult=N.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,N)}catch{}}w=!0;break;case"speech.hypothesis":const _=a.SpeechHypothesis.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);m=new o.SpeechRecognitionResult(this.privRequestSession.requestId,o.ResultReason.RecognizingSpeech,_.Text,_.Duration,_.Offset,_.Language,_.LanguageDetectionConfidence,void 0,void 0,_.asJson(),g),this.privRequestSession.onHypothesis(_.Offset);const E=new o.SpeechRecognitionEventArgs(m,_.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,E)}catch{}w=!0;break;case"speech.keyword":const T=a.SpeechKeyword.fromJSON(v.textBody,this.privRequestSession.currentTurnAudioOffset);m=new o.SpeechRecognitionResult(this.privRequestSession.requestId,T.Status==="Accepted"?o.ResultReason.RecognizedKeyword:o.ResultReason.NoMatch,T.Text,T.Duration,T.Offset,void 0,void 0,void 0,void 0,T.asJson(),g),T.Status!=="Accepted"&&(this.privLastResult=m);const D=new o.SpeechRecognitionEventArgs(m,m.duration,m.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,D)}catch{}w=!0;break;case"audio":{const N=v.requestId.toUpperCase(),H=this.privTurnStateManager.GetTurn(N);try{v.binaryBody?H.audioStream.write(v.binaryBody):H.endAudioStream()}catch{}}w=!0;break;case"response":this.handleResponseMessage(v),w=!0;break}const C=new r.Deferred;return C.resolve(w),C.promise}async cancelRecognition(v,g,m,w,C){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const R=new o.PropertyCollection;R.setProperty(a.CancellationErrorCodePropertyName,o.CancellationErrorCode[w]);const _=new o.SpeechRecognitionCanceledEventArgs(m,C,w,void 0,v);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,_)}catch{}if(this.privSuccessCallback){const E=new o.SpeechRecognitionResult(void 0,o.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,C,void 0,R);try{this.privSuccessCallback(E),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(v,g,m){this.privRecognizerConfig.recognitionMode=v,this.privSuccessCallback=g,this.privErrorCallback=m,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(o.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const w=this.connectImpl(),C=this.sendPreAudioMessages(),R=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),_=await this.privDialogAudioSource.format,E=await this.privDialogAudioSource.deviceInfo,T=new i.ReplayableAudioNode(R,_.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(T,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:E};try{await w,await C}catch(H){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.ConnectionFailure,H),Promise.resolve()}const D=new o.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,D),this.sendAudio(T).then(()=>{},async H=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,H)})}dialogConnectImpl(v){return this.privConnectionLoop=this.startMessageLoop(),v}receiveDialogMessageOverride(){const v=new r.Deferred,g=async()=>{try{const m=this.isDisposed(),w=!this.isDisposed()&&this.terminateMessageLoop;if(m||w){v.resolve(void 0);return}const R=await(await this.fetchConnection()).read();if(!R)return g();const _=l.SpeechConnectionMessage.fromConnectionMessage(R);switch(_.path.toLowerCase()){case"turn.start":{const Y=_.requestId.toUpperCase(),Ie=this.privRequestSession.requestId.toUpperCase();Y!==Ie?this.privTurnStateManager.StartTurn(Y):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const T=a.SpeechDetected.fromJSON(_.textBody,this.privRequestSession.currentTurnAudioOffset),D=new o.RecognitionEventArgs(T.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,D);break;case"speech.enddetected":let N;_.textBody.length>0?N=_.textBody:N="{ Offset: 0 }";const H=a.SpeechDetected.fromJSON(N,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(H.Offset);const ie=new o.RecognitionEventArgs(H.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,ie);break;case"turn.end":{const Y=_.requestId.toUpperCase(),Ie=this.privRequestSession.requestId.toUpperCase();if(Y!==Ie)this.privTurnStateManager.CompleteTurn(Y);else{const De=new o.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,De),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(Xe){this.privErrorCallback&&this.privErrorCallback(Xe)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(_)||this.serviceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(_.path.toLowerCase(),_.textBody))}catch{}}return g()}catch{this.terminateMessageLoop=!0,v.resolve()}};return g().catch(m=>{r.Events.instance.onEvent(new r.BackgroundEvent(m))}),v.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(v){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,v)}return Promise.resolve()}async configConnection(v){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(v),v)}async sendPreAudioMessages(){const v=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(v,!0),await this.sendAgentContext(v),await this.sendWaveHeader(v)}sendAgentConfig(v){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(o.PropertyId.Conversation_DialogType)===o.DialogServiceConfig.DialogTypes.CustomCommands){const m=this.agentConfig.get();m.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(m)}this.onEvent(new t.SendingAgentContextMessageEvent(this.agentConfig));const g=this.agentConfig.toJsonString();return this.agentConfigSent=!0,v.send(new l.SpeechConnectionMessage(r.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",g))}}sendAgentContext(v){const g=r.createGuid(),m=this.privDialogServiceConnector.properties.getProperty(o.PropertyId.Conversation_Speech_Activity_Template),C=JSON.stringify({channelData:"",context:{interactionId:g},messagePayload:typeof m===void 0?void 0:m,version:.5});return v.send(new l.SpeechConnectionMessage(r.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",C))}fireEventForResult(v,g){const m=a.EnumTranslation.implTranslateRecognitionResult(v.RecognitionStatus),w=new o.SpeechRecognitionResult(this.privRequestSession.requestId,m,v.DisplayText,v.Duration,v.Offset,v.Language,v.LanguageDetectionConfidence,void 0,void 0,v.asJson(),g);return new o.SpeechRecognitionEventArgs(w,v.Offset,this.privRequestSession.sessionId)}handleResponseMessage(v){const g=JSON.parse(v.textBody);switch(g.messageType.toLowerCase()){case"message":const m=v.requestId.toUpperCase(),w=s.ActivityPayloadResponse.fromJSON(v.textBody),C=this.privTurnStateManager.GetTurn(m);if(w.conversationId){const E=this.agentConfig.get();E.botInfo.conversationId=w.conversationId,this.agentConfig.set(E)}const R=C.processActivityPayload(w,u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),_=new o.ActivityReceivedEventArgs(w.messagePayload,R);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,_)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new o.TurnStatusReceivedEventArgs(v.textBody))}catch{}break;default:r.Events.instance.onEvent(new r.BackgroundEvent(`Unexpected response of type ${g.messageType}. Ignoring.`));break}}onEvent(v){this.privEvents.onEvent(v),r.Events.instance.onEvent(v)}addKeywordContextData(){const v=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(v===void 0)return;const g=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),m=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),w=v.split(";"),C=g===void 0?[]:g.split(";"),R=m===void 0?[]:m.split(";"),_=[];for(let E=0;E<w.length;E++){const T={};T.text=w[E],E<C.length&&(T.offset=Number(C[E])),E<R.length&&(T.duration=Number(R[E])),_.push(T)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:_,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}};return Lc.DialogServiceAdapter=p,Lc}var Fc={},kw;function fb(){if(kw)return Fc;kw=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.AgentConfig=void 0;let i=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(r){this.iPrivConfig=r}};return Fc.AgentConfig=i,Fc}var _h={},Uc={},$c={},Ow;function cf(){if(Ow)return $c;Ow=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.ConversationConnectionConfig=void 0;const i=SP();let t=class Tn extends i.RestConfigBase{static get host(){return Tn.privHost}static get apiVersion(){return Tn.privApiVersion}static get clientAppId(){return Tn.privClientAppId}static get defaultLanguageCode(){return Tn.privDefaultLanguageCode}static get restPath(){return Tn.privRestPath}static get webSocketPath(){return Tn.privWebSocketPath}static get transcriptionEventKeys(){return Tn.privTranscriptionEventKeys}};return $c.ConversationConnectionConfig=t,t.privHost="dev.microsofttranslator.com",t.privRestPath="/capito/room",t.privApiVersion="2.0",t.privDefaultLanguageCode="en-US",t.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",t.privWebSocketPath="/capito/translate",t.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],$c}var Mw;function vb(){if(Mw)return Uc;Mw=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.ConversationManager=void 0;const i=lt(),t=ge(),r=U(),u=cf();let o=class{constructor(){this.privRequestParams=u.ConversationConnectionConfig.configParams,this.privErrors=u.ConversationConnectionConfig.restErrors,this.privHost=u.ConversationConnectionConfig.host,this.privApiVersion=u.ConversationConnectionConfig.apiVersion,this.privRestPath=u.ConversationConnectionConfig.restPath,this.privRestAdapter=new i.RestMessageAdapter({})}createOrJoin(a,s,l,p){try{t.Contracts.throwIfNullOrUndefined(a,"args");const h=a.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,u.ConversationConnectionConfig.defaultLanguageCode),v=a.getProperty(r.PropertyId.ConversationTranslator_Name,"conversation_host"),g=a.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),m=a.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),w=a.getProperty(r.PropertyId.SpeechServiceConnection_Key),C=a.getProperty(r.PropertyId.SpeechServiceConnection_Region),R=a.getProperty(r.PropertyId.SpeechServiceAuthorization_Token);t.Contracts.throwIfNullOrWhitespace(h,"languageCode"),t.Contracts.throwIfNullOrWhitespace(v,"nickname"),t.Contracts.throwIfNullOrWhitespace(g,"endpointHost");const _={};_[this.privRequestParams.apiVersion]=this.privApiVersion,_[this.privRequestParams.languageCode]=h,_[this.privRequestParams.nickname]=v;const E={};m&&(E[this.privRequestParams.correlationId]=m),E[this.privRequestParams.clientAppId]=u.ConversationConnectionConfig.clientAppId,s!==void 0?_[this.privRequestParams.roomId]=s:(t.Contracts.throwIfNullOrUndefined(C,this.privErrors.authInvalidSubscriptionRegion),E[this.privRequestParams.subscriptionRegion]=C,w?E[this.privRequestParams.subscriptionKey]=w:R?E[this.privRequestParams.authorization]=`Bearer ${R}`:t.Contracts.throwIfNullOrUndefined(w,this.privErrors.authInvalidSubscriptionKey));const T={};T.headers=E,this.privRestAdapter.options=T;const D=`https://${g}${this.privRestPath}`;this.privRestAdapter.request(i.RestRequestType.Post,D,_,null).then(N=>{const H=i.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,N.headers);if(!N.ok){if(p){let Y=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",N.status.toString()),Ie;try{Ie=JSON.parse(N.data),Y+=` [${Ie.error.code}: ${Ie.error.message}]`}catch{Y+=` [${N.data}]`}H&&(Y+=` ${H}`),p(Y)}return}const ie=JSON.parse(N.data);if(ie&&(ie.requestId=H),l){try{l(ie)}catch(Y){p&&p(Y)}l=void 0}}).catch(()=>{})}catch(h){if(p)if(h instanceof Error){const v=h;p(v.name+": "+v.message)}else p(h)}}leave(a,s){return new Promise((l,p)=>{try{t.Contracts.throwIfNullOrUndefined(a,this.privErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","token"));const h=a.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),v=a.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),g={};g[this.privRequestParams.apiVersion]=this.privApiVersion,g[this.privRequestParams.sessionToken]=s;const m={};v&&(m[this.privRequestParams.correlationId]=v);const w={};w.headers=m,this.privRestAdapter.options=w;const C=`https://${h}${this.privRestPath}`;this.privRestAdapter.request(i.RestRequestType.Delete,C,g,null).then(R=>{R.ok,l()}).catch(()=>{})}catch(h){if(h instanceof Error){const v=h;p(v.name+": "+v.message)}else p(h)}})}};return Uc.ConversationManager=o,Uc}var gi={},Wc={},Hc={},Vc={},xw;function AP(){if(xw)return Vc;xw=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.ConversationConnectionMessage=void 0;const i=de();let t=class extends i.ConnectionMessage{constructor(u,o,c,a){super(u,o,c,a);const s=JSON.parse(this.textBody);s.type!==void 0&&(this.privConversationMessageType=s.type)}get conversationMessageType(){return this.privConversationMessageType}};return Vc.ConversationConnectionMessage=t,Vc}var Dw;function gb(){if(Dw)return Hc;Dw=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.ConversationWebsocketMessageFormatter=void 0;const i=de(),t=AP();let r=class{toConnectionMessage(o){const c=new i.Deferred;try{if(o.messageType===i.MessageType.Text){const a=new t.ConversationConnectionMessage(o.messageType,o.textContent,{},o.id);c.resolve(a)}else o.messageType===i.MessageType.Binary&&c.resolve(new t.ConversationConnectionMessage(o.messageType,o.binaryContent,void 0,o.id))}catch(a){c.reject(`Error formatting the message. Error: ${a}`)}return c.promise}fromConnectionMessage(o){const c=new i.Deferred;try{if(o.messageType===i.MessageType.Text){const a=`${o.textBody?o.textBody:""}`;c.resolve(new i.RawWebsocketMessage(i.MessageType.Text,a,o.id))}}catch(a){c.reject(`Error formatting the message. ${a}`)}return c.promise}};return Hc.ConversationWebsocketMessageFormatter=r,Hc}var jw;function mb(){if(jw)return Wc;jw=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.ConversationConnectionFactory=void 0;const i=lt(),t=de(),r=ge(),u=U(),o=vr(),c=cf(),a=gb();let s=class extends o.ConnectionFactoryBase{create(p,h,v){const g=p.parameters.getProperty(u.PropertyId.ConversationTranslator_Host,c.ConversationConnectionConfig.host),m=p.parameters.getProperty(u.PropertyId.ConversationTranslator_CorrelationId,t.createGuid()),w=`wss://${g}${c.ConversationConnectionConfig.webSocketPath}`,C=p.parameters.getProperty(u.PropertyId.ConversationTranslator_Token,void 0);r.Contracts.throwIfNullOrUndefined(C,"token");const R={};R[c.ConversationConnectionConfig.configParams.apiVersion]=c.ConversationConnectionConfig.apiVersion,R[c.ConversationConnectionConfig.configParams.token]=C,R[c.ConversationConnectionConfig.configParams.correlationId]=m;const _=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new i.WebsocketConnection(w,R,{},new a.ConversationWebsocketMessageFormatter,i.ProxyInfo.fromRecognizerConfig(p),_,v)}};return Wc.ConversationConnectionFactory=s,Wc}var Kc={},Jc={},Nw;function yb(){if(Nw)return Jc;Nw=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.ConversationRequestSession=void 0;const i=de();let t=class{constructor(u){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=u,this.privRequestId=i.createNoDashGuid(),this.privRequestCompletionDeferral=new i.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(u,o){this.privSessionId=o}onAuthCompleted(u){u&&this.onComplete()}onConnectionEstablishCompleted(u){u!==200&&u===403&&this.onComplete()}onServiceTurnEndResponse(u){u?this.privRequestId=i.createNoDashGuid():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const u of this.privDetachables)await u.detach()}}onComplete(){}};return Jc.ConversationRequestSession=t,Jc}var Rt={},zw;function bP(){if(zw)return Rt;zw=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.ConversationReceivedTranslationEventArgs=Rt.ParticipantsListEventArgs=Rt.ParticipantAttributeEventArgs=Rt.ParticipantEventArgs=Rt.LockRoomEventArgs=Rt.MuteAllEventArgs=void 0;const i=U();class t extends i.SessionEventArgs{constructor(l,p){super(p),this.privIsMuted=l}get isMuted(){return this.privIsMuted}}Rt.MuteAllEventArgs=t;class r extends i.SessionEventArgs{constructor(l,p){super(p),this.privIsLocked=l}get isMuted(){return this.privIsLocked}}Rt.LockRoomEventArgs=r;class u extends i.SessionEventArgs{constructor(l,p){super(p),this.privParticipant=l}get participant(){return this.privParticipant}}Rt.ParticipantEventArgs=u;class o extends i.SessionEventArgs{constructor(l,p,h,v){super(v),this.privKey=p,this.privValue=h,this.privParticipantId=l}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}Rt.ParticipantAttributeEventArgs=o;class c extends i.SessionEventArgs{constructor(l,p,h,v,g,m,w,C,R){super(R),this.privRoomId=l,this.privSessionToken=p,this.privTranslateTo=h,this.privProfanityFilter=v,this.privRoomProfanityFilter=g,this.privIsRoomLocked=m,this.privIsRoomLocked=w,this.privParticipants=C}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}Rt.ParticipantsListEventArgs=c;class a{constructor(l,p,h){this.privPayload=p,this.privCommand=l,this.privSessionId=h}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return Rt.ConversationReceivedTranslationEventArgs=a,Rt}var Kr={},Lw;function kP(){if(Lw)return Kr;Lw=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.ConversationTranslatorCommandTypes=Kr.ConversationTranslatorMessageTypes=Kr.InternalParticipants=void 0;class i{constructor(r=[],u){this.participants=r,this.meId=u}addOrUpdateParticipant(r){if(r===void 0)return;const u=this.getParticipantIndex(r.id);return u>-1?this.participants.splice(u,1,r):this.participants.push(r),this.getParticipant(r.id)}getParticipantIndex(r){return this.participants.findIndex(u=>u.id===r)}getParticipant(r){return this.participants.find(u=>u.id===r)}deleteParticipant(r){this.participants=this.participants.filter(u=>u.id!==r)}get host(){return this.participants.find(r=>r.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return Kr.InternalParticipants=i,Kr.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},Kr.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},Kr}var Eh={},Gc={},qw;function Sb(){if(qw)return Gc;qw=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.CommandResponsePayload=void 0;const i=r=>JSON.parse(r);let t=class OP{constructor(u){this.privCommandResponse=i(u)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(u){return new OP(u)}};return Gc.CommandResponsePayload=t,Gc}var mi={},Bw;function Cb(){if(Bw)return mi;Bw=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.ParticipantPayloadResponse=mi.ParticipantsListPayloadResponse=void 0;const i=o=>JSON.parse(o),t=o=>JSON.parse(o);class r{constructor(c){this.privParticipantsPayloadResponse=i(c)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(c){return new r(c)}}mi.ParticipantsListPayloadResponse=r;class u{constructor(c){this.privParticipantPayloadResponse=t(c)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(c){return new u(c)}}return mi.ParticipantPayloadResponse=u,mi}var yi={},Fw;function wb(){if(Fw)return yi;Fw=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.TextResponsePayload=yi.SpeechResponsePayload=void 0;const i=o=>JSON.parse(o),t=o=>JSON.parse(o);class r{constructor(c){this.privSpeechResponse=i(c)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(c){return new r(c)}}yi.SpeechResponsePayload=r;class u{constructor(c){this.privTextResponse=t(c)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(c){return new u(c)}}return yi.TextResponsePayload=u,yi}var Uw;function Rb(){return Uw||(Uw=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=Sb();Object.defineProperty(i,"CommandResponsePayload",{enumerable:!0,get:function(){return t.CommandResponsePayload}});var r=Cb();Object.defineProperty(i,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantsListPayloadResponse}}),Object.defineProperty(i,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantPayloadResponse}});var u=wb();Object.defineProperty(i,"SpeechResponsePayload",{enumerable:!0,get:function(){return u.SpeechResponsePayload}}),Object.defineProperty(i,"TextResponsePayload",{enumerable:!0,get:function(){return u.TextResponsePayload}})}(Eh)),Eh}var $w;function Pb(){if($w)return Kc;$w=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.ConversationServiceAdapter=void 0;const i=de(),t=U(),r=te(),u=AP(),o=yb(),c=bP(),a=kP(),s=Rb();let l=class extends r.ServiceRecognizerBase{constructor(h,v,g,m,w){super(h,v,g,m,w),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=w,this.privConversationAuthentication=h,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=C=>this.conversationConnectImpl(C),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new o.ConversationRequestSession(i.createNoDashGuid()),this.privConversationConnectionFactory=v,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(h){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(h),await super.dispose(h)}async sendMessage(h){return(await this.fetchConnection()).send(new u.ConversationConnectionMessage(i.MessageType.Text,h))}async sendMessageAsync(h){await(await this.fetchConnection()).send(new u.ConversationConnectionMessage(i.MessageType.Text,h))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(h,v,g,m,w){this.terminateMessageLoop=!0;const C=new t.ConversationTranslationCanceledEventArgs(g,w,m,void 0,h);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,C)}catch{}}async conversationConnectImpl(h){return this.privConnectionLoop=this.startMessageLoop(),h}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const h=new i.Deferred;try{const g=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return h.resolve(),Promise.resolve();if(!g)return this.receiveConversationMessageOverride();const m=this.privConversationRequestSession.sessionId,w=g.conversationMessageType.toLowerCase();let C=!1;try{switch(w){case"info":case"participant_command":case"command":const R=s.CommandResponsePayload.fromJSON(g.textBody);switch(R.command.toLowerCase()){case"participantlist":const H=s.ParticipantsListPayloadResponse.fromJSON(g.textBody),ie=H.participants.map(Ee=>({avatar:Ee.avatar,displayName:Ee.nickname,id:Ee.participantId,isHost:Ee.ishost,isMuted:Ee.ismuted,isUsingTts:Ee.usetts,preferredLanguage:Ee.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new c.ParticipantsListEventArgs(H.roomid,H.token,H.translateTo,H.profanityFilter,H.roomProfanityFilter,H.roomLocked,H.muteAll,ie,m));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new c.ParticipantAttributeEventArgs(R.participantId,a.ConversationTranslatorCommandTypes.setTranslateToLanguages,R.value,m));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new c.ParticipantAttributeEventArgs(R.participantId,a.ConversationTranslatorCommandTypes.setProfanityFiltering,R.value,m));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new c.ParticipantAttributeEventArgs(R.participantId,a.ConversationTranslatorCommandTypes.setMute,R.value,m));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new c.MuteAllEventArgs(R.value,m));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new t.ConversationExpirationEventArgs(R.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new c.ParticipantAttributeEventArgs(R.participantId,a.ConversationTranslatorCommandTypes.setUseTTS,R.value,m));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new c.LockRoomEventArgs(R.value,m));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new c.ParticipantAttributeEventArgs(R.participantId,a.ConversationTranslatorCommandTypes.changeNickname,R.value,m));break;case"joinsession":const Y=s.ParticipantPayloadResponse.fromJSON(g.textBody),Ie={avatar:Y.avatar,displayName:Y.nickname,id:Y.participantId,isHost:Y.ishost,isMuted:Y.ismuted,isUsingTts:Y.usetts,preferredLanguage:Y.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new c.ParticipantEventArgs(Ie,m));break;case"leavesession":const De={id:R.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new c.ParticipantEventArgs(De,m));break;case"disconnectsession":const Xe={id:R.participantId};break;case"token":const Be=new r.CognitiveTokenAuthentication(()=>{const Ee=R.token;return Promise.resolve(Ee)},()=>{const Ee=R.token;return Promise.resolve(Ee)});this.authentication=Be,this.privConversationServiceConnector.onToken(Be);break;default:break}break;case"partial":case"final":const _=s.SpeechResponsePayload.fromJSON(g.textBody),E=w==="final"?t.ResultReason.TranslatedParticipantSpeech:t.ResultReason.TranslatingParticipantSpeech,T=new t.ConversationTranslationResult(_.participantId,this.getTranslations(_.translations),_.language,_.id,E,_.recognition,void 0,void 0,g.textBody,void 0);_.isFinal?((T.text!==void 0&&T.text.length>0||_.id===this.privLastPartialUtteranceId)&&(C=!0),C&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new c.ConversationReceivedTranslationEventArgs(a.ConversationTranslatorMessageTypes.final,T,m))):T.text!==void 0&&(this.privLastPartialUtteranceId=_.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new c.ConversationReceivedTranslationEventArgs(a.ConversationTranslatorMessageTypes.partial,T,m)));break;case"translated_message":const D=s.TextResponsePayload.fromJSON(g.textBody),N=new t.ConversationTranslationResult(D.participantId,this.getTranslations(D.translations),D.language,void 0,void 0,D.originalText,void 0,void 0,void 0,g.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new c.ConversationReceivedTranslationEventArgs(a.ConversationTranslatorMessageTypes.instantMessage,N,m));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return h.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const h=this.receiveConversationMessageOverride();try{return await h}catch(v){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,v),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(h=>h.state()===i.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(h=>h),this.privConnectionConfigPromise)}getTranslations(h){let v;if(h!==void 0){v=new t.Translations;for(const g of h)v.set(g.lang,g.translation)}return v}};return Kc.ConversationServiceAdapter=l,Kc}var Ww;function _b(){if(Ww)return gi;Ww=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.ConversationTranslatorRecognizer=gi.ConversationRecognizerFactory=void 0;const i=te(),t=de(),r=ge(),u=U(),o=mb(),c=Pb();class a{static fromConfig(p,h,v){return new s(p,h,v)}}gi.ConversationRecognizerFactory=a;let s=class extends u.Recognizer{constructor(p,h,v){const g=h;r.Contracts.throwIfNull(g,"speechConfig");const m=p;r.Contracts.throwIfNull(m,"conversationImpl"),super(v,g.properties,new o.ConversationConnectionFactory),this.privConversation=m,this.privIsDisposed=!1,this.privProperties=g.properties.clone(),this.privConnection=u.Connection.fromRecognizer(this),this.privProperties.getProperty(u.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=t.Timeout.setTimeout,this.privClearTimeout=t.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(p){this.privConnection.connected=p}set disconnected(p){this.privConnection.disconnected=p}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(p,h,v){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfNullOrWhitespace(p,"token"),this.privReco.conversationTranslatorToken=p,this.resetConversationTimeout(),this.privReco.connectAsync(h,v)}catch(g){if(v)if(g instanceof Error){const m=g;v(m.name+": "+m.message)}else v(g)}}disconnect(p,h){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{p&&p()},v=>{h&&h(v)})}catch(v){if(h)if(v instanceof Error){const g=v;h(g.name+": "+g.message)}else h(v);this.dispose(!0).catch(g=>{t.Events.instance.onEvent(new t.BackgroundEvent(g))})}}sendRequest(p,h,v){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(p,h,v)}catch(g){if(v)if(g instanceof Error){const m=g;v(m.name+": "+m.message)}else v(g);this.dispose(!0).catch(m=>{t.Events.instance.onEvent(new t.BackgroundEvent(m))})}}onToken(p){this.privConversation.onToken(p)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(p){this.privIsDisposed||p&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(p))}createRecognizerConfig(p){return new i.RecognizerConfig(p,this.privProperties)}createServiceRecognizer(p,h,v,g){const m=v;return new c.ConversationServiceAdapter(p,h,m,g,this)}sendMessage(p,h,v){const g=this.privReco;((w,C,R)=>{w!==void 0?w.then(()=>{try{C&&C()}catch(_){R&&R(`'Unhandled error on promise callback: ${_}'`)}},_=>{try{R&&R(_)}catch{}}):R&&R("Null promise")})(g.sendMessageAsync(p),h,v),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return gi.ConversationTranslatorRecognizer=s,gi}var Qc={},Hw;function Eb(){if(Hw)return Qc;Hw=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.TranscriberRecognizer=void 0;const i=de(),t=ge(),r=U(),u=te();let o=class extends r.Recognizer{constructor(a,s){const l=a;t.Contracts.throwIfNull(l,"speechTranslationConfig");const p=s;t.Contracts.throwIfNull(p,"audioConfigImpl"),t.Contracts.throwIfNullOrWhitespace(l.speechRecognitionLanguage,r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),super(s,l.properties,new u.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}set conversation(a){t.Contracts.throwIfNullOrUndefined(a,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=a}getConversationInfo(){return t.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(a){t.Contracts.throwIfNullOrUndefined(a,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=a}getMeetingInfo(){return t.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(a,s){i.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(u.RecognitionMode.Conversation),a,s)}stopContinuousRecognitionAsync(a,s){i.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),a,s)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(a,s){const l=this.privReco;t.Contracts.throwIfNullOrUndefined(l,"serviceRecognizer"),await l.sendSpeechEventAsync(a,s)}async pushMeetingEvent(a,s){const l=this.privReco;t.Contracts.throwIfNullOrUndefined(l,"serviceRecognizer"),await l.sendMeetingSpeechEventAsync(a,s)}async enforceAudioGating(){const l=(await this.audioConfig.format).channels;if(l===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(l!==8)throw new Error(`Unsupported audio configuration: Detected ${l}-channel audio`)}connectMeetingCallbacks(a){this.isMeetingRecognizer=!0,this.canceled=(s,l)=>{a.canceled&&a.canceled(a,l)},this.recognizing=(s,l)=>{a.transcribing&&a.transcribing(a,l)},this.recognized=(s,l)=>{a.transcribed&&a.transcribed(a,l)},this.sessionStarted=(s,l)=>{a.sessionStarted&&a.sessionStarted(a,l)},this.sessionStopped=(s,l)=>{a.sessionStopped&&a.sessionStopped(a,l)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(a){this.privDisposedRecognizer||(a&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(a))}createRecognizerConfig(a){return new u.RecognizerConfig(a,this.properties)}createServiceRecognizer(a,s,l,p){const h=l;return new u.TranscriptionServiceRecognizer(a,s,h,p,this)}};return Qc.TranscriberRecognizer=o,Qc}var Vw;function Tb(){return Vw||(Vw=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=vb();Object.defineProperty(i,"ConversationManager",{enumerable:!0,get:function(){return t.ConversationManager}});var r=cf();Object.defineProperty(i,"ConversationConnectionConfig",{enumerable:!0,get:function(){return r.ConversationConnectionConfig}});var u=_b();Object.defineProperty(i,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return u.ConversationRecognizerFactory}});var o=Eb();Object.defineProperty(i,"TranscriberRecognizer",{enumerable:!0,get:function(){return o.TranscriberRecognizer}});var c=bP();Object.defineProperty(i,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return c.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(i,"LockRoomEventArgs",{enumerable:!0,get:function(){return c.LockRoomEventArgs}}),Object.defineProperty(i,"MuteAllEventArgs",{enumerable:!0,get:function(){return c.MuteAllEventArgs}}),Object.defineProperty(i,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return c.ParticipantAttributeEventArgs}}),Object.defineProperty(i,"ParticipantEventArgs",{enumerable:!0,get:function(){return c.ParticipantEventArgs}}),Object.defineProperty(i,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return c.ParticipantsListEventArgs}});var a=kP();Object.defineProperty(i,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return a.ConversationTranslatorCommandTypes}}),Object.defineProperty(i,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return a.ConversationTranslatorMessageTypes}}),Object.defineProperty(i,"InternalParticipants",{enumerable:!0,get:function(){return a.InternalParticipants}})}(_h)),_h}var Th={},Kw;function MP(){return Kw||(Kw=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SynthesisAudioMetadata=i.MetadataType=void 0,function(r){r.WordBoundary="WordBoundary",r.Bookmark="Bookmark",r.Viseme="Viseme",r.SentenceBoundary="SentenceBoundary",r.SessionEnd="SessionEnd",r.AvatarSignal="TalkingAvatarSignal"}(i.MetadataType||(i.MetadataType={}));class t{constructor(u){this.privSynthesisAudioMetadata=JSON.parse(u)}static fromJSON(u){return new t(u)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}i.SynthesisAudioMetadata=t}(Th)),Th}var Yc={},hr={},Jw;function Ib(){if(Jw)return hr;Jw=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.SynthesisStartedEvent=hr.ConnectingToSynthesisServiceEvent=hr.SynthesisTriggeredEvent=hr.SpeechSynthesisEvent=void 0;const i=de();class t extends i.PlatformEvent{constructor(a,s,l=i.EventType.Info){super(a,l),this.privRequestId=s}get requestId(){return this.privRequestId}}hr.SpeechSynthesisEvent=t;class r extends t{constructor(a,s,l){super("SynthesisTriggeredEvent",a),this.privSessionAudioDestinationId=s,this.privTurnAudioDestinationId=l}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}hr.SynthesisTriggeredEvent=r;class u extends t{constructor(a,s){super("ConnectingToSynthesisServiceEvent",a),this.privAuthFetchEventId=s}get authFetchEventId(){return this.privAuthFetchEventId}}hr.ConnectingToSynthesisServiceEvent=u;class o extends t{constructor(a,s){super("SynthesisStartedEvent",a),this.privAuthFetchEventId=s}get authFetchEventId(){return this.privAuthFetchEventId}}return hr.SynthesisStartedEvent=o,hr}var Gw;function Ab(){if(Gw)return Yc;Gw=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.SynthesisTurn=void 0;const i=de(),t=vs(),r=U(),u=MP(),o=Ib();let c=class Vh{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=i.createNoDashGuid(),this.privTurnDeferral=new i.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(s){this.privStreamId=s}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(s){this.privAudioOutputFormat=s}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const s=new r.PropertyCollection;return s.setProperty(r.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),s}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const s=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(s),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(s,l,p,h){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=s,this.privRawText=l,this.privIsSSML=p,this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",h!==void 0&&(this.privTurnAudioDestination=h,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new o.SynthesisTriggeredEvent(this.requestId,void 0,h===void 0?void 0:h.id()))}onPreConnectionStart(s){this.privAuthFetchEventId=s,this.onEvent(new o.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(s){s&&this.onComplete()}onConnectionEstablishCompleted(s){if(s===200){this.onEvent(new o.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else s===403&&this.onComplete()}onServiceResponseMessage(s){const l=JSON.parse(s);this.streamId=l.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(s){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new i.Deferred;const l=JSON.parse(s);l.webrtc&&(this.privWebRTCSDP=l.webrtc.connectionString)}onAudioChunkReceived(s){this.isSynthesizing&&(this.privAudioOutputStream.write(s),this.privBytesReceived+=s.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(s))}onTextBoundaryEvent(s){this.updateTextOffset(s.Data.text.Text,s.Type)}onVisemeMetadataReceived(s){s.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=s.Data.AnimationChunk)}onSessionEnd(s){this.privAudioDuration=s.Data.Offset}async constructSynthesisResult(){const s=await this.getAllReceivedAudioWithHeader();return new r.SpeechSynthesisResult(this.requestId,r.ResultReason.SynthesizingAudioCompleted,s,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const s=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",s}onEvent(s){i.Events.instance.onEvent(s)}static isXmlTag(s){return s.length>=2&&s[0]==="<"&&s[s.length-1]===">"}updateTextOffset(s,l){l===u.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(s,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+s.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!Vh.isXmlTag(s)&&this.updateTextOffset(s,l))):(this.privSentenceOffset=this.privRawText.indexOf(s,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+s.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!Vh.isXmlTag(s)&&this.updateTextOffset(s,l)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(s){return this.privRawText.indexOf("<",s+1)>this.privRawText.indexOf(">",s+1)}};return Yc.SynthesisTurn=c,Yc}var Xc={},Qw;function bb(){if(Qw)return Xc;Qw=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.SynthesisAdapterBase=void 0;const i=de(),t=U(),r=te(),u=gs();let o=class{constructor(a,s,l,p){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!a)throw new i.ArgumentNullError("authentication");if(!s)throw new i.ArgumentNullError("connectionFactory");if(!l)throw new i.ArgumentNullError("synthesizerConfig");this.privAuthentication=a,this.privConnectionFactory=s,this.privSynthesizerConfig=l,this.privIsDisposed=!1,this.privSessionAudioDestination=p,this.privSynthesisTurn=new r.SynthesisTurn,this.privConnectionEvents=new i.EventSource,this.privServiceEvents=new i.EventSource,this.privSynthesisContext=new r.SynthesisContext,this.privAgentConfig=new r.AgentConfig,this.connectionEvents.attach(h=>{if(h.name==="ConnectionClosedEvent"){const v=h;v.statusCode!==1e3&&this.cancelSynthesisLocal(t.CancellationReason.Error,v.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${v.reason} websocket error code: ${v.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(a){this.privActivityTemplate=a}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(a){this.privAudioOutputFormat=a,this.privSynthesisTurn.audioOutputFormat=a,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=a),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=a)}isDisposed(){return this.privIsDisposed}async dispose(a){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(a)}async connect(){await this.connectImpl()}async sendNetworkMessage(a,s){const l=typeof s=="string"?i.MessageType.Text:i.MessageType.Binary,p=typeof s=="string"?"application/json":"";return(await this.fetchConnection()).send(new u.SpeechConnectionMessage(l,a,this.privSynthesisTurn.requestId,p,s))}async Speak(a,s,l,p,h,v){let g;if(s?g=a:g=this.privSynthesizer.buildSsml(a),this.speakOverride!==void 0)return this.speakOverride(g,l,p,h);this.privSuccessCallback=p,this.privErrorCallback=h,this.privSynthesisTurn.startNewSynthesis(l,a,s,v);try{await this.connectImpl();const m=await this.fetchConnection();await this.sendSynthesisContext(m),await this.sendSsmlMessage(m,g,l),this.onSynthesisStarted(l),this.receiveMessage()}catch(m){return this.cancelSynthesisLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,m),Promise.reject(m)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new u.SpeechConnectionMessage(i.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(a,s,l,p){const h=new t.PropertyCollection;h.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[l]);const v=new t.SpeechSynthesisResult(a,t.ResultReason.Canceled,void 0,p,h);if(this.onSynthesisCancelled(v),this.privSuccessCallback)try{this.privSuccessCallback(v)}catch{}}cancelSynthesisLocal(a,s,l){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,a,s,l))}processTypeSpecificMessages(a){return!0}async receiveMessage(){try{const s=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!s)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const l=u.SpeechConnectionMessage.fromConnectionMessage(s);if(l.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(l.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(l.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(l.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===l.streamId.toLowerCase()&&l.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(l.binaryBody),this.onSynthesizing(l.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(l.binaryBody));break;case"audio.metadata":const p=r.SynthesisAudioMetadata.fromJSON(l.textBody).Metadata;for(const v of p)switch(v.Type){case r.MetadataType.WordBoundary:case r.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(v);const g=new t.SpeechSynthesisWordBoundaryEventArgs(v.Data.Offset,v.Data.Duration,v.Data.text.Text,v.Data.text.Length,v.Type===r.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,v.Data.text.BoundaryType);this.onWordBoundary(g);break;case r.MetadataType.Bookmark:const m=new t.SpeechSynthesisBookmarkEventArgs(v.Data.Offset,v.Data.Bookmark);this.onBookmarkReached(m);break;case r.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(v),v.Data.IsLastAnimation){const w=new t.SpeechSynthesisVisemeEventArgs(v.Data.Offset,v.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(w)}break;case r.MetadataType.AvatarSignal:this.onAvatarEvent(v);break;case r.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(v);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let h;try{h=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(h)}catch(v){this.privErrorCallback&&this.privErrorCallback(v)}this.onSynthesisCompleted(h);break;default:this.processTypeSpecificMessages(l)||this.privServiceEvents&&this.serviceEvents.onEvent(new i.ServiceEvent(l.path.toLowerCase(),l.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(a){this.setSynthesisContextSynthesisSection();const s=this.synthesisContext.toJSON();if(s)return a.send(new u.SpeechConnectionMessage(i.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",s))}setSpeechConfigSynthesisSection(){}connectImpl(a=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(l=>l.state()===i.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=i.createNoDashGuid(),this.privConnectionId=i.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const s=a?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=s.then(async l=>{this.privSynthesisTurn.onAuthCompleted(!1);const p=this.privConnectionFactory.create(this.privSynthesizerConfig,l,this.privConnectionId);p.events.attach(v=>{this.connectionEvents.onEvent(v)});const h=await p.open();return h.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(h.statusCode),Promise.resolve(p)):h.statusCode===403&&!a?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(h.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${h.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Url)} Reason: ${h.reason}`))},l=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(l)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(a,s){if(s)return a.send(new u.SpeechConnectionMessage(i.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",s))}sendSsmlMessage(a,s,l){return a.send(new u.SpeechConnectionMessage(i.MessageType.Text,"ssml",l,"application/ssml+xml",s))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(a=>a.state()===i.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const a=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(a):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(a,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),a)}onAvatarEvent(a){}onSynthesisStarted(a){}onSynthesizing(a){}onSynthesisCancelled(a){}onSynthesisCompleted(a){}onWordBoundary(a){}onVisemeReceived(a){}onBookmarkReached(a){}};return Xc.SynthesisAdapterBase=o,o.telemetryDataEnabled=!0,Xc}var Zc={},Yw;function kb(){if(Yw)return Zc;Yw=1,Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.AvatarSynthesisAdapter=void 0;const i=U(),t=te();let r=class extends t.SynthesisAdapterBase{constructor(o,c,a,s,l){super(o,c,a,void 0),this.privAvatarSynthesizer=s,this.privSynthesizer=s,this.privAvatarConfig=l}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var o,c,a,s,l,p,h,v,g,m,w,C,R,_,E,T,D;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(o=this.privAvatarConfig.videoFormat)==null?void 0:o.bitrate,codec:(c=this.privAvatarConfig.videoFormat)==null?void 0:c.codec,crop:{bottomRight:{x:(l=(s=(a=this.privAvatarConfig.videoFormat)==null?void 0:a.cropRange)==null?void 0:s.bottomRight)==null?void 0:l.x,y:(v=(h=(p=this.privAvatarConfig.videoFormat)==null?void 0:p.cropRange)==null?void 0:h.bottomRight)==null?void 0:v.y},topLeft:{x:(w=(m=(g=this.privAvatarConfig.videoFormat)==null?void 0:g.cropRange)==null?void 0:m.topLeft)==null?void 0:w.x,y:(_=(R=(C=this.privAvatarConfig.videoFormat)==null?void 0:C.cropRange)==null?void 0:R.topLeft)==null?void 0:_.y}},resolution:{height:(E=this.privAvatarConfig.videoFormat)==null?void 0:E.height,width:(T=this.privAvatarConfig.videoFormat)==null?void 0:T.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(D=this.privAvatarConfig.backgroundImage)==null?void 0:D.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(o){if(this.privAvatarSynthesizer.avatarEventReceived){const c=new i.AvatarEventArgs(o.Data.Offset,o.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,c)}catch{}}}};return Zc.AvatarSynthesisAdapter=r,Zc}var eu={},Xw;function Ob(){if(Xw)return eu;Xw=1,Object.defineProperty(eu,"__esModule",{value:!0}),eu.SpeechSynthesisAdapter=void 0;const i=U(),t=te();let r=class extends t.SynthesisAdapterBase{constructor(o,c,a,s,l){super(o,c,a,l),this.privSpeechSynthesizer=s,this.privSynthesizer=s}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(o){const c=new i.SpeechSynthesisEventArgs(new i.SpeechSynthesisResult(o,i.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,c)}onSynthesizing(o){if(this.privSpeechSynthesizer.synthesizing)try{const c=this.privSynthesisTurn.audioOutputFormat.addHeader(o),a=new i.SpeechSynthesisEventArgs(new i.SpeechSynthesisResult(this.privSynthesisTurn.requestId,i.ResultReason.SynthesizingAudio,c));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,a)}catch{}}onSynthesisCancelled(o){if(this.privSpeechSynthesizer.SynthesisCanceled){const c=new i.SpeechSynthesisEventArgs(o);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,c)}catch{}}}onSynthesisCompleted(o){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new i.SpeechSynthesisEventArgs(o))}catch{}}onWordBoundary(o){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,o)}catch{}}onVisemeReceived(o){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,o)}catch{}}onBookmarkReached(o){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,o)}catch{}}};return eu.SpeechSynthesisAdapter=r,eu}var tu={},Zw;function Mb(){if(Zw)return tu;Zw=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.SynthesisRestAdapter=void 0;const i=lt(),t=U(),r=vr(),u=Pt();let o=class{constructor(a,s){let l=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!l){const h=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"westus"),v=r.ConnectionFactoryBase.getHostSuffix(h);l=a.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`https://${h}.tts.speech${v}`)}this.privUri=`${l}/cognitiveservices/voices/list`;const p=i.RestConfigBase.requestOptions;this.privRestAdapter=new i.RestMessageAdapter(p),this.privAuthentication=s}getVoicesList(a){return this.privRestAdapter.setHeaders(u.HeaderNames.ConnectionId,a),this.privAuthentication.fetch(a).then(s=>(this.privRestAdapter.setHeaders(s.headerName,s.token),this.privRestAdapter.request(i.RestRequestType.Get,this.privUri)))}};return tu.SynthesisRestAdapter=o,tu}var Ih={},eR;function xb(){return eR||(eR=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SynthesizerConfig=i.SynthesisServiceType=void 0;const t=te();var r;(function(o){o[o.Standard=0]="Standard",o[o.Custom=1]="Custom"})(r=i.SynthesisServiceType||(i.SynthesisServiceType={}));class u{constructor(c,a){this.privSynthesisServiceType=r.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=c||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=a}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(c){this.privSynthesisServiceType=c}set synthesisVideoSection(c){this.privSpeechServiceConfig.Context.synthesis={video:c}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}i.SynthesizerConfig=u}(Ih)),Ih}var ru={},tR;function Db(){if(tR)return ru;tR=1,Object.defineProperty(ru,"__esModule",{value:!0}),ru.SynthesisContext=void 0;const i=U();let t=class{constructor(){this.privContext={}}setSection(u,o){this.privContext[u]=o}set audioOutputFormat(u){this.privAudioOutputFormat=u}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(u){const o=this.buildSynthesisContext(u);this.setSection("synthesis",o)}buildSynthesisContext(u){return{audio:{metadataOptions:{bookmarkEnabled:!!(u!=null&&u.bookmarkReached),punctuationBoundaryEnabled:u==null?void 0:u.properties.getProperty(i.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(u!=null&&u.wordBoundary)),sentenceBoundaryEnabled:u==null?void 0:u.properties.getProperty(i.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(u!=null&&u.visemeReceived),wordBoundaryEnabled:u==null?void 0:u.properties.getProperty(i.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(u!=null&&u.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:u==null?void 0:u.autoDetectSourceLanguage}}}};return ru.SynthesisContext=t,ru}var nu={},rR;function jb(){if(rR)return nu;rR=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.SpeakerRecognitionConfig=void 0;const i=te();let t=class{constructor(u,o){this.privContext=u||new i.Context(null),this.privParameters=o}get parameters(){return this.privParameters}get Context(){return this.privContext}};return nu.SpeakerRecognitionConfig=t,nu}var iu={},nR;function Nb(){if(nR)return iu;nR=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.SpeakerServiceRecognizer=void 0;const i=lt(),t=de(),r=U(),u=te(),o=gs();let c=class extends u.ServiceRecognizerBase{constructor(s,l,p,h,v){super(s,l,p,h,v),this.privSpeakerRecognizer=v,this.privSpeakerAudioSource=p,this.recognizeSpeaker=g=>this.recognizeSpeakerOnce(g),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(s){let l=!1;const p=new r.PropertyCollection;switch(s.messageType===t.MessageType.Text&&p.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"speaker.response":const v=JSON.parse(s.textBody);let g;v.status.statusCode.toLowerCase()!=="success"?g=new r.SpeakerRecognitionResult(v,r.ResultReason.Canceled,r.CancellationErrorCode.ServiceError,v.status.reason):g=new r.SpeakerRecognitionResult(v,r.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(g),l=!0;break}const h=new t.Deferred;return h.resolve(l),h.promise}cancelRecognition(s,l,p,h,v){if(new r.PropertyCollection().setProperty(u.CancellationErrorCodePropertyName,r.CancellationErrorCode[h]),this.privResultDeferral){const m=new r.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:v,reason:v}},r.ResultReason.Canceled,h,v);try{this.privResultDeferral.resolve(m)}catch(w){this.privResultDeferral.reject(w)}}}async recognizeSpeakerOnce(s){this.privSpeakerModel=s,this.voiceProfileType=s.scenario,this.privResultDeferral||(this.privResultDeferral=new t.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(r.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const l=this.connectImpl(),p=this.sendPreAudioMessages(this.extractSpeakerContext(s)),h=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),v=await this.privSpeakerAudioSource.format,g=await this.privSpeakerAudioSource.deviceInfo,m=new i.ReplayableAudioNode(h,v.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(m,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:g};try{await l,await p}catch(R){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,R)}const w=new r.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,w),this.receiveMessage(),this.sendAudio(m).then(()=>{},R=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,R)}),this.privResultDeferral.promise}async sendPreAudioMessages(s){const l=await this.fetchConnection();await this.sendSpeakerRecognition(l,s)}async sendSpeakerRecognition(s,l){const p=JSON.stringify(l);return s.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",p))}extractSpeakerContext(s){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:s.profileIds,scenario:s.scenario}}};return iu.SpeakerServiceRecognizer=c,iu}var su={},iR;function zb(){if(iR)return su;iR=1,Object.defineProperty(su,"__esModule",{value:!0}),su.VoiceServiceRecognizer=void 0;const i=lt(),t=de(),r=U(),u=te(),o=gs();let c=class extends u.ServiceRecognizerBase{constructor(s,l,p,h,v){super(s,l,p,h,v),this.privDeferralMap=new t.DeferralMap,this.privSpeakerAudioSource=p,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(s){this.privSpeakerAudioSource=s}processTypeSpecificMessages(s){let l=!1;const p=new r.PropertyCollection;switch(s.messageType===t.MessageType.Text&&p.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,s.textBody),s.path.toLowerCase()){case"speaker.profiles":const v=JSON.parse(s.textBody);switch(v.operation.toLowerCase()){case"create":this.handleCreateResponse(v,s.requestId);break;case"delete":case"reset":this.handleResultResponse(v,s.requestId);break;case"fetch":const C=JSON.parse(s.textBody);this.handleFetchResponse(C,s.requestId);break}l=!0;break;case"speaker.phrases":const g=JSON.parse(s.textBody);this.handlePhrasesResponse(g,s.requestId),l=!0;break;case"speaker.profile.enrollment":const m=JSON.parse(s.textBody),w=new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(m.enrollment?m.enrollment.enrollmentStatus:m.status.statusCode),m.enrollment?JSON.stringify(m.enrollment):void 0,m.status.reason);this.privDeferralMap.getId(s.requestId)&&this.privDeferralMap.complete(s.requestId,w),this.privRequestSession.onSpeechEnded(),l=!0;break}const h=new t.Deferred;return h.resolve(l),h.promise}cancelRecognition(s,l,p,h,v){new r.PropertyCollection().setProperty(u.CancellationErrorCodePropertyName,r.CancellationErrorCode[h]);const m=new r.VoiceProfileEnrollmentResult(r.ResultReason.Canceled,v,v);this.privDeferralMap.getId(l)&&this.privDeferralMap.complete(l,m)}async createProfile(s,l){this.voiceProfileType=s.toString();const p=this.connectImpl();try{const h=new t.Deferred;return await p,await this.sendCreateProfile(h,s,l),this.receiveMessage(),h.promise}catch(h){throw h}}async resetProfile(s){return this.voiceProfileType=s.profileType.toString(),this.sendCommonRequest("reset",s.profileType,s)}async deleteProfile(s){return this.voiceProfileType=s.profileType.toString(),this.sendCommonRequest("delete",s.profileType,s)}async retrieveEnrollmentResult(s){return this.voiceProfileType=s.profileType.toString(),this.privExpectedProfileId=s.profileId,this.sendCommonRequest("fetch",s.profileType,s)}async getAllProfiles(s){return this.voiceProfileType=s.toString(),this.sendCommonRequest("fetch",s)}async getActivationPhrases(s,l){this.voiceProfileType=s.toString();const p=this.connectImpl();try{const h=new t.Deferred;return await p,await this.sendPhrasesRequest(h,s,l),this.receiveMessage(),h.promise}catch(h){throw h}}async enrollProfile(s){this.voiceProfileType=s.profileType.toString();const l=new t.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(r.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const p=this.connectImpl(),h=this.sendPreAudioMessages(s,l),v=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),g=await this.privSpeakerAudioSource.format,m=await this.privSpeakerAudioSource.deviceInfo,w=new i.ReplayableAudioNode(v,g.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(w,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:m};try{await p,await h}catch(_){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,_)}const C=new r.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,C),this.receiveMessage(),this.sendAudio(w).then(()=>{},_=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,_)}),l.promise}async sendPreAudioMessages(s,l){const p=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,l),await this.sendBaseRequest(p,"enroll",this.scenarioFrom(s.profileType),s)}async sendPhrasesRequest(s,l,p){const h=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,s);const v=this.scenarioFrom(l),g={locale:p,scenario:v};return h.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(g)))}async sendCreateProfile(s,l,p){const h=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,s);const v=l===r.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":l===r.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",g={locale:p,number:"1",scenario:v};return h.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(g)))}async sendCommonRequest(s,l,p=void 0){const h=this.connectImpl();try{const v=new t.Deferred;this.privRequestSession.onSpeechContext(),await h;const g=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,v),await this.sendBaseRequest(g,s,this.scenarioFrom(l),p),this.receiveMessage(),v.promise}catch(v){throw v}}async sendBaseRequest(s,l,p,h){const v={scenario:p};return h?v.profileIds=[h.profileId]:v.maxPageSize=-1,s.send(new o.SpeechConnectionMessage(t.MessageType.Text,`speaker.profile.${l}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(v)))}extractSpeakerContext(s){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:s.profileIds,scenario:s.scenario}}handlePhrasesResponse(s,l){if(this.privDeferralMap.getId(l))if(s.status.statusCode.toLowerCase()!=="success"){const p=r.ResultReason.Canceled,h=new r.VoiceProfilePhraseResult(p,s.status.statusCode,s.passPhraseType,[]);this.privDeferralMap.complete(l,h)}else if(s.phrases&&s.phrases.length>0){const p=r.ResultReason.EnrollingVoiceProfile,h=new r.VoiceProfilePhraseResult(p,s.status.statusCode,s.passPhraseType,s.phrases);this.privDeferralMap.complete(l,h)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${l} not found`)}handleCreateResponse(s,l){if(s.profiles&&s.profiles.length>0)if(this.privDeferralMap.getId(l)){const p=s.profiles.map(h=>h.profileId);this.privDeferralMap.complete(l,p)}else throw new Error(`Voice Profile create request for requestID ${l} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(s,l){if(this.privDeferralMap.getId(l)){const p=s.operation.toLowerCase()==="delete"?r.ResultReason.DeletedVoiceProfile:r.ResultReason.ResetVoiceProfile,h=s.status.statusCode.toLowerCase()==="success"?p:r.ResultReason.Canceled,v=new r.VoiceProfileResult(h,`statusCode: ${s.status.statusCode}, errorDetails: ${s.status.reason}`);this.privDeferralMap.complete(l,v)}else throw new Error(`Voice Profile create request for requestID ${l} not found`)}handleFetchResponse(s,l){if(this.privDeferralMap.getId(l)&&s.profiles[0]){if(this.privExpectedProfileId&&s.profiles.length===1&&s.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const p=s.profiles[0],h=new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(p.enrollmentStatus),JSON.stringify(p),s.status.reason);this.privDeferralMap.complete(l,h)}else if(s.profiles.length>0){const p=s.profiles,h=[];for(const v of p)h.push(new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(v.enrollmentStatus),JSON.stringify(v),s.status.reason));this.privDeferralMap.complete(l,h)}}else throw new Error(`Voice Profile fetch request for requestID ${l} not found`)}enrollmentReasonFrom(s){switch(s.toLowerCase()){case"enrolled":return r.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return r.ResultReason.Canceled;default:return r.ResultReason.EnrollingVoiceProfile}}scenarioFrom(s){return s===r.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":s===r.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};return su.VoiceServiceRecognizer=c,su}var Ah={},sR;function Lb(){return sR||(sR=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.type=i.connectivity=i.Device=i.OS=i.System=i.Context=i.SpeechServiceConfig=void 0;class t{constructor(s){this.context=s}serialize(){return JSON.stringify(this,(s,l)=>{if(l&&typeof l=="object"&&!Array.isArray(l)){const p={};for(const h in l)Object.hasOwnProperty.call(l,h)&&(p[h&&h.charAt(0).toLowerCase()+h.substring(1)]=l[h]);return p}return l})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(s){this.recognition=s.toLowerCase()}}i.SpeechServiceConfig=t;class r{constructor(s){this.system=new u,this.os=s}}i.Context=r;class u{constructor(){const s="1.43.1";this.name="SpeechSDK",this.version=s,this.build="JavaScript",this.lang="JavaScript"}}i.System=u;class o{constructor(s,l,p){this.platform=s,this.name=l,this.version=p}}i.OS=o;class c{constructor(s,l,p){this.manufacturer=s,this.model=l,this.version=p}}i.Device=c,function(a){a.Bluetooth="Bluetooth",a.Wired="Wired",a.WiFi="WiFi",a.Cellular="Cellular",a.InBuilt="InBuilt",a.Unknown="Unknown"}(i.connectivity||(i.connectivity={})),function(a){a.Phone="Phone",a.Speaker="Speaker",a.Car="Car",a.Headset="Headset",a.Thermostat="Thermostat",a.Microphones="Microphones",a.Deskphone="Deskphone",a.RemoteControl="RemoteControl",a.Unknown="Unknown",a.File="File",a.Stream="Stream"}(i.type||(i.type={}))}(Ah)),Ah}var oR;function te(){return oR||(oR=1,function(i){var t=Yn&&Yn.__createBinding||(Object.create?function(c,a,s,l){l===void 0&&(l=s),Object.defineProperty(c,l,{enumerable:!0,get:function(){return a[s]}})}:function(c,a,s,l){l===void 0&&(l=s),c[l]=a[s]}),r=Yn&&Yn.__exportStar||function(c,a){for(var s in c)s!=="default"&&!a.hasOwnProperty(s)&&t(a,c,s)};Object.defineProperty(i,"__esModule",{value:!0}),i.AutoDetectSourceLanguagesOpenRangeOptionName=i.ForceDictationPropertyName=i.ServicePropertiesPropertyName=i.CancellationErrorCodePropertyName=i.OutputFormatPropertyName=void 0,r(T1(),i),r(I1(),i),r(tf(),i),r(A1(),i),r(b1(),i),r(OA(),i),r(MA(),i),r(af(),i),r(xA(),i),r(DA(),i),r(jA(),i),r(NA(),i),r(zA(),i),r(LA(),i),r(qA(),i),r(BA(),i),r(FA(),i),r(mP(),i),r(UA(),i),r($A(),i),r(WA(),i),r(HA(),i),r(VA(),i),r(KA(),i),r(JA(),i),r(GA(),i),r(QA(),i),r(YA(),i),r(XA(),i),r(ZA(),i),r(eb(),i),r(tb(),i),r(rb(),i),r(nb(),i),r(ib(),i),r(sb(),i),r(ab(),i),r(cb(),i),r(ub(),i),r(lb(),i),r(hb(),i),r(fb(),i),r(Tb(),i),r(MP(),i),r(Ab(),i),r(bb(),i);var u=kb();Object.defineProperty(i,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return u.AvatarSynthesisAdapter}});var o=Ob();Object.defineProperty(i,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return o.SpeechSynthesisAdapter}}),r(Mb(),i),r(xb(),i),r(Db(),i),r(jb(),i),r(Nb(),i),r(zb(),i),r(Lb(),i),i.OutputFormatPropertyName="OutputFormat",i.CancellationErrorCodePropertyName="CancellationErrorCode",i.ServicePropertiesPropertyName="ServiceProperties",i.ForceDictationPropertyName="ForceDictation",i.AutoDetectSourceLanguagesOpenRangeOptionName="UND"}(Yn)),Yn}var aR;function qb(){return aR||(aR=1,function(i){var t=Qn&&Qn.__createBinding||(Object.create?function(o,c,a,s){s===void 0&&(s=a),Object.defineProperty(o,s,{enumerable:!0,get:function(){return c[a]}})}:function(o,c,a,s){s===void 0&&(s=a),o[s]=c[a]}),r=Qn&&Qn.__exportStar||function(o,c){for(var a in o)a!=="default"&&!c.hasOwnProperty(a)&&t(c,o,a)};Object.defineProperty(i,"__esModule",{value:!0});const u=te();new u.AgentConfig,r(U(),i)}(Qn)),Qn}var vt=qb();const Bb=Kh(vt),Fb=P_({__proto__:null,default:Bb},[vt]);async function Ub(i="auto"){try{if(console.log("Speech recognition starting - environment check"),console.log("User Agent:",navigator.userAgent),console.log("Platform:",navigator.platform),console.log("Language setting:",i),typeof window>"u")throw console.error("Window object is undefined - not in browser context"),new Error("This feature requires a browser environment");if(!navigator||!navigator.mediaDevices)throw console.error("MediaDevices API not available"),navigator.userAgent.indexOf("Chrome")>-1?new Error("Please ensure Chrome has permission to use your microphone. Check chrome://settings/content/microphone"):new Error("Your browser doesn't support microphone access");console.log("Checking for Azure credentials...");const t="DtApwgP99FUcpzYFHQTviP3DG42f92Fs5nm4xvz9tZKuGLH7JQYsJQQJ99BDACqBBLyXJ3w3AAAYACOGN3bu",r="southeastasia";if(!Fb||!vt.SpeechConfig)throw console.error("Speech SDK not loaded properly"),new Error("Speech recognition SDK failed to load");console.log("Setting up microphone permissions...");let u=null;try{const l={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:1}},p=await navigator.mediaDevices.getUserMedia(l);console.log("Microphone permission granted:",p),u=p,p.getTracks().forEach(h=>{h.stop(),console.log("Track stopped:",h.id)}),await new Promise(h=>setTimeout(h,300))}catch(l){throw console.error("Error accessing microphone:",l),l.name==="NotAllowedError"?new Error("Microphone access denied. Check browser permissions."):l.name==="NotFoundError"?new Error("No microphone found. Please connect a microphone."):new Error(`Microphone error: ${l.message}`)}console.log("Creating speech config...");let o;try{o=vt.SpeechConfig.fromSubscription(t,r),console.log("Speech config created successfully")}catch(l){throw console.error("Failed to create speech config:",l),new Error("Failed to initialize speech recognition: "+(l.message||"configuration error"))}try{i==="auto"?console.log("Auto language detection mode enabled"):i==="zh-CN"?(o.speechRecognitionLanguage="zh-CN",console.log("Speech language set to Mandarin Chinese (zh-CN)")):(o.speechRecognitionLanguage="en-US",console.log("Speech language set to English (en-US)"))}catch(l){console.warn("Error setting language:",l)}console.log("Creating audio config...");let c;try{c=vt.AudioConfig.fromDefaultMicrophoneInput(),console.log("Audio config created successfully")}catch(l){throw console.error("Error creating audio config:",l),new Error("Failed to initialize microphone: "+(l.message||"audio configuration error"))}console.log("Creating speech recognizer...");let a,s=null;try{if(i==="auto"){const l=vt.SpeechConfig.fromSubscription(t,r);l.speechRecognitionLanguage="en-US";const p=vt.SpeechConfig.fromSubscription(t,r);p.speechRecognitionLanguage="zh-CN",a=new vt.SpeechRecognizer(l,c),s=new vt.SpeechRecognizer(p,c),console.log("Dual recognizers created for auto language detection")}else a=new vt.SpeechRecognizer(o,c),console.log("Speech recognizer created successfully")}catch(l){throw console.error("Failed to create recognizer:",l),new Error("Failed to initialize speech recognizer: "+(l.message||"recognizer creation error"))}return console.log("Starting speech recognition session..."),new Promise((l,p)=>{try{const h=setTimeout(()=>{if(console.error("Recognition timed out"),a)try{a.close()}catch(g){console.error("Error closing recognizer:",g)}if(s)try{s.close()}catch(g){console.error("Error closing Mandarin recognizer:",g)}p(new Error("Recognition timed out. Please try again."))},15e3),v=()=>{if(a)try{a.close()}catch(g){console.error("Error closing recognizer:",g)}if(s)try{s.close()}catch(g){console.error("Error closing Mandarin recognizer:",g)}};if(a.recognizing=(g,m)=>{console.log(`RECOGNIZING: ${m.result.text}`)},i==="auto"){let g=null,m=null;const w=()=>{if(g&&m){clearTimeout(h),v(),console.log("English recognition confidence:",g.confidence),console.log("Mandarin recognition confidence:",m.confidence);const C=/[\u4e00-\u9fa5]/.test(m.text);m.confidence>.6||C?(console.log("Auto-detected language: Mandarin Chinese"),l({text:m.text,language:"zh-CN"})):(console.log("Auto-detected language: English"),l({text:g.text,language:"en-US"}))}};a.recognizeOnceAsync(C=>{console.log("English recognition result:",C),C.reason===vt.ResultReason.RecognizedSpeech?(g={text:C.text,confidence:C.confidence!==void 0?C.confidence:.7},w()):m&&(clearTimeout(h),v(),l({text:m.text,language:"zh-CN"}))},C=>{console.error("English recognition error:",C)}),s.recognizeOnceAsync(C=>{console.log("Mandarin recognition result:",C),C.reason===vt.ResultReason.RecognizedSpeech?(m={text:C.text,confidence:C.confidence!==void 0?C.confidence:.7},w()):g&&(clearTimeout(h),v(),l({text:g.text,language:"en-US"}))},C=>{console.error("Mandarin recognition error:",C)})}else a.recognizeOnceAsync(g=>{if(clearTimeout(h),console.log("Recognition result:",g),v(),g.reason===vt.ResultReason.RecognizedSpeech)console.log("Recognized text:",g.text),l({text:g.text,language:i==="zh-CN"?"zh-CN":"en-US"});else if(g.reason===vt.ResultReason.NoMatch)console.error("NOMATCH: No speech could be recognized."),p(new Error("No speech detected. Please try speaking more clearly."));else if(g.reason===vt.ResultReason.Canceled){const m=vt.CancellationDetails.fromResult(g);console.error("CANCELED: Reason=",m.reason),m.reason===vt.CancellationReason.Error?(console.error("CANCELED: ErrorCode=",m.errorCode),console.error("CANCELED: ErrorDetails=",m.errorDetails),p(new Error(`Recognition canceled: ${m.errorDetails||"Unknown error"}`))):p(new Error("Recognition canceled"))}else p(new Error("Speech recognition failed with reason: "+g.reason))},g=>{clearTimeout(h),console.error("Recognition error:",g),v(),p(new Error("Recognition error: "+(g.message||"Unknown error")))})}catch(h){if(console.error("Error during recognizer setup:",h),a)try{a.close()}catch(v){console.error("Error closing recognizer:",v)}if(s)try{s.close()}catch(v){console.error("Error closing Mandarin recognizer:",v)}p(new Error("Failed to start speech recognition: "+h.message))}})}catch(t){throw console.error("Speech recognition setup failed:",t),t}}function $b({threadId:i,onCreateThreadWithAutonaming:t}){const[r,u]=Q.useState([]),o=r.filter(z=>!z.is_canceled),[c,a]=Q.useState(""),[s,l]=Q.useState(!1),[p,h]=Q.useState(null),[v,g]=Q.useState(null),[m,w]=Q.useState({}),[C,R]=Q.useState(!1),[_,E]=Q.useState(null),[T,D]=Q.useState(!1),[N,H]=Q.useState(""),[ie,Y]=Q.useState(!1),[Ie,De]=Q.useState(!1),[Xe,Be]=Q.useState(!1),[Ee,pe]=Q.useState(!1),[Ce,ae]=Q.useState(!0),[se,$]=Q.useState(!1),[ee,V]=Q.useState(0),[O,L]=Q.useState(null),ce=Q.useRef(null),fe=z=>`${Math.floor(z/60)}m ${z%60}s`;Q.useEffect(()=>{console.log(" useEffect [userId] triggered, userId:",O),O&&(ae(!0),me(O))},[O]);const Se=()=>{er.current&&clearInterval(er.current),er.current=setInterval(()=>{V(z=>z<=1?(clearInterval(er.current),$(!1),0):z-1)},1e3)},me=async z=>{console.log(" Running checkTokenStatus for userId:",z);try{const K=await(await fetch(`http://192.168.0.198:3000/api/ai/tutor/token-status?userId=${z}`)).json();K.isLimited?($(!0),V(K.cooldownSecondsRemaining||7200),Se()):$(!1)}catch(G){console.error("Token check failed:",G)}finally{ae(!1)}};Q.useEffect(()=>{(async()=>{const{data:{user:G}}=await be.auth.getUser();G&&await me(G.id)})()},[]);const ke=Ee||o.length===0,[_e,Oe]=Q.useState({}),[dt,Ar]=Q.useState(!1),[Ii,gr]=Q.useState(!1),[Gr,Ai]=Q.useState(!1),Zt=Q.useRef(null),_t=Q.useRef(null),[bi,Qr]=Q.useState(null),[br,Vt]=Q.useState(""),[Yr,On]=Q.useState(!1),ki=15;Q.useRef(null);const Dt=Q.useRef(null),Mn=Q.useRef(null),kr=Q.useRef(null),er=Q.useRef(null);Q.useEffect(()=>{r.length>0&&pe(!1)},[r]),Q.useEffect(()=>{(async()=>{const{data:G}=await be.auth.getUser();G!=null&&G.user})()},[]),Q.useEffect(()=>{(async()=>{if(!i)return;const{data:J,error:ve}=await be.from("messages").select("*").eq("thread_id",i).eq("is_canceled",!1).order("created_at",{ascending:!0});if(ve)console.error("Failed to fetch messages:",ve.message),h("Chat history cannot be loaded, please refresh the page");else{u(J||[]);for(const xe of J||[])xe.role==="assistant"&&await Or(xe.content,xe.id);h(null)}})();const G=be.channel("chat-messages-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`thread_id=eq.${i}`},async J=>{if(!J.new.is_canceled&&(u(ve=>[...ve,J.new]),J.new.role==="assistant")){jt(J.new);const ve=await Or(J.new.content,J.new.id);console.log("Real-time message received, voice mode:",ie,"language supported:",ve),ie&&ve&&setTimeout(()=>{console.log("Starting TTS playback from real-time update"),mr(J.new.content,J.new.id)},800)}}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages",filter:`thread_id=eq.${i}`},J=>{const ve=J.new;u(xe=>ve.is_canceled?xe.filter(yr=>yr.id!==ve.id):xe.map(yr=>yr.id===ve.id?ve:yr))}).subscribe(),K=document.querySelector("textarea");return K&&(K.style.height="40px"),()=>be.removeChannel(G)},[i,ie]),Q.useEffect(()=>{if(i){const G=_e[i]||"";a(G)}else a("");g(null);const z=document.querySelector("textarea");z&&(z.style.height="40px",_e[i]&&setTimeout(()=>{z.style.height="auto",z.style.height=`${Math.min(z.scrollHeight,150)}px`},0))},[i,_e]),Q.useEffect(()=>{var z;(z=Mn.current)==null||z.scrollIntoView({behavior:"smooth"})},[r,s]),Q.useEffect(()=>()=>{zh(),Dt.current&&clearTimeout(Dt.current)},[]),Q.useEffect(()=>{const{data:z}=be.auth.onAuthStateChange(async(G,K)=>{K!=null&&K.user&&(ae(!0),await me(K.user.id))});return()=>{z.subscription.unsubscribe()}},[]),Q.useEffect(()=>{const{data:z}=be.auth.onAuthStateChange((G,K)=>{var J;(J=K==null?void 0:K.user)!=null&&J.id&&L(K.user.id)});return be.auth.getUser().then(({data:G})=>{var K;(K=G==null?void 0:G.user)!=null&&K.id&&L(G.user.id)}),()=>{z.subscription.unsubscribe()}},[]);const Or=async(z,G)=>{try{const J=await fetch("http://192.168.0.198:3000/api/langdetect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:z})}),ve=await J.json();if(!J.ok)throw new Error(ve.error||"Language detection failed");return w(xe=>({...xe,[G]:{isSupported:ve.isSupported,language:ve.language}})),ve.isSupported}catch(K){return console.error("Language Detection Error:",K.message),!1}},Mr=async()=>{Ar(!0);try{if(Zt.current&&Zt.current.abort(),_t.current){const z=_t.current;u(K=>K.filter(J=>J.id!==z)),await be.from("messages").update({is_canceled:!0,content:"[Message canceled by user]"}).eq("id",z);const{data:G}=await be.from("messages").select("id").eq("thread_id",i).eq("is_canceled",!1);(!G||G.length===0)&&await be.from("threads").delete().eq("id",i),_t.current=null}}catch(z){console.error("Error during cancellation:",z.message)}finally{l(!1),Ar(!1),h(null),ce.current=null}},jt=z=>{On(!0),Qr(z.id),Vt("");let G=0;const K=z.content,J=setInterval(()=>{G<K.length?(Vt(ve=>ve+K.charAt(G)),G++):(clearInterval(J),On(!1),Qr(null))},ki);return()=>clearInterval(J)},nt=async z=>{try{const K=await fetch("http://192.168.0.198:3000/api/langdetect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:z})}),J=await K.json();if(!K.ok)throw new Error(J.error||"Language detection failed");g(J.language)}catch(G){console.error("Input Language Detection Error:",G.message),g(null)}},xn=async z=>{const G=z.target.value;a(G),ie&&Y(!1),i&&Oe(J=>({...J,[i]:G}));const K=z.target;K.style.height="auto",K.style.height=`${Math.min(K.scrollHeight,150)}px`,K.scrollHeight>150&&(K.scrollTop=K.scrollHeight),G.trim().length>0?await nt(G):g(null),Y(!1)},Xr=async()=>{if(console.log("sendMessage function triggered"),!c.trim())return;console.log("Original content received in sendMessage :",c),l(!0),Zt.current=new AbortController;const z=Zt.current.signal,{data:{user:G}}=await be.auth.getUser();if(!G)return alert("Please log in first!");const K=i;if(!K){console.error("No thread ID found");return}const J=`temp-${Date.now()}`,ve={role:"user",content:c,thread_id:K,created_at:new Date};_t.current=J,u(it=>[...it,{...ve,id:J}]),console.log("Final text sent to backend tts:",c);const{id:xe,...yr}=ve,{data:Nt,error:Et}=await be.from("messages").insert(ve).select();if(Et)console.error("Supabase insert error:",Et.message);else if(Nt&&Nt.length>0){const it=Nt[0].id;u(Ke=>Ke.map(Ue=>Ue.id===J?Nt[0]:Ue)),_t.current=it}const{error:zt}=await be.from("threads").update({updated_at:new Date().toISOString()}).eq("id",i);zt&&console.error("Error updating thread timestamp:",zt),l(!0);const nr=Date.now();ce.current=nr;try{const it="http://192.168.0.198:3000/api/ai/tutor";console.log("Content being sent to backend AI Tutor zz:",c);const Ke=await fetch(it,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:c,threadId:K,userId:G.id}),signal:z});let Ue;try{Ue=await Ke.json(),console.log("Response received from backend AI Tutor zz:",Ue)}catch{Ue={}}if(!Ke.ok){let $e="AI Tutor is temporarily unavailable. Please try again later.";if(Ke.status===429&&Ue.error){const jr=Ue.cooldownSecondsRemaining||7200;$e=Ue.error||`Message limit reached. Please wait ${Math.floor(jr/60)} minutes.`,$(!0),V(jr),Se(),h($e);return}throw h($e),new Error($e)}if(ce.current!==nr){console.warn("Outdated response ignored (text input)");return}const pt={role:"assistant",content:Ue.content,thread_id:K,created_at:new Date};console.log("AI message content before adding to messages state zz:",Ue.content);const{data:Ze,error:jn}=await be.from("messages").insert(pt).select();if(jn)u($e=>[...$e,pt]);else if(Ze&&Ze.length>0){u(jr=>[...jr,Ze[0]]),jt(Ze[0]);const $e=await Or(Ze[0].content,Ze[0].id);ie&&$e&&setTimeout(()=>mr(Ze[0].content,Ze[0].id),500)}if(h(null),r.length===0&&t){const $e=c.trim().replace(/^"|"$/g,"");t($e)}}catch(it){console.error("AI Tutor Error:",it.message),it.name!=="AbortError"&&h("AI Tutor is temporarily unavailable. Please try again later.")}finally{l(!1),a(""),i&&Oe(Ke=>{const Ue={...Ke};return delete Ue[i],Ue}),g(null);const it=document.querySelector("textarea");it&&(it.style.height="40px")}},ms=async(z,G=!1)=>{if(console.log("sendMessageWithContent function triggered"),!z.trim())return;console.log("Original content received in sendMessageWithContent:",z);const{data:{user:K}}=await be.auth.getUser();if(!K)return alert("Please log in first!");const J=i;if(!J){console.error("No thread ID found");return}G&&Y(!0);const ve=`temp-${Date.now()}`,xe={role:"user",content:z,thread_id:J,created_at:new Date};_t.current=ve,u(Ke=>[...Ke,{...xe,id:ve}]),console.log("Final text sent to backend tts 123:",z);const{id:yr,...Nt}=xe,{data:Et,error:zt}=await be.from("messages").insert(xe).select();if(zt)console.error("Supabase insert error:",zt.message);else if(Et&&Et.length>0){const Ke=Et[0].id;u(Ue=>Ue.map(pt=>pt.id===ve?Et[0]:pt)),_t.current=Ke}const{error:nr}=await be.from("threads").update({updated_at:new Date().toISOString()}).eq("id",i);nr&&console.error("Error updating thread timestamp:",nr),l(!0);const it=Date.now();ce.current=it;try{Zt.current=new AbortController;const Ke=Zt.current.signal,Ue="http://192.168.0.198:3000/api/ai/tutor";console.log("Content being sent to backend AI Tutor:",z);const pt=await fetch(Ue,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:z,threadId:J,userId:K.id}),signal:Ke});let Ze;try{Ze=await pt.json(),console.log("Response received from backend AI Tutor:",Ze)}catch{Ze={}}if(!pt.ok){let Tt="AI Tutor is temporarily unavailable. Please try again later.";if(pt.status===429&&Ze.error){const Nn=Ze.cooldownSecondsRemaining||7200;Tt=Ze.error||`Message limit reached. Please wait ${Math.floor(Nn/60)} minutes.`,$(!0),V(Nn),Se(),h(Tt);return}throw h(Tt),new Error(Tt)}if(ce.current!==it){console.warn("Outdated response ignored (text input)");return}const jn={role:"assistant",content:Ze.content,thread_id:J,created_at:new Date};console.log("AI message content before adding to messages state:",Ze.content);const{data:$e,error:jr}=await be.from("messages").insert(jn).select();if(console.log("Voice mode active before handling response:",G,ie),jr)u(Tt=>[...Tt,jn]);else if($e&&$e.length>0){u(Nn=>[...Nn,$e[0]]),jt($e[0]),console.log("Message content being checked for language support:",$e[0].content);const Tt=await Or($e[0].content,$e[0].id);(G||ie)&&Tt?(console.log("Activating TTS because voice input was detected"),setTimeout(()=>mr($e[0].content,$e[0].id),800)):console.log("Not activating TTS, voice not detected or language not supported")}if(h(null),_t.current=null,r.length===0&&t){const Tt=z.trim().replace(/^"|"$/g,"");t(Tt)}}catch(Ke){console.error("AI Tutor Error:",Ke.message),Ke.name!=="AbortError"&&h("AI Tutor is temporarily unavailable. Please try again later.")}finally{l(!1),a(""),i&&Oe(Ke=>{const Ue={...Ke};return delete Ue[i],Ue}),g(null)}},Zr=async()=>{if(T)return;localStorage.getItem("voiceWarningAccepted")==="true"?en():gr(!0)},en=async()=>{D(!0),H("Initializing..."),Dt.current&&clearTimeout(Dt.current),Dt.current=setTimeout(()=>{D(!1),H(""),h("Recording timed out. Please try again.")},2e4);try{const z={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}};(await navigator.mediaDevices.getUserMedia(z)).getTracks().forEach(xe=>xe.stop()),H(" Recording... (Auto-detect)");const K=await Ub("auto"),J=K.text,ve=K.language;if(J&&J.trim())H(` Success! (${ve==="zh-CN"?"Mandarin":"English"})`),g(ve),Y(!0),setTimeout(()=>{H(""),a(J),setTimeout(()=>{ms(J,!0)},300)},1e3);else throw new Error("No speech detected. Please try speaking more clearly.")}catch(z){h(`Speech error: ${z.message}`),H("")}finally{D(!1),Dt.current&&(clearTimeout(Dt.current),Dt.current=null)}},tn=()=>{zh(),R(!1),E(null),Be(!1)},mr=async(z,G)=>{var K;if(console.log("Text received in handlePlayPronunciation:",z),tn(),Be(!0),!C)try{R(!0),E(G);const J=document.getElementById(`tts-status-${G}`),ve=((K=m[G])==null?void 0:K.language)||"en-US";await WT(z,ve)}catch(J){console.error("TTS Error during playback:",J.message),alert("Pronunciation playback failed: "+J.message)}finally{R(!1),E(null);const J=document.getElementById(`tts-status-${G}`);J&&(J.textContent="")}},xr=z=>{var G;return((G=m[z])==null?void 0:G.isSupported)===!0},tr=z=>m[z]?m[z].isSupported?"Play pronunciation":"Voice playback only available for Mandarin and English":"Voice playback not available",rr=(z,G)=>{navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(z).then(()=>{const K=document.getElementById(G);K.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>`,K.disabled=!0,setTimeout(()=>{const J=`
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
              <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
              <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
            </svg>`;K.innerHTML=J,K.disabled=!1},1e3)}).catch(()=>Dn(z,G)):Dn(z,G)},Dn=(z,G)=>{const K=document.createElement("textarea");K.value=z,K.style.position="fixed",K.style.top="0",K.style.left="0",K.style.width="2em",K.style.height="2em",K.style.border="none",K.style.outline="none",K.style.boxShadow="inset 0 0 0 9999px #fff",K.style.opacity="0",document.body.appendChild(K),K.focus(),K.select();try{const J=document.execCommand("copy"),ve=document.getElementById(G);J&&(ve.innerHTML=`
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>`,ve.disabled=!0,setTimeout(()=>{const xe=`
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
              <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
              <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
            </svg>`;ve.innerHTML=xe,ve.disabled=!1},1e3))}catch{alert("Failed to copy message.")}document.body.removeChild(K)},Dr=z=>{if(z.key==="Enter")if(z.shiftKey){z.preventDefault();const G=z.target.selectionStart,K=c.slice(0,G)+`
`+c.slice(G);a(K),setTimeout(()=>{const J=document.querySelector("textarea");J&&(J.selectionStart=G+1,J.selectionEnd=G+1,J.scrollTop=J.scrollHeight,J.style.height="auto",J.style.height=`${Math.min(J.scrollHeight,150)}px`,J.scrollHeight>150&&(J.scrollTop=J.scrollHeight),J.focus())},0)}else c.trim()&&!s&&!T&&(z.preventDefault(),Y(!1),Xr())},Oi=()=>{if(!c.trim()){alert("Message cannot be empty!");return}if(s||T){console.warn("Cannot send message while loading or recording.");return}const z=document.querySelector("textarea");z&&(z.focus(),z.scrollTop=z.scrollHeight),setTimeout(()=>{Y(!1),Xr()},0)};Q.useEffect(()=>{const z=kr.current;if(!z)return;const G=()=>{const{scrollTop:K,scrollHeight:J,clientHeight:ve}=z,xe=K+ve<J-20;De(xe)};return G(),r.length>0&&setTimeout(G,300),z.addEventListener("scroll",G),()=>{z.removeEventListener("scroll",G)}},[r]);const Mi=()=>{const z=kr.current;z&&z.scrollTo({top:z.scrollHeight,behavior:"smooth"})};return Ce?A.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-lg",children:"Loading access status..."}):A.jsxs("div",{className:"flex flex-col h-full bg-white pt-[120px]",children:[se&&A.jsx("div",{className:"absolute top-[56px] md:top-0 left-0 right-0 z-50 flex justify-center",children:A.jsx("div",{className:"w-full md:max-w-[900px] bg-blue-50 border-b border-blue-500 text-blue-800 px-4 py-3 shadow-md",children:A.jsxs("p",{className:"text-sm md:text-base leading-relaxed text-center",children:["Hey, thanks for the hustle!  You've hit your token limit.",A.jsxs("strong",{children:[" Come back in ",fe(ee)," "]}),"to unlock new stuff! In the meantime, feel free to review your past lessons  you got this!"]})})}),A.jsxs("div",{ref:kr,className:"flex-1 overflow-y-auto p-3 space-y-3 relative",children:[o.map(z=>{const G=`copy-btn-${z.id}`,K=z.role==="assistant",J=Yr&&bi===z.id;return A.jsx("div",{className:`flex ${z.role==="user"?"justify-end":"justify-start"} mb-2`,children:A.jsxs("div",{className:"max-w-[85%] relative group",children:[A.jsxs("div",{className:`relative px-3 py-2 ${z.role==="user"?"bg-slate-100 text-gray-800 rounded-lg":"text-gray-800"}`,children:[A.jsxs("div",{className:"whitespace-pre-wrap text-lg md:text-sm",children:[J?br:z.content,J&&A.jsx("span",{className:"typing-cursor",children:"|"})]}),K&&m[z.id]&&A.jsx("div",{className:"text-xs text-gray-500 mt-1",children:m[z.id].language==="zh-CN"?"Mandarin":"English"})]}),z.role==="user"&&A.jsx("button",{id:G,onClick:()=>rr(z.content,G),title:"Copy message",className:"absolute right-[-1px] bottom-[-4px] text-gray-600 hover:text-blue-500 p-1 rounded-full hover:bg-gray-100 transition-all duration-200 z-10",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),A.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]})}),K&&A.jsxs("div",{className:"absolute bottom-0 left-[5px] transform translate-y-1/2 flex items-center space-x-1 z-10",children:[A.jsx("button",{id:G,onClick:()=>rr(z.content,G),title:"Copy message",className:"text-gray-500 hover:text-blue-500 p-1 rounded-full hover:bg-gray-50 transition-all duration-200",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),A.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]})}),A.jsx("button",{onClick:()=>xr(z.id)&&!C&&mr(z.content,z.id),disabled:!xr(z.id)||C,title:tr(z.id),"aria-label":tr(z.id),className:`rounded-full p-1 transition-all duration-200
                        ${_===z.id?"text-blue-600 animate-pulse":xr(z.id)?C?"text-gray-400":"text-gray-500 hover:text-blue-500 hover:bg-gray-50":"text-gray-300"}`,children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),A.jsx("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),A.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})]})}),Xe&&_===z.id&&A.jsx("button",{onClick:()=>{tn(),Be(!1)},className:"ml-1 rounded-full p-1 text-red-500 hover:text-red-700 hover:bg-red-50 transition-all duration-200",title:"Stop pronunciation",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})})})]}),A.jsx("span",{id:`tts-status-${z.id}`,className:"text-[10px] text-gray-500 ml-auto mr-2 mt-1"})]})},z.id)}),s&&A.jsxs("div",{className:"flex items-start mb-2",children:[A.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs mr-2",children:"B"}),A.jsx("div",{className:"bg-white text-gray-500 px-3 py-2 rounded-lg shadow",children:A.jsxs("div",{className:"flex space-x-1",children:[A.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),A.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),A.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})]}),ke&&A.jsxs("div",{className:"flex flex-col items-center justify-center h-full my-auto py-16",children:[A.jsx("div",{className:"text-2xl text-blue-600 font-semibold mb-4 text-center",children:", let's start learning Mandarin!"}),A.jsxs("div",{className:"relative w-full max-w-md",children:[A.jsx("textarea",{value:c,onChange:xn,onKeyDown:Dr,placeholder:"Type your message...",className:"w-full border rounded-lg px-4 py-2 pr-20 text-base focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",style:{height:"40px",maxHeight:"150px",overflowY:"auto"},disabled:T||s||se||Ce}),A.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex space-x-2",children:[A.jsx("button",{onClick:Zr,disabled:T||C||s||se||Ce,className:`p-2 rounded-full flex items-center justify-center transition-all duration-200 ${T?"bg-red-500 text-white animate-pulse":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,children:T?A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("circle",{cx:"12",cy:"12",r:"8"})}):A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 06 0V4a3 3 0 0 0-3-3z"}),A.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),A.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),A.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})}),A.jsx("button",{onClick:Xr,disabled:!c.trim()||T||s,className:`p-2 rounded-full ${c.trim()&&!T&&!s?"bg-blue-500 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("path",{d:"M22 2L11 13"}),A.jsx("path",{d:"M22 2l-7 20-4-9-9-4 20-7z"})]})})]})]})]}),A.jsx("div",{ref:Mn})]}),Ie&&A.jsx("div",{className:"absolute bottom-20 left-0 right-0 flex justify-center z-20",children:A.jsx("button",{onClick:Mi,className:"bg-white text-gray-700 p-2.5 rounded-full shadow-lg hover:bg-blue-500 hover:text-white focus:outline-none transition-all duration-200 border border-gray-200","aria-label":"Scroll to latest message",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),A.jsx("polyline",{points:"19 12 12 19 5 12"})]})})}),A.jsxs("div",{className:"border-t border-gray-200 p-2 bg-white",children:[!ke&&A.jsxs(A.Fragment,{children:[(N||v)&&A.jsxs("div",{className:"flex items-center justify-between mb-1",children:[v&&A.jsx("span",{className:"text-xs text-gray-500",children:v==="zh-CN"?"(Mandarin)":"(English)"}),N&&A.jsx("div",{className:`text-xs ${T?"text-red-500 animate-pulse":"text-green-500"}`,children:N})]}),A.jsxs("div",{className:"flex-1 relative flex items-center",children:[A.jsx("textarea",{value:c,onChange:xn,onKeyDown:Dr,placeholder:"Message",className:"w-full border rounded-lg px-4 py-2 pr-16 text-base md:text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 resize-none overflow-hidden transition-all duration-200",style:{minHeight:"40px",maxHeight:"150px",overflowY:"auto"},disabled:T||s||se||Ce}),A.jsxs("div",{className:"absolute right-1 flex",children:[A.jsx("button",{onClick:Zr,disabled:T||C||s||se||Ce,className:`p-1.5 rounded-full flex items-center justify-center transition-all duration-200
                ${T?"bg-red-500 text-white animate-pulse":"text-gray-600 hover:bg-gray-100"}
                ${C||s?"opacity-50 cursor-not-allowed":""}
            `,"aria-label":"Record voice input",children:T?A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",className:"animate-pulse",children:A.jsx("circle",{cx:"12",cy:"12",r:"8"})}):A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 06 0V4a3 3 0 0 0-3-3z"}),A.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),A.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),A.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})}),s?A.jsx("button",{onClick:Mr,disabled:dt,className:"p-1.5 rounded-full ml-1 bg-red-500 text-white hover:bg-red-600","aria-label":"Cancel request",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}):A.jsx("button",{onClick:Oi,disabled:!c.trim()||T||s||se,className:`p-1.5 rounded-full ml-1 ${c.trim()&&!T&&!s?"bg-blue-500 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,"aria-label":"Send message",children:A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[A.jsx("path",{d:"M22 2L11 13"}),A.jsx("path",{d:"M22 2l-7 20-4-9-9-4 20-7z"})]})})]})]})]}),Ii&&A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:A.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[A.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Notice"}),A.jsx("p",{className:"mb-4",children:"Now voice chat function only available for English and Chinese Mandarin speakers. Do you want to continue?"}),A.jsxs("div",{className:"flex items-center mb-4",children:[A.jsx("input",{type:"checkbox",id:"dont-show",checked:Gr,onChange:z=>Ai(z.target.checked),className:"mr-2"}),A.jsx("label",{htmlFor:"dont-show",children:"Don't show me this message again in the future"})]}),A.jsxs("div",{className:"flex justify-end space-x-3",children:[A.jsx("button",{onClick:()=>gr(!1),className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"No"}),A.jsx("button",{onClick:()=>{Gr&&localStorage.setItem("voiceWarningAccepted","true"),gr(!1),en()},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Yes"})]})]})})]})]})}const xP=typeof window<"u",cR=()=>{if(!xP)return!1;const i=navigator.userAgent||navigator.vendor||window.opera;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(i))return console.log("Mobile terdeteksi berdasarkan User Agent"),!0;const r=window.innerWidth<768;return console.log("Width check:",window.innerWidth,"Is mobile width:",r),r};function Wb(){const[i,t]=Q.useState([]),[r,u]=Q.useState(null),[o,c]=Q.useState(!1),[a,s]=Q.useState(null),[l,p]=Q.useState(cR()),[h,v]=Q.useState(!1);Q.useEffect(()=>{if(!xP)return;const _=()=>{const E=cR();console.log("Device check - Width:",window.innerWidth,"User Agent:",navigator.userAgent),console.log("Detected as mobile:",E),p(E),E&&!o&&c(!1)};return _(),window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}},[o]),Q.useEffect(()=>{console.log("Drawer open state:",o),console.log("Is mobile:",l)},[o,l]),Q.useEffect(()=>{let _;const E=async()=>{try{const{data:D,error:N}=await be.auth.getUser();if(N||!(D!=null&&D.user)){console.error("Auth error:",(N==null?void 0:N.message)||"User not found");return}const H=D.user;s(H);const{data:ie,error:Y}=await be.from("threads").select("*").eq("user_id",H.id).order("updated_at",{ascending:!1});if(Y){console.error("Failed to load threads:",Y.message);return}t(ie||[]),r||i.some(De=>De.title==="Untitled")||g()}catch(D){console.error("Unexpected error:",D)}},T=()=>a?(_=be.channel(`threads-${a.id}`).on("postgres_changes",{event:"*",schema:"public",table:"threads",filter:`user_id=eq.${a.id}`},D=>{console.log("Realtime event:",D.eventType,D),D.eventType==="INSERT"&&(t(N=>N.some(ie=>ie.id===D.new.id)?N:[D.new,...N]),r||u(D.new.id)),D.eventType==="UPDATE"&&t(N=>{const H=N.filter(Y=>Y.id!==D.new.id);return[D.new,...H].sort((Y,Ie)=>{const De=new Date(Ie.updated_at||Ie.created_at),Xe=new Date(Y.updated_at||Y.created_at);return De-Xe})}),D.eventType==="DELETE"&&(t(N=>N.filter(H=>H.id!==D.old.id)),r===D.old.id&&t(N=>(N.length>0?u(N[0].id):u(null),N)))}).subscribe(),()=>{_&&be.removeChannel(_)}):()=>{};return E().then(()=>{if(a)return T()}),()=>{_&&be.removeChannel(_)}},[a,r]);const g=async()=>{if(console.log("Creating new thread..."),!a)return;const{data:_,error:E}=await be.from("threads").insert([{title:"Untitled",user_id:a.id}]).select().single();if(E){console.error("Error creating thread:",E.message);return}u(_.id);const T=document.querySelector("textarea");T&&(T.style.height="40px")},m=async _=>{const E=i.find(D=>D.id===_);if(!E)return;if(t(D=>D.filter(N=>N.id!==_)),r===_){const D=i.filter(N=>N.id!==_);D.length>0?u(D[0].id):u(null)}const{error:T}=await be.from("threads").delete().eq("id",_);T&&(console.error("Error deleting thread:",T.message),t(D=>[...D,E]))},w=async(_,E)=>{const T=i.findIndex(ie=>ie.id===_);if(T===-1)return;const D=i[T],N={...D,title:E};t(ie=>ie.map(Y=>Y.id===_?N:Y));const{error:H}=await be.from("threads").update({title:E}).eq("id",_);H&&(console.error("Error renaming thread:",H.message),t(ie=>ie.map(Y=>Y.id===_?D:Y)))},C=async _=>{try{const E=await fetch("http://192.168.0.198:3000/api/ai/generate-thread-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:_})});if(console.log("Response status:",E.status),!E.ok){let H;try{H=await E.text()}catch{H="Unknown error response"}throw new Error(`API error ${E.status}: ${H}`)}const T=await E.json();return console.log("Response data:",T),(T.title||"Untitled").trim().replace(/^"|"$/g,"")}catch(E){return console.error("Error generating thread title:",E),"Untitled"}},R=async()=>{await be.auth.signOut(),window.location.reload()};return A.jsxs("div",{className:"flex h-screen",children:[!l&&A.jsx("div",{className:"flex",children:A.jsx(BT,{threads:i,selectedThreadId:r,onSelectThread:u,onCreateNew:g,onDeleteThread:m,onRenameThread:w,onLogout:R,currentUser:a})}),A.jsx(FT,{isOpen:o,onClose:()=>c(!1),threads:i,selectedThreadId:r,onSelectThread:_=>{u(_),c(!1)},onCreateNew:g,onDeleteThread:m,onRenameThread:w,onLogout:R,currentUser:a}),A.jsxs("div",{className:"flex-1 flex flex-col relative",children:[l&&A.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between p-3 border-b bg-white shadow-sm",children:[A.jsx("button",{onClick:()=>c(!0),className:"p-2 rounded-md text-gray-600 hover:bg-gray-100",children:""}),A.jsx("h2",{className:"text-lg font-medium",children:"Basabisa"}),A.jsx("button",{onClick:R,className:"text-sm text-red-500",children:"Logout"})]}),A.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:r?A.jsx($b,{threadId:r,onCreateThreadWithAutonaming:async _=>{if(!r)return;const E=await C(_),{error:T}=await be.from("threads").update({title:E}).eq("id",r);T?console.error("Error updating thread title:",T.message):t(D=>D.map(N=>N.id===r?{...N,title:E}:N))}}):A.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"No conversation selected"})})]})]})}function Hb(){const[i,t]=Q.useState(null),[r,u]=Q.useState(!0);return Q.useEffect(()=>{(async()=>{const{data:{session:a}}=await be.auth.getSession();t(a),u(!1)})();const{subscription:c}=be.auth.onAuthStateChange((a,s)=>{t(s)});return()=>{c!=null&&c.unsubscribe&&c.unsubscribe()}},[]),r?A.jsx("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}):i?A.jsx(Wb,{}):A.jsx(qT,{})}const Vb=x_.createRoot(document.getElementById("root"));Vb.render(A.jsx(Hb,{}));export{Kh as g};
